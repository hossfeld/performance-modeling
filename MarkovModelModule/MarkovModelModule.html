<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>MarkovModelModule API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>


            <h2>Contents</h2>
            <ul>
  <li><a href="#key-features">Key Features</a></li>
  <li><a href="#typical-use-case">Typical Use Case</a></li>
  <li><a href="#example">Example</a></li>
  <li><a href="#see-also">See Also</a></li>
  <li><a href="#author">Author</a></li>
  <li><a href="#created">Created</a></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#StateTransitionGraph">StateTransitionGraph</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#StateTransitionGraph.__init__">StateTransitionGraph</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.addState">addState</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.setStateProperties">setStateProperties</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.setAllStateDefaultProperties">setAllStateDefaultProperties</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.addTransition">addTransition</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.sym">sym</a>
                        </li>
                        <li>
                                <a class="variable" href="#StateTransitionGraph.parameters">parameters</a>
                        </li>
                        <li>
                                <a class="variable" href="#StateTransitionGraph.rate_matrix">rate_matrix</a>
                        </li>
                        <li>
                                <a class="variable" href="#StateTransitionGraph.state_probabilities">state_probabilities</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.printEdges">printEdges</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.createRateMatrix">createRateMatrix</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.calcSteadyStateProbs">calcSteadyStateProbs</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.calcTransitionProbabilities">calcTransitionProbabilities</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.simulateMarkovModel">simulateMarkovModel</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.calcProbabilitiesSimulationRun">calcProbabilitiesSimulationRun</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.drawTransitionGraph">drawTransitionGraph</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.animateSimulation">animateSimulation</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.states">states</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.setStateColor">setStateColor</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.setStateLabel">setStateLabel</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.prob">prob</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.probs">probs</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.getEmptySystemProbs">getEmptySystemProbs</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.transientProbs">transientProbs</a>
                        </li>
                        <li>
                                <a class="function" href="#StateTransitionGraph.symSolveMarkovModel">symSolveMarkovModel</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
MarkovModelModule    </h1>

                        <div class="docstring"><p>StateTransitionGraph: A directed graph class for modeling continuous-time Markov chains (CTMCs).</p>

<p>This module defines the <code><a href="#StateTransitionGraph">StateTransitionGraph</a></code> class, an extension of <code>networkx.DiGraph</code> 
with specialized methods and attributes for analyzing, simulating, and visualizing 
continuous-time Markov chains (CTMCs).</p>

<h2 id="key-features">Key Features</h2>

<ul>
<li>Symbolic and numerical parameter support using SymPy.</li>
<li>Automatic generation and storage of the rate matrix (Q-matrix).</li>
<li>Simulation of state transitions and computation of steady-state probabilities.</li>
<li>Enhanced graph visualization with transition rates and labels.</li>
<li>Support for dynamic import of constants via a custom module (default: "Constants").</li>
</ul>

<h2 id="typical-use-case">Typical Use Case</h2>

<ol>
<li>Define a set of model parameters (e.g., lambda, mu, n).</li>
<li>Create a <code><a href="#StateTransitionGraph">StateTransitionGraph</a></code> instance with those parameters.</li>
<li>Add states and transitions with symbolic rates.</li>
<li>Compute the rate matrix and steady-state probabilities.</li>
<li>Run simulations and visualize the CTMC behavior.</li>
</ol>

<h2 id="example">Example</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lambda&#39;</span><span class="p">:</span> <span class="n">lam</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">StateTransitionGraph</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define transitions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">G</span><span class="o">.</span><span class="n">addTransition</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">sym</span><span class="p">(</span><span class="s2">&quot;lambda&quot;</span><span class="p">),</span> <span class="n">tid</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">ARRIVAL</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">G</span><span class="o">.</span><span class="n">addTransition</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">sym</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">),</span> <span class="n">tid</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">DEPARTURE</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set node properties</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">setAllStateDefaultProperties</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">setStateColor</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">const</span><span class="o">.</span><span class="n">COLOR_NODE_BLOCKING</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute steady-state probabilities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probs</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">calcSteadyStateProbs</span><span class="p">()</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot bar chart of state probabilities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">probs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;states&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;probability&#39;</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Layout for transition graph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">states</span><span class="p">()}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">drawTransitionGraph</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">bended</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate and animate system dynamics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">simulateMarkovModel</span><span class="p">(</span><span class="n">startNode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">numEvents</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="see-also">See Also</h2>

<p>networkx.DiGraph : The base class that is extended.
sympy.symbols   : Used to define symbolic transition rates.
matplotlib.pyplot : Used internally for graph visualization.</p>

<h2 id="author">Author</h2>

<p>Tobias Hossfeld <a href="&#x6d;&#97;&#x69;&#108;&#116;&#x6f;&#58;t&#x6f;&#98;&#105;a&#x73;&#46;&#x68;&#111;&#x73;s&#x66;&#101;&#108;&#100;&#x40;&#117;&#110;&#105;&#45;&#x77;&#x75;&#x65;&#114;&#122;&#98;&#117;&#114;g&#x2e;&#x64;&#101;">t&#x6f;&#98;&#105;a&#x73;&#46;&#x68;&#111;&#x73;s&#x66;&#101;&#108;&#100;&#x40;&#117;&#110;&#105;&#45;&#x77;&#x75;&#x65;&#114;&#122;&#98;&#117;&#114;g&#x2e;&#x64;&#101;</a></p>

<h2 id="created">Created</h2>

<p>5 April 2025</p>
</div>

                        <input id="mod-MarkovModelModule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-MarkovModelModule-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">StateTransitionGraph: A directed graph class for modeling continuous-time Markov chains (CTMCs).</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="sd">This module defines the `StateTransitionGraph` class, an extension of `networkx.DiGraph` </span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="sd">with specialized methods and attributes for analyzing, simulating, and visualizing </span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="sd">continuous-time Markov chains (CTMCs).</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="sd">Key Features</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="sd">------------</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="sd">- Symbolic and numerical parameter support using SymPy.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="sd">- Automatic generation and storage of the rate matrix (Q-matrix).</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="sd">- Simulation of state transitions and computation of steady-state probabilities.</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="sd">- Enhanced graph visualization with transition rates and labels.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="sd">- Support for dynamic import of constants via a custom module (default: &quot;Constants&quot;).</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="sd">Typical Use Case</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="sd">----------------</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="sd">1. Define a set of model parameters (e.g., lambda, mu, n).</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="sd">2. Create a `StateTransitionGraph` instance with those parameters.</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="sd">3. Add states and transitions with symbolic rates.</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="sd">4. Compute the rate matrix and steady-state probabilities.</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="sd">5. Run simulations and visualize the CTMC behavior.</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="sd">Example</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="sd">-------</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="sd">&gt;&gt;&gt; parameters = {&#39;lambda&#39;: lam, &#39;mu&#39;: 1.0, &#39;n&#39;: 5}</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">&gt;&gt;&gt; G = StateTransitionGraph(parameters)</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="sd">&gt;&gt;&gt; # Define transitions</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd">&gt;&gt;&gt; for i in range(parameters[&#39;n&#39;]):</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="sd">&gt;&gt;&gt;     G.addTransition(i, i + 1, G.sym(&quot;lambda&quot;), tid=const.ARRIVAL)</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="sd">&gt;&gt;&gt;     G.addTransition(i + 1, i, (i + 1) * G.sym(&quot;mu&quot;), tid=const.DEPARTURE)</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="sd">&gt;&gt;&gt; # Set node properties</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="sd">&gt;&gt;&gt; G.setAllStateDefaultProperties()</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="sd">&gt;&gt;&gt; G.setStateColor(G.n, const.COLOR_NODE_BLOCKING)</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">&gt;&gt;&gt; # Compute steady-state probabilities</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">&gt;&gt;&gt; probs = G.calcSteadyStateProbs()</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">&gt;&gt;&gt; # Plot bar chart of state probabilities</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="sd">&gt;&gt;&gt; import matplotlib.pyplot as plt</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">&gt;&gt;&gt; plt.figure(1, clear=True)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="sd">&gt;&gt;&gt; plt.bar(probs.keys(), probs.values())</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="sd">&gt;&gt;&gt; plt.xlabel(&#39;states&#39;)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">&gt;&gt;&gt; plt.ylabel(&#39;probability&#39;)</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">&gt;&gt;&gt; # Layout for transition graph</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">&gt;&gt;&gt; pos = {s: (s, 0) for s in G.states()}</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd">&gt;&gt;&gt; G.drawTransitionGraph(pos=pos, bended=True, label_pos=0.5, num=2)</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">&gt;&gt;&gt; # Simulate and animate system dynamics</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="sd">&gt;&gt;&gt; states, times = G.simulateMarkovModel(startNode=0, numEvents=2000)</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">See Also</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="sd">--------</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="sd">networkx.DiGraph : The base class that is extended.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd">sympy.symbols   : Used to define symbolic transition rates.</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="sd">matplotlib.pyplot : Used internally for graph visualization.</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">Author</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">------</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="sd">Tobias Hossfeld &lt;tobias.hossfeld@uni-wuerzburg.de&gt;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">Created</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">-------</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">5 April 2025 </span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>  <span class="c1"># For the magic</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># For plotting</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="c1">#import itertools</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="kn">import</span> <span class="nn">random</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="kn">import</span> <span class="nn">importlib</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">expm</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="c1">#import Constants as const</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="c1">#from collections import namedtuple</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="c1">#%%</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="k">class</span> <span class="nc">StateTransitionGraph</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">    Initialize the StateTransitionGraph for continuous time Markov chains (CTMC). </span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">    Extends the networkx.Graph class to include additional methods and properties </span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">    for the analysis, visualization, and simulation of CTMCs. </span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="sd">    The analysis allows deriving the state probabilities in the steady-state </span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">    and in the transient phase.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">    This constructor sets up symbolic and numeric parameters for the state transition graph,</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">    imports a constants module dynamically, and initializes internal data structures for</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">    rate matrix computation and steady-state probability analysis.</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">    Parameters</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">    ----------</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">    - `parameters` : dict  </span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">      A dictionary mapping parameter names to their numerical values.     </span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="sd">        Example: {&#39;lambda&#39;: 1.0, &#39;mu&#39;: 1.0}. </span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="sd">        For each parameter key:</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">        - A symbolic variable is created using sympy.symbols. Can be accessed as `G.sym(&quot;key&quot;)` or `G.sym_key`</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="sd">        - A variable is created which can be accessed via `G.key` (and the numerical value is assigned)</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="sd">        - For the key=&quot;lambda&quot;, `G.lam` and `G.sym_lambda` are created</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">    </span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">        The parameters can be accessed via property `parameters`</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">    - `constants` : str, optional</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">        The name of a Python module (as string) to import dynamically and assign to `self.const`.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a><span class="sd">        This can be used to store global or user-defined constants.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">        Default is &quot;Constants&quot;.</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="sd">    - `*args` : tuple</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">        Additional positional arguments passed to the base `networkx.DiGraph` constructor.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="sd">    - `**kwargs` : dict</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">        Additional keyword arguments passed to the base `networkx.DiGraph` constructor.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">    Attributes</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="sd">    ----------</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="sd">    - `_rate_matrix` : ndarray or None  </span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="sd">      The continuous-time rate matrix `Q` of the CTMC. Computed when calling `createRateMatrix()`.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">    - `_state_probabilities` : dict or None  </span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="sd">      Dictionary of steady-state probabilities, computed via `calcSteadyStateProbs()`.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="sd">    - `_n2i` : dict or None  </span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="sd">      Mapping from node identifiers to matrix row/column indices used for rate matrix construction.</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="sd">    - `_sym` : dict  </span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="sd">      Mapping of parameter names (strings) to their symbolic `sympy` representations.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="sd">    - `_subs` : dict  </span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="sd">      Mapping from symbolic parameters to their numerical values (used for substitutions).</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="sd">    - `_parameters` : dict  </span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="sd">      Copy of the original parameter dictionary passed at initialization.</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">    - `_transitionProbabilitesComputed` : bool  </span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">      Internal flag indicating whether transition probabilities for the embedded Markov chain</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">      have been computed.</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">    - `const` : module  </span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">      Dynamically imported module (default `&quot;Constants&quot;`), used for storing user-defined constants </span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="sd">      such as colors or transition IDs.</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">        </span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">    Inherits</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a><span class="sd">    --------</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="sd">        networkx.Graph: The base graph class from NetworkX.</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">constants</span><span class="o">=</span><span class="s2">&quot;Constants&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">        Initialize the state transition graph with symbolic parameters.</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">        This constructor sets up the symbolic and numerical environment for modeling</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">        a CTMC. Parameters are stored as both symbolic expressions and numerical values,</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">        and convenient attribute access is provided for both forms.</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">        Parameters</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="sd">        ----------</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="sd">        - `parameters` : dict  </span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">          A dictionary mapping parameter names to their numerical values.     </span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="sd">            Example: {&#39;lambda&#39;: 1.0, &#39;mu&#39;: 1.0}. </span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">            For each parameter key:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a><span class="sd">            - A symbolic variable is created using sympy.symbols. Can be accessed as `G.sym(&quot;key&quot;)` or `G.sym_key`</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a><span class="sd">            - A variable is created which can be accessed via `G.key` (and the numerical value is assigned)</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a><span class="sd">            - For the key=&quot;lambda&quot;, `G.lam` and `G.sym_lambda` are created</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a><span class="sd">        </span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a><span class="sd">            The parameters can be accessed via property `parameters`</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a><span class="sd">        - `constants` : str, optional</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a><span class="sd">            The name of a Python module (as string) to import dynamically and assign to `self.const`.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a><span class="sd">            This can be used to store global or user-defined constants.</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a><span class="sd">            Default is &quot;Constants&quot;.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a><span class="sd">        - `*args` : tuple</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a><span class="sd">            Additional positional arguments passed to the base `networkx.DiGraph` constructor.</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a><span class="sd">        - `**kwargs` : dict</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="sd">            Additional keyword arguments passed to the base `networkx.DiGraph` constructor.</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Rate Matrix Q of this transition graph</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state_probabilities</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># steady state proabilities of this CTMC</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># internal index for generating the rate matrix Q: dictionary (node to index)</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>        
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>        <span class="c1">#parameters = {&#39;lambda&#39;: 1.0, &#39;mu&#39;:1.0, &#39;n&#39;:5}</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">}</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_subs</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># contains symbolic parameter as key and provides numerical value for computation.</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_subs</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">]</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> 
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>        <span class="c1"># access to parameters and symbols using dot-notation, e.g. G.lam, G.sym_lambda, or G.sym(&quot;lambda&quot;)</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s1">&#39;lambda&#39;</span><span class="p">:</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;lam&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>            
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;sym_&quot;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>            
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transitionProbabilitesComputed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_const</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">constants</span><span class="p">)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>        
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>        
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>    <span class="k">def</span> <span class="nf">addState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a><span class="sd">        Add a state (node) to the graph with optional color and label attributes.</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">    </span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">        If the node already exists, its attributes are updated with the provided values.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">    </span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">        Parameters</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        ----------</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">        - state : hashable</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">            The identifier for the state. Can be a string, int, or a tuple. If no label</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">            is provided, the label will be auto-generated as:</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="sd">            - comma-separated string for tuples (e.g., `(1, 2)` -&gt; `&#39;1,2&#39;`)</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">            - stringified value for other types</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a><span class="sd">    </span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="sd">        - color : str, optional</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="sd">            The color assigned to the state (used for visualization).</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="sd">            If not specified, defaults to `self.const.COLOR_NODE_DEFAULT`.</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="sd">    </span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a><span class="sd">        - label : str, optional</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a><span class="sd">            A label for the node (used for display or annotation). If not provided,</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a><span class="sd">            it will be auto-generated from the state identifier.</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">    </span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a><span class="sd">        Notes</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a><span class="sd">        -----</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="sd">        - This method wraps `self.add_node()` from NetworkX.</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="sd">        - If the node already exists in the graph, this method does not raise an error;</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">          it will update the node’s existing attributes.</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">state</span><span class="p">))</span> <span class="c1"># if state is a tuple</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>            <span class="k">else</span><span class="p">:</span> 
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>            <span class="c1">#self.nodes[state][&quot;label&quot;] = label</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>        
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_NODE_DEFAULT</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>        
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>        <span class="c1"># no error if the node already exists.Attributes get updated if you pass them again.</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>        
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>    <span class="k">def</span> <span class="nf">setStateProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        Update visual or metadata properties for an existing state (node) in the graph.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="sd">    </span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a><span class="sd">        This method updates the node&#39;s attributes such as color, label, and any additional</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">        custom key-value pairs. The node must already exist in the graph.</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="sd">    </span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a><span class="sd">        Parameters</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a><span class="sd">        ----------</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a><span class="sd">        - state : hashable</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">            Identifier of the state to update. Must be a node already present in the graph.</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">    </span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">        - color : str, optional</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a><span class="sd">            Color assigned to the node, typically used for visualization. If not provided,</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a><span class="sd">            the default node color (`self._const.COLOR_NODE_DEFAULT`) is used.</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a><span class="sd">    </span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a><span class="sd">        - label : str, optional</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a><span class="sd">            Label for the node. If not provided, it is auto-generated from the state ID</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a><span class="sd">            (especially for tuples).</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a><span class="sd">    </span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">        - **kwargs : dict</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="sd">            Arbitrary additional key-value pairs to set as node attributes. These can include</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a><span class="sd">            any custom metadata.</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="sd">    </span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="sd">        Raises</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="sd">        ------</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a><span class="sd">        KeyError</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a><span class="sd">            If the specified state is not present in the graph.</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a><span class="sd">    </span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a><span class="sd">        Notes</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a><span class="sd">        -----</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">        - This method ensures that required attributes (like `color` and `label`) are set for visualization. </span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="sd">        - Existing node attributes are updated or extended with `kwargs`.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>        <span class="k">if</span> <span class="n">state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State &#39;</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&#39; does not exist in the graph.&quot;</span><span class="p">)</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>        
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="c1"># mandatory for plotting</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addState</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>        
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>        <span class="c1"># # Add any additional attributes</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">state</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>        
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>    <span class="k">def</span> <span class="nf">setAllStateDefaultProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a><span class="sd">        Set default visual and metadata properties for all states (nodes) in the graph.</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a><span class="sd">    </span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a><span class="sd">        This method applies `setStateProperties()` to every node, ensuring each state</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a><span class="sd">        has at least the required default attributes (e.g., color and label).</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a><span class="sd">        Any additional keyword arguments are passed to `setStateProperties()`.</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a><span class="sd">    </span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a><span class="sd">        Parameters</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a><span class="sd">        ----------</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="sd">        **kwargs : dict, optional</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a><span class="sd">            Optional keyword arguments to apply uniformly to all nodes,</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="sd">            such as color=&#39;gray&#39;, group=&#39;core&#39;, etc.</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a><span class="sd">    </span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">        Notes</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">        -----</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">        - This method is useful for initializing node attributes before plotting</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="sd">          or performing other graph-based computations.</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">        - Nodes without existing attributes will receive defaults via `addState()`.</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">setStateProperties</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>        
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="c1">#def addTransition(self, origin_state, list_destination_state, sym_rate, color=plt.cm.tab10(5), tid = None):        </span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>    <span class="k">def</span> <span class="nf">addTransition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin_state</span><span class="p">,</span> <span class="n">destination_state</span><span class="p">,</span> <span class="n">sym_rate</span><span class="p">,</span> <span class="n">tid</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>     
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">        Add a directed transition (edge) between two states with a symbolic transition rate.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">    </span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="sd">        This method adds a directed edge from `origin_state` to `destination_state`,</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="sd">        stores both the symbolic and numerical rate, and sets optional display properties</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">        such as color, label, and transition ID. If the edge already exists, a warning is issued.</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">    </span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">        Parameters</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">        ----------</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">        - origin_state : hashable</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a><span class="sd">            The source node (state) of the transition.</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a><span class="sd">    </span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="sd">        - destination_state : hashable</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a><span class="sd">            The target node (state) of the transition.</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a><span class="sd">    </span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a><span class="sd">        - sym_rate : sympy.Expr</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a><span class="sd">            A symbolic expression representing the transition rate.</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="sd">            This will be numerically evaluated using internal substitutions (`self._subs`).</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">    </span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a><span class="sd">        - tid : str or int, optional</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a><span class="sd">            A transition identifier (e.g. for grouping or styling).</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="sd">            If provided, the color will default to `self._const.COLOR_TRANSITIONS[tid]` if not set explicitly.</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="sd">    </span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">        - color : str, optional</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a><span class="sd">            Color for the edge (used in visualization). Defaults to the transition-specific color</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">            if `tid` is provided.</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">    </span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">        - label : str, optional</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a><span class="sd">            LaTeX-formatted string for labeling the edge. If not provided, a default label is</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">            generated using `sympy.latex(sym_rate)`.</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="sd">    </span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">        Notes</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="sd">        -----</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">        - The numeric rate is computed by substituting known parameter values into `sym_rate`.</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">        - The following attributes are stored on the edge:</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">            - `rate` (float): numeric value of the transition rate</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="sd">            - `sym_rate` (sympy.Expr): original symbolic expression</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a><span class="sd">            - `label` (str): display label</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">            - `color` (str): edge color</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a><span class="sd">            - `tid` (str or int): transition ID</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="sd">        - If the edge already exists, a `UserWarning` is issued but the edge is still overwritten.</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>        <span class="k">if</span> <span class="n">tid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>            <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_TRANSITIONS</span><span class="p">[</span> <span class="n">tid</span> <span class="p">]</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>                
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="n">rate</span> <span class="o">=</span> <span class="n">sym_rate</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subs</span> <span class="p">)</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>        
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;$&quot;</span><span class="o">+</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">sym_rate</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;$&quot;</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>                
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">origin_state</span><span class="p">,</span> <span class="n">destination_state</span><span class="p">):</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>            <span class="n">theedge</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">origin_state</span><span class="p">][</span><span class="n">destination_state</span><span class="p">]</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>            <span class="n">warningstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Edge already exists: </span><span class="si">{</span><span class="n">origin_state</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">destination_state</span><span class="si">}</span><span class="s2"> with rate </span><span class="si">{</span><span class="n">theedge</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warningstr</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">origin_state</span><span class="p">,</span> <span class="n">destination_state</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">rate</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">string</span><span class="p">,</span> 
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>                   <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">sym_rate</span><span class="o">=</span><span class="n">sym_rate</span><span class="p">,</span> <span class="n">tid</span><span class="o">=</span><span class="n">tid</span><span class="p">)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>    
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>    <span class="k">def</span> <span class="nf">sym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">        Retrieve the symbolic representation of a model parameter.</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">    </span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">        Parameters</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">        ----------</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">        key : str</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">            The name of the parameter (e.g., &#39;lambda&#39;, &#39;mu&#39;, &#39;n&#39;).</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">    </span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="sd">        Returns</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a><span class="sd">        -------</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a><span class="sd">        sympy.Symbol</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a><span class="sd">            The symbolic variable corresponding to the given key.</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a><span class="sd">    </span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a><span class="sd">        Raises</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a><span class="sd">        ------</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="sd">        KeyError</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a><span class="sd">            If the key does not exist in the internal symbolic mapping (`_sym`).</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a><span class="sd">    </span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a><span class="sd">        Examples</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="sd">        --------</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">        &gt;&gt;&gt; G.sym(&#39;lambda&#39;)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="sd">        lambda</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a><span class="sd">    </span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a><span class="sd">        Notes</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a><span class="sd">        -----</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="sd">        - The symbolic mapping is initialized during object construction based on the `parameters` dictionary.</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a><span class="sd">        - To access the symbol using dot-notation, use `.sym_key` attributes created during initialization.</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>    <span class="nd">@property</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a><span class="sd">        Return the model parameters as a dictionary.</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a><span class="sd">    </span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a><span class="sd">        This includes the original numerical values provided during initialization.</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a><span class="sd">    </span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="sd">        Returns</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a><span class="sd">        -------</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="sd">        dict</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="sd">            Dictionary of parameter names and their corresponding numeric values.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a><span class="sd">    </span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a><span class="sd">        Examples</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a><span class="sd">        --------</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a><span class="sd">        &gt;&gt;&gt; G.parameters</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">        {&#39;lambda&#39;: 1.0, &#39;mu&#39;: 0.5, &#39;n&#39;: 3}</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a><span class="sd">    </span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a><span class="sd">        Notes</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="sd">        -----</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a><span class="sd">        - This property does not return symbolic values. Use `self.sym(key)` for symbolic access.</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">        - Parameter symbols can also be accessed using attributes like `sym_lambda` or the `sym()` method.</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>    
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>    <span class="nd">@property</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>    <span class="k">def</span> <span class="nf">rate_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">        Return the continuous-time rate matrix (Q matrix) of the state transition graph.</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">    </span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a><span class="sd">        This matrix defines the transition rates between all pairs of states in the</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">        continuous-time Markov chain (CTMC) represented by this graph.</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="sd">    </span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">        Returns</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">        -------</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">        numpy.ndarray or None</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a><span class="sd">            The rate matrix `Q`, where `Q[i, j]` is the transition rate from state `i` to `j`.</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a><span class="sd">            Returns `None` if the rate matrix has not been computed yet.</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a><span class="sd">    </span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a><span class="sd">        Notes</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a><span class="sd">        -----</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a><span class="sd">        - The matrix is typically generated via a method like `computeRateMatrix()` or similar.</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a><span class="sd">        - Internal state indexing is handled by `_n2i` (node-to-index mapping).</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a><span class="sd">        - The rate matrix is stored internally as `_rate_matrix`.</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>    <span class="nd">@property</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>    <span class="k">def</span> <span class="nf">state_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a><span class="sd">        Return the steady-state probabilities of the continuous-time Markov chain (CTMC).</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a><span class="sd">    </span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a><span class="sd">        These probabilities represent the long-run proportion of time the system spends</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a><span class="sd">        in each state, assuming the CTMC is irreducible and positive recurrent.</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a><span class="sd">    </span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a><span class="sd">        Returns</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a><span class="sd">        -------</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a><span class="sd">        dict or None</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a><span class="sd">            A dictionary mapping each state to its steady-state probability.</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a><span class="sd">            Returns `None` if the probabilities have not yet been computed.</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a><span class="sd">    </span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a><span class="sd">        Notes</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a><span class="sd">        -----</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a><span class="sd">        - The probabilities are stored internally after being computed via a dedicated method</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="sd">          `calcSteadyStateProbs()`.</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a><span class="sd">        - The result is stored in the `_state_probabilities` attribute.</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_probabilities</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>     
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>    
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>    <span class="k">def</span> <span class="nf">printEdges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="sd">        Print all outgoing edges from a given state in the graph.</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a><span class="sd">    </span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a><span class="sd">        For each edge from the specified `state`, this method prints the destination</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="sd">        state and the corresponding transition label (typically the symbolic rate).</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a><span class="sd">    </span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a><span class="sd">        Parameters</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a><span class="sd">        ----------</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a><span class="sd">        state : hashable</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="sd">            The source node (state) from which outgoing edges will be printed.            </span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">    </span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a><span class="sd">        Returns</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="sd">        -------</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="sd">        None</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a><span class="sd">            This method prints output directly to the console and does not return a value.</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a><span class="sd">    </span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="sd">        Notes</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a><span class="sd">        -----</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a><span class="sd">        - The transition label is retrieved from the edge attribute `&#39;label&#39;`.</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a><span class="sd">        - Assumes `state` exists in the graph; otherwise, a KeyError will be raised.</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;from </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>            <span class="n">rate</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; -&gt; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">rate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>            
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>    <span class="k">def</span> <span class="nf">createRateMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a><span class="sd">        Construct the continuous-time Markov chain (CTMC) rate matrix Q from the graph.</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a><span class="sd">    </span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a><span class="sd">        This method generates the generator matrix `Q` corresponding to the structure and</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a><span class="sd">        rates defined in the directed graph. Each node represents a system state, and each</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a><span class="sd">        directed edge must have a `&#39;rate&#39;` attribute representing the transition rate from</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a><span class="sd">        one state to another.</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a><span class="sd">    </span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a><span class="sd">        The matrix `Q` is constructed such that:</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a><span class="sd">        - `Q[i, j]` is the transition rate from state `i` to state `j`</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a><span class="sd">        - Diagonal entries satisfy `Q[i, i] = -sum(Q[i, j]) for j ≠ i`, so that each row sums to 0</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a><span class="sd">    </span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a><span class="sd">        The resulting matrix and the internal node-to-index mapping (`_n2i`) are stored</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a><span class="sd">        as attributes of the graph.</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a><span class="sd">    </span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a><span class="sd">        Returns</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a><span class="sd">        -------</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="sd">        None</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a><span class="sd">            The method updates internal attributes:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">            - `_rate_matrix` : numpy.ndarray</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a><span class="sd">                The CTMC rate matrix Q</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="sd">            - `_n2i` : dict</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a><span class="sd">                Mapping from node identifiers to matrix row/column indices</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a><span class="sd">    </span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a><span class="sd">        Notes</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a><span class="sd">        -----</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a><span class="sd">        - Assumes all edges in the graph have a `&#39;rate&#39;` attribute.</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a><span class="sd">        - The node order used in the matrix is consistent with the order from `list(self.nodes)`.</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="sd">        - Use `self.rate_matrix` to access the generated matrix after this method is called.</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>        <span class="n">n2i</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>            <span class="n">n2i</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>         
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>        <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)))</span> <span class="c1"># rate matrix</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>        
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>            <span class="n">i0</span> <span class="o">=</span> <span class="n">n2i</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>            <span class="n">i1</span> <span class="o">=</span> <span class="n">n2i</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>            <span class="n">Q</span><span class="p">[</span><span class="n">i0</span><span class="p">,</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;rate&quot;</span><span class="p">]</span> 
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>            
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="o">-</span><span class="n">Q</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="o">=</span> <span class="n">Q</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="o">=</span> <span class="n">n2i</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>        <span class="c1">#return Q, n2i</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>    
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>    <span class="k">def</span> <span class="nf">calcSteadyStateProbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>        
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a><span class="sd">        Compute the steady-state probabilities of the continuous-time Markov chain (CTMC).</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a><span class="sd">    </span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a><span class="sd">        This method calculates the stationary distribution of the CTMC defined by the rate</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a><span class="sd">        matrix of the state transition graph. The computation solves the linear system</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a><span class="sd">        `XQ = 0` with the constraint that the probabilities X sum to 1, using a modified</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a><span class="sd">        version of the rate matrix `Q`.</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a><span class="sd">    </span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="sd">        Parameters</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">        ----------</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="sd">        verbose : bool, optional</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">            If True, prints the rate matrix, the modified matrix, the right-hand side vector,</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">            and the resulting steady-state probabilities.</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">    </span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">        Returns</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        -------</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">        probs : dict</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">            A dictionary mapping each state (node in the graph) to its steady-state probability.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">    </span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">        Notes</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">        -----</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">        - The graph must already contain valid transition rates on its edges.</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">        - If the rate matrix has not yet been created, `createRateMatrix()` is called automatically.</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">        - The method modifies the last column of the rate matrix to impose the normalization constraint</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a><span class="sd">          `sum(X) = 1`.</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="sd">        - The inverse of the modified matrix is computed directly, so the graph should be small enough</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">          to avoid numerical instability or performance issues.</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a><span class="sd">        - The resulting probabilities are stored internally in `_state_probabilities` and can be accessed</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">          via the `state_probabilities` property.</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>        
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>        <span class="c1"># compute transition matrix if not already done</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">createRateMatrix</span><span class="p">()</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>        <span class="n">Q2</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rate matrix Q&quot;</span><span class="p">)</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Q=</span><span class="se">\n</span><span class="si">{</span><span class="n">Q2</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>        
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="n">Q2</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>        
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Matrix is changed to</span><span class="se">\n</span><span class="s1">Q2=</span><span class="se">\n</span><span class="si">{</span><span class="n">Q2</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Q2</span><span class="p">))</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>        <span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Solve X = b @ Q2&quot;</span><span class="p">)</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;b=</span><span class="se">\n</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>        
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>        <span class="c1"># state probabilities</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">b</span> <span class="o">@</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span> <span class="c1"># compute the matrix inverse</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>            
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>        <span class="c1"># Generate a matrix with P(X,Y)</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>            <span class="n">matrix</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">]</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>        
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Steady-state probabilities X&quot;</span><span class="p">)</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;X=</span><span class="se">\n</span><span class="si">{</span><span class="n">matrix</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state_probabilities</span> <span class="o">=</span> <span class="n">matrix</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>        <span class="k">return</span> <span class="n">matrix</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>        
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>    <span class="k">def</span> <span class="nf">calcTransitionProbabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a><span class="sd">        Compute and store transition probabilities for each node in the graph of the embedded discrete Markov chain.</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">    </span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a><span class="sd">        This method processes each node in the graph, treating outgoing edges as</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="sd">        transitions in an embedded discrete-time Markov chain derived from a continuous-time</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a><span class="sd">        Markov chain (CTMC). Transition *rates* on outgoing edges are normalized into</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a><span class="sd">        *probabilities*, and relevant data is stored in the node attributes.</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a><span class="sd">    </span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">        For each node, the following attributes are set:</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="sd">        - `&quot;transitionProbs&quot;` : np.ndarray</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a><span class="sd">            Array of transition probabilities to successor nodes.</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a><span class="sd">        - `&quot;transitionNodes&quot;` : list</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a><span class="sd">            List of successor node identifiers (ordered as in the probability array).</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a><span class="sd">        - `&quot;sumOutgoingRates&quot;` : float</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a><span class="sd">            Sum of all outgoing transition rates. Used to model the exponential waiting time</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a><span class="sd">            in continuous-time simulation (`T ~ Exp(sumOutgoingRates)`).</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a><span class="sd">    </span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="sd">        Notes</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="sd">        -----</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="sd">        - The graph must be a directed graph where each edge has a `&#39;rate&#39;` attribute.</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a><span class="sd">        - Nodes with no outgoing edges are considered absorbing states.</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="sd">        - Useful for discrete-event simulation and Markov chain Monte Carlo (MCMC) modeling.</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a><span class="sd">        - Sets an internal flag `_transitionProbabilitesComputed = True` upon completion.</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="sd">    </span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a><span class="sd">        Raises</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="sd">        ------</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a><span class="sd">        KeyError</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">            If any outgoing edge lacks a `&#39;rate&#39;` attribute.</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>            <span class="n">successors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>            <span class="n">rates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">nbr</span><span class="p">][</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">successors</span><span class="p">])</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>            <span class="n">probs</span> <span class="o">=</span> <span class="n">rates</span> <span class="o">/</span> <span class="n">rates</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Normalize to probabilities</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionProbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">probs</span> <span class="c1"># probabilities</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionNodes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">successors</span> <span class="c1"># list of nodes</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;sumOutgoingRates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rates</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># time in state ~ EXP(sumOutgoingRates)</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>            <span class="n">numel</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">successors</span><span class="p">)</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>            <span class="k">if</span> <span class="n">numel</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absorbing state: </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transitionProbabilitesComputed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>                
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>    <span class="k">def</span> <span class="nf">simulateMarkovModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startNode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numEvents</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a><span class="sd">        Simulate a trajectory through the state transition graph as a continuous-time Markov chain (CTMC).</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a><span class="sd">        </span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="sd">        This method performs a discrete-event simulation of the CTMC by generating a random walk</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a><span class="sd">        through the graph, starting at `startNode` (or a default node if not specified). Transitions</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">        are chosen based on the normalized transition probabilities computed from edge rates, and</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a><span class="sd">        dwell times are sampled from exponential distributions based on the total outgoing rate</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a><span class="sd">        from each state.</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a><span class="sd">        </span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="sd">        Parameters</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">        ----------</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">        - startNode : hashable, optional</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">            The node at which the simulation starts. If not specified, the first node in the graph</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">            (based on insertion order) is used.</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a><span class="sd">        </span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a><span class="sd">        - numEvents : int, optional</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a><span class="sd">            The number of transition events (steps) to simulate. Default is 10.</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a><span class="sd">        </span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a><span class="sd">        Returns</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a><span class="sd">        -------</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a><span class="sd">        states : list</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a><span class="sd">            A list of visited states, representing the sequence of nodes traversed in the simulation.</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a><span class="sd">        </span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a><span class="sd">        times : numpy.ndarray</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="sd">            An array of dwell times in each state, sampled from exponential distributions</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="sd">            with rate equal to the sum of outgoing transition rates from each state.</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="sd">        </span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="sd">        Notes</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a><span class="sd">        -----</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">        - This method automatically calls `calcTransitionProbabilities()` if transition probabilities</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a><span class="sd">          have not yet been computed.</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">        - If an absorbing state (i.e., a node with no outgoing edges) is reached, the simulation stops early.</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">        - The cumulative time can be obtained by `np.cumsum(times)`.</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">        - State durations follow `Exp(sumOutgoingRates)` distributions per CTMC theory.</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transitionProbabilitesComputed</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcTransitionProbabilities</span><span class="p">()</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>        
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>        <span class="c1"># simulate random walk through Graph = Markov Chain</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>        <span class="k">if</span> <span class="n">startNode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>            <span class="n">startNode</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>        
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>        <span class="n">states</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># list of states</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>        <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numEvents</span><span class="p">)</span> <span class="c1"># time per state</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="n">startNode</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numEvents</span><span class="p">):</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>            <span class="n">outgoingRate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;sumOutgoingRates&quot;</span><span class="p">]</span>  <span class="c1"># time in state ~ EXP(sumOutgoingRates)</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="n">outgoingRate</span><span class="p">)</span> <span class="c1"># exponentially distributed time in state</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>            <span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>            
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>            <span class="c1"># get next node    </span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>            <span class="n">probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionProbs&quot;</span><span class="p">]</span> <span class="c1"># probabilities</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>            <span class="n">successors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionNodes&quot;</span><span class="p">]</span> <span class="c1"># list of nodes        </span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>            <span class="n">numel</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">successors</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>            <span class="k">if</span> <span class="n">numel</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absorbing state: </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>                <span class="k">break</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>            <span class="k">elif</span> <span class="n">numel</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>                <span class="n">nextNode</span> <span class="o">=</span> <span class="n">successors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>                <span class="n">nextNode</span> <span class="o">=</span> <span class="n">successors</span><span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">numel</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probs</span><span class="p">)</span> <span class="p">]</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>            <span class="c1"># edge = G[node][nextNode]</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="n">nextNode</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>            
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>        <span class="k">return</span> <span class="n">states</span><span class="p">,</span> <span class="n">times</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>    
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>    <span class="k">def</span> <span class="nf">calcProbabilitiesSimulationRun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">times</span><span class="p">):</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a><span class="sd">        Estimate empirical state probabilities from a simulation run of the CTMC.</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a><span class="sd">    </span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a><span class="sd">        This method computes the fraction of total time spent in each state during a simulation.</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a><span class="sd">        It uses the sequence of visited states and corresponding sojourn times to estimate the</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="sd">        empirical (time-weighted) probability distribution over states.</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a><span class="sd">    </span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a><span class="sd">        Parameters</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">        ----------</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="sd">        - states : list of tuple</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a><span class="sd">            A list of state identifiers visited during the simulation.    </span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">        - times : numpy.ndarray</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="sd">            An array of sojourn times corresponding to each visited state, same length as `states`.</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">    </span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a><span class="sd">        Returns</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="sd">        -------</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a><span class="sd">        simProbs : dict</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="sd">            A dictionary mapping each unique state to its estimated empirical probability,</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="sd">            based on total time spent in that state relative to the simulation duration.</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="sd">    </span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a><span class="sd">        Notes</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a><span class="sd">        -----</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">        - Internally, states are mapped to flat indices for efficient counting using NumPy.</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">        - This method assumes that `states` contains only valid node identifiers from the graph.</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a><span class="sd">        - If `_n2i` (node-to-index mapping) has not been initialized, it will be computed here.</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a><span class="sd">        - This is especially useful for validating analytical steady-state probabilities</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a><span class="sd">          against sampled simulation results. Or in case of state-space explosions.</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>            <span class="n">n2i</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>            <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>                <span class="n">n2i</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>     
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="o">=</span> <span class="n">n2i</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>                
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>        
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>        <span class="c1"># Map tuples to flat indices</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>        <span class="n">max_vals</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel_multi_index</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">max_vals</span><span class="p">)</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>        <span class="c1"># Weighted bincount</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>        <span class="n">bincount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>        <span class="c1"># Decode back to tuples</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>        <span class="n">tuple_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">bincount</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="n">max_vals</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>        <span class="n">timePerState</span> <span class="o">=</span> <span class="n">bincount</span><span class="p">[</span><span class="n">bincount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>        <span class="n">simProbs</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>        <span class="n">totalTime</span> <span class="o">=</span> <span class="n">times</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>        <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tuple_indices</span><span class="p">,</span> <span class="n">timePerState</span><span class="p">):</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>            <span class="n">simProbs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">totalTime</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>            <span class="c1">#print(f&quot;Tuple {tuple(t)} → weighted count: {c}&quot;)</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>        <span class="k">return</span> <span class="n">simProbs</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>    
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>    
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>    <span class="k">def</span> <span class="nf">_draw_networkx_edge_labels</span><span class="p">(</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>        <span class="n">pos</span><span class="p">,</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>        <span class="n">edge_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>        <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;sans-serif&quot;</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>        <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rad</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a><span class="sd">        Draw edge labels for a directed graph with optional curved edge support.</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a><span class="sd">    </span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a><span class="sd">        This method extends NetworkX&#39;s default edge label drawing by supporting</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a><span class="sd">        curved (bended) edges through quadratic Bézier control points. It places</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a><span class="sd">        labels dynamically at a specified position along the curve and optionally</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a><span class="sd">        rotates them to follow the edge orientation.</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a><span class="sd">    </span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a><span class="sd">        Parameters</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="sd">        ----------</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a><span class="sd">        pos : dict</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a><span class="sd">            Dictionary mapping nodes to positions (2D coordinates). Required.</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="sd">    </span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="sd">        edge_labels : dict, optional</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a><span class="sd">            Dictionary mapping edge tuples `(u, v)` to label strings. If None,</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">            edge data is used and converted to strings automatically.</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="sd">    </span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a><span class="sd">        label_pos : float, optional</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="sd">            Position along the edge to place the label (0=head, 1=tail).</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="sd">            Default is 0.75 (closer to the target node).</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a><span class="sd">    </span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a><span class="sd">        font_size : int, optional</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a><span class="sd">            Font size of the edge labels. Default is 10.</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a><span class="sd">    </span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a><span class="sd">        font_color : str, optional</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a><span class="sd">            Font color for the edge labels. Default is &#39;k&#39; (black).</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a><span class="sd">    </span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a><span class="sd">        font_family : str, optional</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a><span class="sd">            Font family for the edge labels. Default is &#39;sans-serif&#39;.</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a><span class="sd">    </span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="sd">        font_weight : str, optional</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">            Font weight for the edge labels (e.g., &#39;normal&#39;, &#39;bold&#39;). Default is &#39;normal&#39;.</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a><span class="sd">    </span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">        alpha : float, optional</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">            Opacity for the edge labels. If None, labels are fully opaque.</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">    </span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">        bbox : dict, optional</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">            Matplotlib-style bbox dictionary to style the label background.</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a><span class="sd">            Default is a white rounded box.</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="sd">    </span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">        horizontalalignment : str, optional</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">            Horizontal alignment of the text. Default is &#39;center&#39;.</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">    </span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a><span class="sd">        verticalalignment : str, optional</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">            Vertical alignment of the text. Default is &#39;center&#39;.</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a><span class="sd">    </span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="sd">            Axes on which to draw the labels. If None, uses the current axes.</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a><span class="sd">    </span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a><span class="sd">        rotate : bool, optional</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a><span class="sd">            Whether to rotate the label to match the edge direction. Default is True.</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a><span class="sd">    </span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="sd">        clip_on : bool, optional</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">            Whether to clip labels at the plot boundary. Default is True.</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a><span class="sd">    </span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="sd">        rad : float, optional</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">            Curvature of the edge (used to determine Bézier control point).</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a><span class="sd">            Positive values bend counterclockwise; negative values clockwise. Default is 0 (straight).</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a><span class="sd">    </span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a><span class="sd">        Returns</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a><span class="sd">        -------</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a><span class="sd">        dict</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a><span class="sd">            Dictionary mapping edge tuples `(u, v)` to the corresponding matplotlib Text objects.</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a><span class="sd">    </span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a><span class="sd">        Notes</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a><span class="sd">        -----</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a><span class="sd">        - If `rotate=True`, label text is automatically aligned with the direction of the edge.</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a><span class="sd">        - Curvature (`rad`) enables visualization of bidirectional transitions using bent edges.</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="sd">        - This method is intended for internal use and supports bended edge label placement to match custom edge rendering.</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a><span class="sd">    </span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a><span class="sd">        See Also</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="sd">        --------</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="sd">        draw</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">        draw_networkx</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">        draw_networkx_nodes</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">        draw_networkx_edges</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">        draw_networkx_labels</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="sd">        &quot;&quot;&quot;</span>                
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>        <span class="k">if</span> <span class="n">edge_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">{(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span> <span class="n">d</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="n">edge_labels</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>        <span class="n">text_items</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">),</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>            <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">n1</span><span class="p">]</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>            <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">n2</span><span class="p">]</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>            <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>                <span class="n">x1</span> <span class="o">*</span> <span class="n">label_pos</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">label_pos</span><span class="p">),</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>                <span class="n">y1</span> <span class="o">*</span> <span class="n">label_pos</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">label_pos</span><span class="p">),</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>            <span class="p">)</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>            <span class="n">pos_1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">n1</span><span class="p">]))</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>            <span class="n">pos_2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">n2</span><span class="p">]))</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>            <span class="c1">#linear_mid = 0.5*pos_1 + 0.5*pos_2</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>            <span class="n">linear_mid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">label_pos</span><span class="p">)</span><span class="o">*</span><span class="n">pos_1</span> <span class="o">+</span> <span class="n">label_pos</span><span class="o">*</span><span class="n">pos_2</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>            <span class="n">d_pos</span> <span class="o">=</span> <span class="n">pos_2</span> <span class="o">-</span> <span class="n">pos_1</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>            <span class="n">rotation_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>            <span class="n">ctrl_1</span> <span class="o">=</span> <span class="n">linear_mid</span> <span class="o">+</span> <span class="n">rad</span><span class="o">*</span><span class="n">rotation_matrix</span><span class="nd">@d_pos</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>            <span class="n">ctrl_mid_1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">pos_1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">ctrl_1</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>            <span class="n">ctrl_mid_2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">pos_2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">ctrl_1</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>            <span class="n">bezier_mid</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">ctrl_mid_1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">ctrl_mid_2</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>            <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">bezier_mid</span><span class="p">)</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>            <span class="k">if</span> <span class="n">rotate</span><span class="p">:</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>                <span class="c1"># in degrees</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>                <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>                <span class="c1"># make label orientation &quot;right-side-up&quot;</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>                <span class="k">if</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>                    <span class="n">angle</span> <span class="o">-=</span> <span class="mi">180</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>                <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">:</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>                    <span class="n">angle</span> <span class="o">+=</span> <span class="mi">180</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>                <span class="c1"># transform data coordinate angle to screen coordinate angle</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>                <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>                <span class="n">trans_angle</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform_angles</span><span class="p">(</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">angle</span><span class="p">,)),</span> <span class="n">xy</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>                <span class="n">trans_angle</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>            <span class="c1"># use default box of white with white border</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>            <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>                <span class="n">bbox</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">fc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># this makes &quot;1&quot; and 1 labeled the same</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>            <span class="n">t</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>                <span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">font_family</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">font_weight</span><span class="p">,</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>                <span class="n">horizontalalignment</span><span class="o">=</span><span class="n">horizontalalignment</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="n">verticalalignment</span><span class="p">,</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>                <span class="n">rotation</span><span class="o">=</span><span class="n">trans_angle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>                <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">clip_on</span><span class="o">=</span><span class="n">clip_on</span><span class="p">)</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>            <span class="n">text_items</span><span class="p">[(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">t</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>        <span class="k">return</span> <span class="n">text_items</span>    
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>    
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>    <span class="k">def</span> <span class="nf">drawTransitionGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>                        <span class="n">bended</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rad</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>                        <span class="n">edge_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_shapes</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>                        <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>                        <span class="n">fontcolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.75</span><span class="p">):</span>        
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">        Visualize the state transition graph with nodes and directed edges.</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a><span class="sd">    </span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a><span class="sd">        This method draws the graph using `matplotlib` and `networkx`, including labels,</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="sd">        node colors, and optional curved (bended) edges for better visualization of</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a><span class="sd">        bidirectional transitions. It supports layout customization and is useful for</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">        understanding the structure of the Markov model.</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a><span class="sd">    </span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a><span class="sd">        Parameters</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a><span class="sd">        ----------</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a><span class="sd">        pos : dict, optional</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a><span class="sd">            A dictionary mapping nodes to positions. If None, a Kamada-Kawai layout is used.</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a><span class="sd">    </span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a><span class="sd">        bended : bool, optional</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a><span class="sd">            If True, edges are drawn with curvature using arcs. Useful for distinguishing</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a><span class="sd">            bidirectional transitions. Default is False.</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="sd">    </span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="sd">        node_size : int, optional</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="sd">            Size of the nodes in the plot. Default is 1000.</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">    </span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">        num : int, optional</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">            Figure number for matplotlib (useful for managing multiple figures). Default is 1.</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">    </span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a><span class="sd">        rad : float, optional</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a><span class="sd">            The curvature radius for bended edges. Only used if `bended=True`. Default is -0.2.</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a><span class="sd">    </span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">        edge_labels : dict, optional</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="sd">            Optional dictionary mapping edges `(u, v)` to labels. If None, the `&#39;label&#39;`</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a><span class="sd">            attribute from each edge is used.</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">    </span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a><span class="sd">        node_shapes : str, optional</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="sd">            Shape of the nodes (e.g., `&#39;o&#39;` for circle, `&#39;s&#39;` for square). Default is `&#39;o&#39;`.</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a><span class="sd">    </span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a><span class="sd">        figsize : tuple, optional</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="sd">            Size of the matplotlib figure. Default is (14, 7).</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a><span class="sd">    </span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="sd">        clear : bool, optional</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="sd">            If True, clears the figure before plotting. Default is True.</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">    </span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">        fontsize : int, optional</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="sd">            Font size used for node labels. Default is 10.</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="sd">    </span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">        fontcolor : str, optional</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="sd">            Font color for node labels. Default is `&#39;black&#39;`.</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="sd">    </span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="sd">        label_pos : float, optional</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">            Position of edge labels along the edge (0=start, 1=end). Default is 0.75.</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a><span class="sd">    </span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="sd">        Returns</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a><span class="sd">        -------</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a><span class="sd">        fig : matplotlib.figure.Figure</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a><span class="sd">            The created matplotlib figure object.</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">    </span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a><span class="sd">        ax : matplotlib.axes.Axes</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">            The axes object where the graph is drawn.</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">    </span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a><span class="sd">        pos : dict</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">            The dictionary of node positions used for drawing.</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a><span class="sd">    </span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a><span class="sd">        Notes</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">        -----</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a><span class="sd">        - Node labels and colors must be set beforehand using `addState()` or `setStateProperties()`.</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="sd">        - Edge attributes must include `&#39;label&#39;` and `&#39;color&#39;`.</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="sd">        - This method modifies the current matplotlib figure and is intended for interactive or inline use.</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>        <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>        
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>        <span class="n">node_colors</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>        
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>        <span class="n">node_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>        <span class="c1">#node_shapes = {(hw,sw): &quot;o&quot; if hw+sw&lt;G.N else &quot;s&quot; for hw,sw in G.nodes()}        </span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>            
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>        <span class="n">edge_cols</span> <span class="o">=</span> <span class="p">{(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span> <span class="bp">self</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>            
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>        <span class="k">if</span> <span class="n">edge_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>            <span class="n">edge_labels</span> <span class="o">=</span> <span class="p">{(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span> <span class="bp">self</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>            
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>        <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">kamada_kawai_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>            
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="n">clear</span><span class="p">)</span>                        
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span> <span class="n">node_shape</span> <span class="o">=</span> <span class="n">node_shapes</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">)</span>                    
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>        
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="n">fontcolor</span><span class="p">)</span>  <span class="c1"># Draw node labels</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>        <span class="k">if</span> <span class="n">bended</span><span class="p">:</span> 
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>  <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="p">[</span><span class="n">edge_cols</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">],</span> 
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>                                   <span class="n">node_size</span> <span class="o">=</span> <span class="n">node_size</span><span class="p">,</span> 
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>                                   <span class="n">arrows</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">arrowstyle</span> <span class="o">=</span> <span class="s1">&#39;-|&gt;&#39;</span><span class="p">,</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>                                   <span class="n">connectionstyle</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;arc3,rad=</span><span class="si">{</span><span class="n">rad</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>        
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_draw_networkx_edge_labels</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">,</span><span class="n">rotate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rad</span> <span class="o">=</span> <span class="n">rad</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="n">label_pos</span><span class="p">)</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>  <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="p">[</span><span class="n">edge_cols</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">],</span> 
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>                               <span class="n">node_size</span> <span class="o">=</span> <span class="n">node_size</span><span class="p">,</span> 
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>                               <span class="c1">#min_target_margin=17, arrowsize=15,</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>                               <span class="n">arrows</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">arrowstyle</span> <span class="o">=</span> <span class="s1">&#39;-|&gt;&#39;</span><span class="p">)</span>                           
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="n">label_pos</span><span class="p">)</span> <span class="c1">#, verticalalignment=&#39;center&#39;,)        </span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>    
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>        
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">(),</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">pos</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>    
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>    <span class="k">def</span> <span class="nf">animateSimulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expectedTimePerState</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inNotebook</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a><span class="sd">        Animate a simulation trajectory through the state transition graph.</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a><span class="sd">        The animation of the CTMC simulation run either in a Jupyter notebook or as a regular script.</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a><span class="sd">    </span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a><span class="sd">        This method visualizes the path of a simulated or predefined sequence of states by</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a><span class="sd">        temporarily highlighting each visited state over time. The time spent in each state</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a><span class="sd">        is scaled relative to the average sojourn time to produce a visually smooth animation.</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a><span class="sd">    </span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="sd">        Parameters</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="sd">        ----------</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">        - `expectedTimePerState` : float, optional</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a><span class="sd">            Approximate duration (in seconds) for an average state visit in the animation.</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a><span class="sd">            The actual pause duration for each state is scaled proportionally to its sojourn time.</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a><span class="sd">            Default is 1 second.</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="sd">            </span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a><span class="sd">        - `inNotebook` : bool, optional</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a><span class="sd">            If True, uses Jupyter-compatible animation (with display + clear_output).</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="sd">            If False, uses standard matplotlib interactive animation. Default is True.</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">    </span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a><span class="sd">        - `**kwargs` : dict</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="sd">            Additional keyword arguments including:</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="sd">                - states : list</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a><span class="sd">                    A list of visited states (nodes) to animate.</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="sd">                - times : list or np.ndarray</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="sd">                    Sojourn times in each state (same length as `states`).</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">                - startNode : hashable</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a><span class="sd">                    Optional start node for automatic simulation if `states` and `times` are not provided.</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">                - numEvents : int</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">                    Number of events (state transitions) to simulate.</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="sd">                - Additional drawing-related kwargs are passed to `drawTransitionGraph()`.</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">    </span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">        Raises</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">        ------</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">        ValueError</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="sd">            If neither a `(states, times)` pair nor `(startNode, numEvents)` are provided.</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">    </span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">        Returns</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">        -------</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">        None</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">            The animation is shown interactively using matplotlib but no data is returned.</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">    </span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a><span class="sd">        Notes</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">        -----</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a><span class="sd">        - If `states` and `times` are not supplied, a simulation is run via `simulateMarkovModel()`.</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a><span class="sd">        - The function uses matplotlib&#39;s interactive mode (`plt.ion()`) to animate transitions.</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a><span class="sd">        - The average sojourn time across all states is used to normalize animation speed.</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a><span class="sd">        - Each visited state is highlighted in red for its corresponding (scaled) dwell time.</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a><span class="sd">        - Drawing arguments like layout, font size, or color can be customized via kwargs.</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>        <span class="c1"># expTimePerState: in seconds</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>        <span class="k">if</span> <span class="s2">&quot;states&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;times&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>            <span class="n">states</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;states&quot;</span><span class="p">]</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>            <span class="n">times</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;times&quot;</span><span class="p">]</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>            <span class="c1"># Run default simulation if data not provided</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>            <span class="k">if</span> <span class="s2">&quot;startNode&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;numEvents&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>                <span class="n">states</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulateMarkovModel</span><span class="p">(</span><span class="n">startNode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numEvents</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must provide either (&#39;states&#39; and &#39;times&#39;) or (&#39;startNode&#39; and &#39;numEvents&#39;).&quot;</span><span class="p">)</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>        
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>        <span class="c1">#avg_OutGoingRate = np.mean([self.nodes[n].get(&quot;sumOutgoingRates&quot;, 0) for n in self.nodes])</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>        <span class="n">avg_Time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="mf">1.0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sumOutgoingRates&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">])</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>        
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>            
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>        <span class="c1"># Remove simulation-related keys before drawing</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>        <span class="n">draw_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="s2">&quot;times&quot;</span><span class="p">,</span> <span class="s2">&quot;startNode&quot;</span><span class="p">,</span> <span class="s2">&quot;numEvents&quot;</span><span class="p">}}</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>                
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawTransitionGraph</span><span class="p">(</span><span class="o">**</span><span class="n">draw_kwargs</span><span class="p">)</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>        
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">inNotebook</span><span class="p">:</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>                                
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">states</span><span class="p">,</span><span class="n">times</span><span class="p">):</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>            <span class="k">if</span> <span class="n">inNotebook</span><span class="p">:</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>                <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>                <span class="n">artist</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>                                                <span class="n">node_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_NODE_ANIMATION_HIGHLIGHT</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>                <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>                <span class="n">artist</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="p">],</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>                                       <span class="n">node_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_NODE_ANIMATION_HIGHLIGHT</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>                        
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="n">time</span><span class="o">/</span><span class="n">avg_Time</span><span class="o">*</span><span class="n">expectedTimePerState</span><span class="p">)</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>                
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>                <span class="c1"># Remove highlighted node    </span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>                <span class="n">artist</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>        
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>        <span class="k">pass</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>    
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>        
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>    
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>    <span class="k">def</span> <span class="nf">states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a><span class="sd">        Return a view of the graph&#39;s states (nodes), optionally with attributes.</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">    </span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a><span class="sd">        This method is functionally identical to `self.nodes()` in NetworkX, but is</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="sd">        renamed to `states()` to reflect the semantics of a state transition graph or</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a><span class="sd">        Markov model, where nodes represent system states.</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a><span class="sd">    </span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">        Parameters</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="sd">        ----------</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="sd">        data : bool, optional</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="sd">            If True, returns a view of `(node, attribute_dict)` pairs.</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a><span class="sd">            If False (default), returns a view of node identifiers only.</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a><span class="sd">    </span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a><span class="sd">        Returns</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a><span class="sd">        -------</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a><span class="sd">        networkx.classes.reportviews.NodeView or NodeDataView</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a><span class="sd">            A view over the graph’s nodes or `(node, data)` pairs, depending on the `data` flag.</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a><span class="sd">    </span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a><span class="sd">        Examples</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a><span class="sd">        --------</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="sd">        &gt;&gt;&gt; G.states()</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="sd">        [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a><span class="sd">    </span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">        &gt;&gt;&gt; list(G.states(data=True))</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">        [(&#39;A&#39;, {&#39;color&#39;: &#39;red&#39;, &#39;label&#39;: &#39;Start&#39;}), (&#39;B&#39;, {...}), ...]</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="sd">    </span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">        Notes</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">        -----</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">        - This is a convenience wrapper for semantic clarity in models where nodes represent states.</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a><span class="sd">        - The view is dynamic: changes to the graph are reflected in the returned view.</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>    
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>    <span class="k">def</span> <span class="nf">setStateColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a><span class="sd">        Set the color attribute of a specific state (node).</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a><span class="sd">    </span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a><span class="sd">        Parameters</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a><span class="sd">        ----------</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a><span class="sd">        state : hashable</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a><span class="sd">            The identifier of the state whose color is to be updated.</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a><span class="sd">    </span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a><span class="sd">        color : str</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a><span class="sd">            The new color to assign to the state (used for visualization).</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a><span class="sd">    </span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a><span class="sd">        Returns</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a><span class="sd">        -------</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a><span class="sd">        None</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>        
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>        
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>    <span class="k">def</span> <span class="nf">setStateLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a><span class="sd">        Set the label attribute of a specific state (node).</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a><span class="sd">    </span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a><span class="sd">        Parameters</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a><span class="sd">        ----------</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a><span class="sd">        state : hashable</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a><span class="sd">            The identifier of the state whose label is to be updated.</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a><span class="sd">    </span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a><span class="sd">        label : str</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a><span class="sd">            The new label to assign to the state (used for visualization or annotation).</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a><span class="sd">    </span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a><span class="sd">        Returns</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a><span class="sd">        -------</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a><span class="sd">        None</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>    <span class="k">def</span> <span class="nf">prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a><span class="sd">        Return the steady-state probability of a specific state.</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a><span class="sd">    </span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a><span class="sd">        Parameters</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a><span class="sd">        ----------</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a><span class="sd">        state : hashable</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a><span class="sd">            The identifier of the state whose probability is to be retrieved.</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a><span class="sd">    </span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a><span class="sd">        Returns</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a><span class="sd">        -------</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a><span class="sd">        float</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="sd">            The steady-state probability of the specified state.</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="sd">    </span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">        Raises</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">        ------</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a><span class="sd">        KeyError</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">            If the state is not found in the steady-state probability dictionary.</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_probabilities</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>        
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>    
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>    <span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a><span class="sd">        Return the steady-state probabilities for all states.</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a><span class="sd">    </span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a><span class="sd">        Returns</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="sd">        -------</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">        dict</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a><span class="sd">            A dictionary mapping each state to its steady-state probability.</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a><span class="sd">    </span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a><span class="sd">        Notes</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a><span class="sd">        -----</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a><span class="sd">        - The probabilities are computed via `calcSteadyStateProbs()` and stored internally.</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a><span class="sd">        - Use this method to access the full steady-state distribution.</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_probabilities</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>    <span class="k">def</span> <span class="nf">getEmptySystemProbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a><span class="sd">        Create an initial state distribution where all probability mass is in a single state.</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a><span class="sd">    </span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a><span class="sd">        By default, this method returns a distribution where the entire probability mass</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a><span class="sd">        is placed on the first node in the graph. Alternatively, a specific starting state</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a><span class="sd">        can be provided.</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a><span class="sd">    </span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a><span class="sd">        Parameters</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a><span class="sd">        ----------</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a><span class="sd">        state : hashable, optional</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a><span class="sd">            The state to initialize with probability 1. If None, the first node</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a><span class="sd">            in the graph (based on insertion order) is used.</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a><span class="sd">    </span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a><span class="sd">        Returns</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a><span class="sd">        -------</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a><span class="sd">        dict</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a><span class="sd">            A dictionary representing the initial distribution over states.</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a><span class="sd">            The selected state has probability 1, and all others have 0.</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a><span class="sd">    </span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="sd">        Examples</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a><span class="sd">        --------</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">        &gt;&gt;&gt; X0 = G.getEmptySystem()</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">        &gt;&gt;&gt; sum(X0.values())  # 1.0</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a><span class="sd">    </span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="sd">        Notes</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a><span class="sd">        -----</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">        - This method is useful for setting up deterministic initial conditions</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">          in transient simulations of a CTMC.</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a><span class="sd">        - The return format is compatible with methods like `transientProbs()`.</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>            <span class="n">first_node</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">))</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>        <span class="n">X0</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">first_node</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">}</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>        <span class="k">return</span> <span class="n">X0</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>        
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>    <span class="k">def</span> <span class="nf">transientProbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initialDistribution</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a><span class="sd">        Compute the transient state probabilities at time `t` for the CTMC.</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">    </span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">        This method solves the forward equation of a continuous-time Markov chain (CTMC):</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a><span class="sd">        X(t) = X0 · expm(Q·t), where `Q` is the generator (rate) matrix and `X0` is the</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="sd">        initial state distribution. It returns a dictionary mapping each state to its</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">        probability at time `t`.</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">    </span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">        Parameters</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a><span class="sd">        ----------</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a><span class="sd">        - `initialDistribution` : dict </span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a><span class="sd">            A dictionary mapping states (nodes) to their initial probabilities at time `t=0`.</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a><span class="sd">            The keys must match the nodes in the graph, and the values should sum to 1.    </span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a><span class="sd">            </span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a><span class="sd">        - `t` : float</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a><span class="sd">            The time at which the transient distribution is to be evaluated.</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a><span class="sd">    </span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a><span class="sd">        Returns</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a><span class="sd">        -------</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a><span class="sd">        dict</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a><span class="sd">            A dictionary mapping each state (node) to its probability at time `t`.</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">    </span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a><span class="sd">        Notes</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a><span class="sd">        -----</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a><span class="sd">        - The rate matrix `Q` is generated automatically if not yet computed.</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a><span class="sd">        - The state order in the rate matrix corresponds to the internal `_n2i` mapping.</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a><span class="sd">        - Internally, the dictionary `initialDistribution` is converted into a vector</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a><span class="sd">          aligned with the state indexing.</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a><span class="sd">        - The transient solution is computed using `scipy.linalg.expm` for matrix exponentiation.</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a><span class="sd">    </span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a><span class="sd">        Raises</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a><span class="sd">        ------</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a><span class="sd">        ValueError</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a><span class="sd">            If the input dictionary has missing states or probabilities that do not sum to 1.</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a><span class="sd">            (This is not enforced but recommended for correctness.)</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">createRateMatrix</span><span class="p">()</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>        <span class="n">X0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initialDistribution</span><span class="p">))</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>        
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>            <span class="n">X0</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">]</span> <span class="o">=</span> <span class="n">initialDistribution</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>                
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>        
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">X0</span> <span class="o">@</span> <span class="n">expm</span><span class="p">(</span><span class="n">Q</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>    
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>        
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>            <span class="n">matrix</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">]</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>                
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>        <span class="k">return</span> <span class="n">matrix</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>        
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>    <span class="k">def</span> <span class="nf">symSolveMarkovModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a><span class="sd">        Symbolically solve the global balance equations of the CTMC.</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a><span class="sd">    </span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a><span class="sd">        This method constructs and solves the system of symbolic equations for the</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="sd">        steady-state probabilities of each state in the CTMC. It uses symbolic transition</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a><span class="sd">        rates stored on the edges to form balance equations for each node, along with</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="sd">        the normalization constraint that all probabilities sum to 1.</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a><span class="sd">    </span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="sd">        Returns</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a><span class="sd">        -------</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a><span class="sd">        solution : dict</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">            A symbolic solution dictionary mapping SymPy symbols (e.g., x_{A}) to</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a><span class="sd">            expressions in terms of model parameters.</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a><span class="sd">    </span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="sd">        num_solution : dict</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a><span class="sd">            A numerical dictionary mapping each state (node) to its steady-state probability,</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a><span class="sd">            computed by substituting the numeric values from `self._subs` into the symbolic solution.</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a><span class="sd">    </span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a><span class="sd">        Notes</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a><span class="sd">        -----</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a><span class="sd">        - For each node `s`, a symbolic variable `x_{label}` is created using the node&#39;s label attribute.</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a><span class="sd">        - One balance equation is created per state: total inflow = total outflow.</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a><span class="sd">        - An additional constraint `sum(x_i) = 1` ensures proper normalization.</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a><span class="sd">        - The symbolic system is solved with `sympy.solve`, and the results are simplified.</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a><span class="sd">        - Numeric values are computed by substituting known parameter values (`self._subs`) into the symbolic solution.</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a><span class="sd">    </span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a><span class="sd">        Examples</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a><span class="sd">        --------</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a><span class="sd">        &gt;&gt;&gt; sym_sol, num_sol = G.symSolveMarkovModel()</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a><span class="sd">        &gt;&gt;&gt; sym_sol  # symbolic expressions for each state</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a><span class="sd">        &gt;&gt;&gt; num_sol  # evaluated numerical values for each state</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>        <span class="n">X</span><span class="o">=</span><span class="p">{}</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>        <span class="n">to_solve</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>            <span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x_</span><span class="se">{{</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>            <span class="n">to_solve</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>        <span class="c1">#%</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>        <span class="n">eqs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>             <span class="n">succ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="c1"># raus</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>             <span class="n">out_rate</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>             <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">succ</span><span class="p">):</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>                 <span class="c1">#out_rate += X[s]*self.edges[s, z][&quot;sym_rate&quot;]                 </span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>                 <span class="n">out_rate</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">z</span><span class="p">][</span><span class="s2">&quot;sym_rate&quot;</span><span class="p">]</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>             
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>             <span class="n">in_rate</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>             <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>                 <span class="c1">#in_rate += X[r]*self.edges[r,s][&quot;sym_rate&quot;] </span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>                 <span class="n">in_rate</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s</span><span class="p">][</span><span class="s2">&quot;sym_rate&quot;</span><span class="p">]</span> 
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>             <span class="n">eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">out_rate</span><span class="p">,</span> <span class="n">in_rate</span><span class="p">)</span> <span class="p">)</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>        <span class="c1">#% </span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>        <span class="n">Xsum</span> <span class="o">=</span> <span class="mi">0</span>    
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>            <span class="n">Xsum</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>        
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>        <span class="n">eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">Xsum</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span>    
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>        <span class="c1">#%</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,</span> <span class="n">to_solve</span><span class="p">)</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>        <span class="n">simplified_solution</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>        <span class="c1">#print(simplified_solution)</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>        <span class="n">num_solution</span> <span class="o">=</span> <span class="n">simplified_solution</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subs</span><span class="p">)</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>        <span class="c1">#num_dict =  {str(var): str(sol) for var, sol in simplified_solution.items()}</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>        <span class="n">num_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">num_solution</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">X</span><span class="p">}</span>                
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>        
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>        <span class="k">return</span> <span class="n">simplified_solution</span><span class="p">,</span> <span class="n">num_dict</span> 
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>    
</span></pre></div>


            </section>
                <section id="StateTransitionGraph">
                            <input id="StateTransitionGraph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">StateTransitionGraph</span><wbr>(<span class="base">networkx.classes.digraph.DiGraph</span>):

                <label class="view-source-button" for="StateTransitionGraph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph-90"><a href="#StateTransitionGraph-90"><span class="linenos">  90</span></a><span class="k">class</span> <span class="nc">StateTransitionGraph</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
</span><span id="StateTransitionGraph-91"><a href="#StateTransitionGraph-91"><span class="linenos">  91</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-92"><a href="#StateTransitionGraph-92"><span class="linenos">  92</span></a><span class="sd">    Initialize the StateTransitionGraph for continuous time Markov chains (CTMC). </span>
</span><span id="StateTransitionGraph-93"><a href="#StateTransitionGraph-93"><span class="linenos">  93</span></a><span class="sd">    Extends the networkx.Graph class to include additional methods and properties </span>
</span><span id="StateTransitionGraph-94"><a href="#StateTransitionGraph-94"><span class="linenos">  94</span></a><span class="sd">    for the analysis, visualization, and simulation of CTMCs. </span>
</span><span id="StateTransitionGraph-95"><a href="#StateTransitionGraph-95"><span class="linenos">  95</span></a><span class="sd">    The analysis allows deriving the state probabilities in the steady-state </span>
</span><span id="StateTransitionGraph-96"><a href="#StateTransitionGraph-96"><span class="linenos">  96</span></a><span class="sd">    and in the transient phase.</span>
</span><span id="StateTransitionGraph-97"><a href="#StateTransitionGraph-97"><span class="linenos">  97</span></a>
</span><span id="StateTransitionGraph-98"><a href="#StateTransitionGraph-98"><span class="linenos">  98</span></a><span class="sd">    This constructor sets up symbolic and numeric parameters for the state transition graph,</span>
</span><span id="StateTransitionGraph-99"><a href="#StateTransitionGraph-99"><span class="linenos">  99</span></a><span class="sd">    imports a constants module dynamically, and initializes internal data structures for</span>
</span><span id="StateTransitionGraph-100"><a href="#StateTransitionGraph-100"><span class="linenos"> 100</span></a><span class="sd">    rate matrix computation and steady-state probability analysis.</span>
</span><span id="StateTransitionGraph-101"><a href="#StateTransitionGraph-101"><span class="linenos"> 101</span></a>
</span><span id="StateTransitionGraph-102"><a href="#StateTransitionGraph-102"><span class="linenos"> 102</span></a><span class="sd">    Parameters</span>
</span><span id="StateTransitionGraph-103"><a href="#StateTransitionGraph-103"><span class="linenos"> 103</span></a><span class="sd">    ----------</span>
</span><span id="StateTransitionGraph-104"><a href="#StateTransitionGraph-104"><span class="linenos"> 104</span></a><span class="sd">    - `parameters` : dict  </span>
</span><span id="StateTransitionGraph-105"><a href="#StateTransitionGraph-105"><span class="linenos"> 105</span></a><span class="sd">      A dictionary mapping parameter names to their numerical values.     </span>
</span><span id="StateTransitionGraph-106"><a href="#StateTransitionGraph-106"><span class="linenos"> 106</span></a><span class="sd">        Example: {&#39;lambda&#39;: 1.0, &#39;mu&#39;: 1.0}. </span>
</span><span id="StateTransitionGraph-107"><a href="#StateTransitionGraph-107"><span class="linenos"> 107</span></a><span class="sd">        For each parameter key:</span>
</span><span id="StateTransitionGraph-108"><a href="#StateTransitionGraph-108"><span class="linenos"> 108</span></a><span class="sd">        - A symbolic variable is created using sympy.symbols. Can be accessed as `G.sym(&quot;key&quot;)` or `G.sym_key`</span>
</span><span id="StateTransitionGraph-109"><a href="#StateTransitionGraph-109"><span class="linenos"> 109</span></a><span class="sd">        - A variable is created which can be accessed via `G.key` (and the numerical value is assigned)</span>
</span><span id="StateTransitionGraph-110"><a href="#StateTransitionGraph-110"><span class="linenos"> 110</span></a><span class="sd">        - For the key=&quot;lambda&quot;, `G.lam` and `G.sym_lambda` are created</span>
</span><span id="StateTransitionGraph-111"><a href="#StateTransitionGraph-111"><span class="linenos"> 111</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-112"><a href="#StateTransitionGraph-112"><span class="linenos"> 112</span></a><span class="sd">        The parameters can be accessed via property `parameters`</span>
</span><span id="StateTransitionGraph-113"><a href="#StateTransitionGraph-113"><span class="linenos"> 113</span></a><span class="sd">    - `constants` : str, optional</span>
</span><span id="StateTransitionGraph-114"><a href="#StateTransitionGraph-114"><span class="linenos"> 114</span></a><span class="sd">        The name of a Python module (as string) to import dynamically and assign to `self.const`.</span>
</span><span id="StateTransitionGraph-115"><a href="#StateTransitionGraph-115"><span class="linenos"> 115</span></a><span class="sd">        This can be used to store global or user-defined constants.</span>
</span><span id="StateTransitionGraph-116"><a href="#StateTransitionGraph-116"><span class="linenos"> 116</span></a><span class="sd">        Default is &quot;Constants&quot;.</span>
</span><span id="StateTransitionGraph-117"><a href="#StateTransitionGraph-117"><span class="linenos"> 117</span></a><span class="sd">    - `*args` : tuple</span>
</span><span id="StateTransitionGraph-118"><a href="#StateTransitionGraph-118"><span class="linenos"> 118</span></a><span class="sd">        Additional positional arguments passed to the base `networkx.DiGraph` constructor.</span>
</span><span id="StateTransitionGraph-119"><a href="#StateTransitionGraph-119"><span class="linenos"> 119</span></a><span class="sd">    - `**kwargs` : dict</span>
</span><span id="StateTransitionGraph-120"><a href="#StateTransitionGraph-120"><span class="linenos"> 120</span></a><span class="sd">        Additional keyword arguments passed to the base `networkx.DiGraph` constructor.</span>
</span><span id="StateTransitionGraph-121"><a href="#StateTransitionGraph-121"><span class="linenos"> 121</span></a>
</span><span id="StateTransitionGraph-122"><a href="#StateTransitionGraph-122"><span class="linenos"> 122</span></a><span class="sd">    Attributes</span>
</span><span id="StateTransitionGraph-123"><a href="#StateTransitionGraph-123"><span class="linenos"> 123</span></a><span class="sd">    ----------</span>
</span><span id="StateTransitionGraph-124"><a href="#StateTransitionGraph-124"><span class="linenos"> 124</span></a><span class="sd">    - `_rate_matrix` : ndarray or None  </span>
</span><span id="StateTransitionGraph-125"><a href="#StateTransitionGraph-125"><span class="linenos"> 125</span></a><span class="sd">      The continuous-time rate matrix `Q` of the CTMC. Computed when calling `createRateMatrix()`.</span>
</span><span id="StateTransitionGraph-126"><a href="#StateTransitionGraph-126"><span class="linenos"> 126</span></a><span class="sd">    - `_state_probabilities` : dict or None  </span>
</span><span id="StateTransitionGraph-127"><a href="#StateTransitionGraph-127"><span class="linenos"> 127</span></a><span class="sd">      Dictionary of steady-state probabilities, computed via `calcSteadyStateProbs()`.</span>
</span><span id="StateTransitionGraph-128"><a href="#StateTransitionGraph-128"><span class="linenos"> 128</span></a><span class="sd">    - `_n2i` : dict or None  </span>
</span><span id="StateTransitionGraph-129"><a href="#StateTransitionGraph-129"><span class="linenos"> 129</span></a><span class="sd">      Mapping from node identifiers to matrix row/column indices used for rate matrix construction.</span>
</span><span id="StateTransitionGraph-130"><a href="#StateTransitionGraph-130"><span class="linenos"> 130</span></a><span class="sd">    - `_sym` : dict  </span>
</span><span id="StateTransitionGraph-131"><a href="#StateTransitionGraph-131"><span class="linenos"> 131</span></a><span class="sd">      Mapping of parameter names (strings) to their symbolic `sympy` representations.</span>
</span><span id="StateTransitionGraph-132"><a href="#StateTransitionGraph-132"><span class="linenos"> 132</span></a><span class="sd">    - `_subs` : dict  </span>
</span><span id="StateTransitionGraph-133"><a href="#StateTransitionGraph-133"><span class="linenos"> 133</span></a><span class="sd">      Mapping from symbolic parameters to their numerical values (used for substitutions).</span>
</span><span id="StateTransitionGraph-134"><a href="#StateTransitionGraph-134"><span class="linenos"> 134</span></a><span class="sd">    - `_parameters` : dict  </span>
</span><span id="StateTransitionGraph-135"><a href="#StateTransitionGraph-135"><span class="linenos"> 135</span></a><span class="sd">      Copy of the original parameter dictionary passed at initialization.</span>
</span><span id="StateTransitionGraph-136"><a href="#StateTransitionGraph-136"><span class="linenos"> 136</span></a><span class="sd">    - `_transitionProbabilitesComputed` : bool  </span>
</span><span id="StateTransitionGraph-137"><a href="#StateTransitionGraph-137"><span class="linenos"> 137</span></a><span class="sd">      Internal flag indicating whether transition probabilities for the embedded Markov chain</span>
</span><span id="StateTransitionGraph-138"><a href="#StateTransitionGraph-138"><span class="linenos"> 138</span></a><span class="sd">      have been computed.</span>
</span><span id="StateTransitionGraph-139"><a href="#StateTransitionGraph-139"><span class="linenos"> 139</span></a><span class="sd">    - `const` : module  </span>
</span><span id="StateTransitionGraph-140"><a href="#StateTransitionGraph-140"><span class="linenos"> 140</span></a><span class="sd">      Dynamically imported module (default `&quot;Constants&quot;`), used for storing user-defined constants </span>
</span><span id="StateTransitionGraph-141"><a href="#StateTransitionGraph-141"><span class="linenos"> 141</span></a><span class="sd">      such as colors or transition IDs.</span>
</span><span id="StateTransitionGraph-142"><a href="#StateTransitionGraph-142"><span class="linenos"> 142</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph-143"><a href="#StateTransitionGraph-143"><span class="linenos"> 143</span></a><span class="sd">    Inherits</span>
</span><span id="StateTransitionGraph-144"><a href="#StateTransitionGraph-144"><span class="linenos"> 144</span></a><span class="sd">    --------</span>
</span><span id="StateTransitionGraph-145"><a href="#StateTransitionGraph-145"><span class="linenos"> 145</span></a><span class="sd">        networkx.Graph: The base graph class from NetworkX.</span>
</span><span id="StateTransitionGraph-146"><a href="#StateTransitionGraph-146"><span class="linenos"> 146</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-147"><a href="#StateTransitionGraph-147"><span class="linenos"> 147</span></a>
</span><span id="StateTransitionGraph-148"><a href="#StateTransitionGraph-148"><span class="linenos"> 148</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">constants</span><span class="o">=</span><span class="s2">&quot;Constants&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="StateTransitionGraph-149"><a href="#StateTransitionGraph-149"><span class="linenos"> 149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-150"><a href="#StateTransitionGraph-150"><span class="linenos"> 150</span></a><span class="sd">        Initialize the state transition graph with symbolic parameters.</span>
</span><span id="StateTransitionGraph-151"><a href="#StateTransitionGraph-151"><span class="linenos"> 151</span></a>
</span><span id="StateTransitionGraph-152"><a href="#StateTransitionGraph-152"><span class="linenos"> 152</span></a><span class="sd">        This constructor sets up the symbolic and numerical environment for modeling</span>
</span><span id="StateTransitionGraph-153"><a href="#StateTransitionGraph-153"><span class="linenos"> 153</span></a><span class="sd">        a CTMC. Parameters are stored as both symbolic expressions and numerical values,</span>
</span><span id="StateTransitionGraph-154"><a href="#StateTransitionGraph-154"><span class="linenos"> 154</span></a><span class="sd">        and convenient attribute access is provided for both forms.</span>
</span><span id="StateTransitionGraph-155"><a href="#StateTransitionGraph-155"><span class="linenos"> 155</span></a>
</span><span id="StateTransitionGraph-156"><a href="#StateTransitionGraph-156"><span class="linenos"> 156</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-157"><a href="#StateTransitionGraph-157"><span class="linenos"> 157</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-158"><a href="#StateTransitionGraph-158"><span class="linenos"> 158</span></a><span class="sd">        - `parameters` : dict  </span>
</span><span id="StateTransitionGraph-159"><a href="#StateTransitionGraph-159"><span class="linenos"> 159</span></a><span class="sd">          A dictionary mapping parameter names to their numerical values.     </span>
</span><span id="StateTransitionGraph-160"><a href="#StateTransitionGraph-160"><span class="linenos"> 160</span></a><span class="sd">            Example: {&#39;lambda&#39;: 1.0, &#39;mu&#39;: 1.0}. </span>
</span><span id="StateTransitionGraph-161"><a href="#StateTransitionGraph-161"><span class="linenos"> 161</span></a><span class="sd">            For each parameter key:</span>
</span><span id="StateTransitionGraph-162"><a href="#StateTransitionGraph-162"><span class="linenos"> 162</span></a><span class="sd">            - A symbolic variable is created using sympy.symbols. Can be accessed as `G.sym(&quot;key&quot;)` or `G.sym_key`</span>
</span><span id="StateTransitionGraph-163"><a href="#StateTransitionGraph-163"><span class="linenos"> 163</span></a><span class="sd">            - A variable is created which can be accessed via `G.key` (and the numerical value is assigned)</span>
</span><span id="StateTransitionGraph-164"><a href="#StateTransitionGraph-164"><span class="linenos"> 164</span></a><span class="sd">            - For the key=&quot;lambda&quot;, `G.lam` and `G.sym_lambda` are created</span>
</span><span id="StateTransitionGraph-165"><a href="#StateTransitionGraph-165"><span class="linenos"> 165</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph-166"><a href="#StateTransitionGraph-166"><span class="linenos"> 166</span></a><span class="sd">            The parameters can be accessed via property `parameters`</span>
</span><span id="StateTransitionGraph-167"><a href="#StateTransitionGraph-167"><span class="linenos"> 167</span></a><span class="sd">        - `constants` : str, optional</span>
</span><span id="StateTransitionGraph-168"><a href="#StateTransitionGraph-168"><span class="linenos"> 168</span></a><span class="sd">            The name of a Python module (as string) to import dynamically and assign to `self.const`.</span>
</span><span id="StateTransitionGraph-169"><a href="#StateTransitionGraph-169"><span class="linenos"> 169</span></a><span class="sd">            This can be used to store global or user-defined constants.</span>
</span><span id="StateTransitionGraph-170"><a href="#StateTransitionGraph-170"><span class="linenos"> 170</span></a><span class="sd">            Default is &quot;Constants&quot;.</span>
</span><span id="StateTransitionGraph-171"><a href="#StateTransitionGraph-171"><span class="linenos"> 171</span></a><span class="sd">        - `*args` : tuple</span>
</span><span id="StateTransitionGraph-172"><a href="#StateTransitionGraph-172"><span class="linenos"> 172</span></a><span class="sd">            Additional positional arguments passed to the base `networkx.DiGraph` constructor.</span>
</span><span id="StateTransitionGraph-173"><a href="#StateTransitionGraph-173"><span class="linenos"> 173</span></a><span class="sd">        - `**kwargs` : dict</span>
</span><span id="StateTransitionGraph-174"><a href="#StateTransitionGraph-174"><span class="linenos"> 174</span></a><span class="sd">            Additional keyword arguments passed to the base `networkx.DiGraph` constructor.</span>
</span><span id="StateTransitionGraph-175"><a href="#StateTransitionGraph-175"><span class="linenos"> 175</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph-176"><a href="#StateTransitionGraph-176"><span class="linenos"> 176</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="StateTransitionGraph-177"><a href="#StateTransitionGraph-177"><span class="linenos"> 177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Rate Matrix Q of this transition graph</span>
</span><span id="StateTransitionGraph-178"><a href="#StateTransitionGraph-178"><span class="linenos"> 178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state_probabilities</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># steady state proabilities of this CTMC</span>
</span><span id="StateTransitionGraph-179"><a href="#StateTransitionGraph-179"><span class="linenos"> 179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># internal index for generating the rate matrix Q: dictionary (node to index)</span>
</span><span id="StateTransitionGraph-180"><a href="#StateTransitionGraph-180"><span class="linenos"> 180</span></a>        
</span><span id="StateTransitionGraph-181"><a href="#StateTransitionGraph-181"><span class="linenos"> 181</span></a>        <span class="c1">#parameters = {&#39;lambda&#39;: 1.0, &#39;mu&#39;:1.0, &#39;n&#39;:5}</span>
</span><span id="StateTransitionGraph-182"><a href="#StateTransitionGraph-182"><span class="linenos"> 182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="StateTransitionGraph-183"><a href="#StateTransitionGraph-183"><span class="linenos"> 183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">}</span>
</span><span id="StateTransitionGraph-184"><a href="#StateTransitionGraph-184"><span class="linenos"> 184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_subs</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># contains symbolic parameter as key and provides numerical value for computation.</span>
</span><span id="StateTransitionGraph-185"><a href="#StateTransitionGraph-185"><span class="linenos"> 185</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
</span><span id="StateTransitionGraph-186"><a href="#StateTransitionGraph-186"><span class="linenos"> 186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_subs</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">]</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> 
</span><span id="StateTransitionGraph-187"><a href="#StateTransitionGraph-187"><span class="linenos"> 187</span></a>
</span><span id="StateTransitionGraph-188"><a href="#StateTransitionGraph-188"><span class="linenos"> 188</span></a>        <span class="c1"># access to parameters and symbols using dot-notation, e.g. G.lam, G.sym_lambda, or G.sym(&quot;lambda&quot;)</span>
</span><span id="StateTransitionGraph-189"><a href="#StateTransitionGraph-189"><span class="linenos"> 189</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StateTransitionGraph-190"><a href="#StateTransitionGraph-190"><span class="linenos"> 190</span></a>            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s1">&#39;lambda&#39;</span><span class="p">:</span>
</span><span id="StateTransitionGraph-191"><a href="#StateTransitionGraph-191"><span class="linenos"> 191</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;lam&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="StateTransitionGraph-192"><a href="#StateTransitionGraph-192"><span class="linenos"> 192</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph-193"><a href="#StateTransitionGraph-193"><span class="linenos"> 193</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="StateTransitionGraph-194"><a href="#StateTransitionGraph-194"><span class="linenos"> 194</span></a>            
</span><span id="StateTransitionGraph-195"><a href="#StateTransitionGraph-195"><span class="linenos"> 195</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;sym_&quot;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="StateTransitionGraph-196"><a href="#StateTransitionGraph-196"><span class="linenos"> 196</span></a>            
</span><span id="StateTransitionGraph-197"><a href="#StateTransitionGraph-197"><span class="linenos"> 197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transitionProbabilitesComputed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="StateTransitionGraph-198"><a href="#StateTransitionGraph-198"><span class="linenos"> 198</span></a>        
</span><span id="StateTransitionGraph-199"><a href="#StateTransitionGraph-199"><span class="linenos"> 199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_const</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">constants</span><span class="p">)</span>
</span><span id="StateTransitionGraph-200"><a href="#StateTransitionGraph-200"><span class="linenos"> 200</span></a>
</span><span id="StateTransitionGraph-201"><a href="#StateTransitionGraph-201"><span class="linenos"> 201</span></a>        
</span><span id="StateTransitionGraph-202"><a href="#StateTransitionGraph-202"><span class="linenos"> 202</span></a>        
</span><span id="StateTransitionGraph-203"><a href="#StateTransitionGraph-203"><span class="linenos"> 203</span></a>    <span class="k">def</span> <span class="nf">addState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="StateTransitionGraph-204"><a href="#StateTransitionGraph-204"><span class="linenos"> 204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-205"><a href="#StateTransitionGraph-205"><span class="linenos"> 205</span></a><span class="sd">        Add a state (node) to the graph with optional color and label attributes.</span>
</span><span id="StateTransitionGraph-206"><a href="#StateTransitionGraph-206"><span class="linenos"> 206</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-207"><a href="#StateTransitionGraph-207"><span class="linenos"> 207</span></a><span class="sd">        If the node already exists, its attributes are updated with the provided values.</span>
</span><span id="StateTransitionGraph-208"><a href="#StateTransitionGraph-208"><span class="linenos"> 208</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-209"><a href="#StateTransitionGraph-209"><span class="linenos"> 209</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-210"><a href="#StateTransitionGraph-210"><span class="linenos"> 210</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-211"><a href="#StateTransitionGraph-211"><span class="linenos"> 211</span></a><span class="sd">        - state : hashable</span>
</span><span id="StateTransitionGraph-212"><a href="#StateTransitionGraph-212"><span class="linenos"> 212</span></a><span class="sd">            The identifier for the state. Can be a string, int, or a tuple. If no label</span>
</span><span id="StateTransitionGraph-213"><a href="#StateTransitionGraph-213"><span class="linenos"> 213</span></a><span class="sd">            is provided, the label will be auto-generated as:</span>
</span><span id="StateTransitionGraph-214"><a href="#StateTransitionGraph-214"><span class="linenos"> 214</span></a><span class="sd">            - comma-separated string for tuples (e.g., `(1, 2)` -&gt; `&#39;1,2&#39;`)</span>
</span><span id="StateTransitionGraph-215"><a href="#StateTransitionGraph-215"><span class="linenos"> 215</span></a><span class="sd">            - stringified value for other types</span>
</span><span id="StateTransitionGraph-216"><a href="#StateTransitionGraph-216"><span class="linenos"> 216</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-217"><a href="#StateTransitionGraph-217"><span class="linenos"> 217</span></a><span class="sd">        - color : str, optional</span>
</span><span id="StateTransitionGraph-218"><a href="#StateTransitionGraph-218"><span class="linenos"> 218</span></a><span class="sd">            The color assigned to the state (used for visualization).</span>
</span><span id="StateTransitionGraph-219"><a href="#StateTransitionGraph-219"><span class="linenos"> 219</span></a><span class="sd">            If not specified, defaults to `self.const.COLOR_NODE_DEFAULT`.</span>
</span><span id="StateTransitionGraph-220"><a href="#StateTransitionGraph-220"><span class="linenos"> 220</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-221"><a href="#StateTransitionGraph-221"><span class="linenos"> 221</span></a><span class="sd">        - label : str, optional</span>
</span><span id="StateTransitionGraph-222"><a href="#StateTransitionGraph-222"><span class="linenos"> 222</span></a><span class="sd">            A label for the node (used for display or annotation). If not provided,</span>
</span><span id="StateTransitionGraph-223"><a href="#StateTransitionGraph-223"><span class="linenos"> 223</span></a><span class="sd">            it will be auto-generated from the state identifier.</span>
</span><span id="StateTransitionGraph-224"><a href="#StateTransitionGraph-224"><span class="linenos"> 224</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-225"><a href="#StateTransitionGraph-225"><span class="linenos"> 225</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-226"><a href="#StateTransitionGraph-226"><span class="linenos"> 226</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-227"><a href="#StateTransitionGraph-227"><span class="linenos"> 227</span></a><span class="sd">        - This method wraps `self.add_node()` from NetworkX.</span>
</span><span id="StateTransitionGraph-228"><a href="#StateTransitionGraph-228"><span class="linenos"> 228</span></a><span class="sd">        - If the node already exists in the graph, this method does not raise an error;</span>
</span><span id="StateTransitionGraph-229"><a href="#StateTransitionGraph-229"><span class="linenos"> 229</span></a><span class="sd">          it will update the node’s existing attributes.</span>
</span><span id="StateTransitionGraph-230"><a href="#StateTransitionGraph-230"><span class="linenos"> 230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-231"><a href="#StateTransitionGraph-231"><span class="linenos"> 231</span></a>        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-232"><a href="#StateTransitionGraph-232"><span class="linenos"> 232</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="StateTransitionGraph-233"><a href="#StateTransitionGraph-233"><span class="linenos"> 233</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">state</span><span class="p">))</span> <span class="c1"># if state is a tuple</span>
</span><span id="StateTransitionGraph-234"><a href="#StateTransitionGraph-234"><span class="linenos"> 234</span></a>            <span class="k">else</span><span class="p">:</span> 
</span><span id="StateTransitionGraph-235"><a href="#StateTransitionGraph-235"><span class="linenos"> 235</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="StateTransitionGraph-236"><a href="#StateTransitionGraph-236"><span class="linenos"> 236</span></a>            <span class="c1">#self.nodes[state][&quot;label&quot;] = label</span>
</span><span id="StateTransitionGraph-237"><a href="#StateTransitionGraph-237"><span class="linenos"> 237</span></a>        
</span><span id="StateTransitionGraph-238"><a href="#StateTransitionGraph-238"><span class="linenos"> 238</span></a>        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-239"><a href="#StateTransitionGraph-239"><span class="linenos"> 239</span></a>            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_NODE_DEFAULT</span>
</span><span id="StateTransitionGraph-240"><a href="#StateTransitionGraph-240"><span class="linenos"> 240</span></a>        
</span><span id="StateTransitionGraph-241"><a href="#StateTransitionGraph-241"><span class="linenos"> 241</span></a>        <span class="c1"># no error if the node already exists.Attributes get updated if you pass them again.</span>
</span><span id="StateTransitionGraph-242"><a href="#StateTransitionGraph-242"><span class="linenos"> 242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span><span id="StateTransitionGraph-243"><a href="#StateTransitionGraph-243"><span class="linenos"> 243</span></a>        
</span><span id="StateTransitionGraph-244"><a href="#StateTransitionGraph-244"><span class="linenos"> 244</span></a>    <span class="k">def</span> <span class="nf">setStateProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="StateTransitionGraph-245"><a href="#StateTransitionGraph-245"><span class="linenos"> 245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-246"><a href="#StateTransitionGraph-246"><span class="linenos"> 246</span></a><span class="sd">        Update visual or metadata properties for an existing state (node) in the graph.</span>
</span><span id="StateTransitionGraph-247"><a href="#StateTransitionGraph-247"><span class="linenos"> 247</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-248"><a href="#StateTransitionGraph-248"><span class="linenos"> 248</span></a><span class="sd">        This method updates the node&#39;s attributes such as color, label, and any additional</span>
</span><span id="StateTransitionGraph-249"><a href="#StateTransitionGraph-249"><span class="linenos"> 249</span></a><span class="sd">        custom key-value pairs. The node must already exist in the graph.</span>
</span><span id="StateTransitionGraph-250"><a href="#StateTransitionGraph-250"><span class="linenos"> 250</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-251"><a href="#StateTransitionGraph-251"><span class="linenos"> 251</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-252"><a href="#StateTransitionGraph-252"><span class="linenos"> 252</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-253"><a href="#StateTransitionGraph-253"><span class="linenos"> 253</span></a><span class="sd">        - state : hashable</span>
</span><span id="StateTransitionGraph-254"><a href="#StateTransitionGraph-254"><span class="linenos"> 254</span></a><span class="sd">            Identifier of the state to update. Must be a node already present in the graph.</span>
</span><span id="StateTransitionGraph-255"><a href="#StateTransitionGraph-255"><span class="linenos"> 255</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-256"><a href="#StateTransitionGraph-256"><span class="linenos"> 256</span></a><span class="sd">        - color : str, optional</span>
</span><span id="StateTransitionGraph-257"><a href="#StateTransitionGraph-257"><span class="linenos"> 257</span></a><span class="sd">            Color assigned to the node, typically used for visualization. If not provided,</span>
</span><span id="StateTransitionGraph-258"><a href="#StateTransitionGraph-258"><span class="linenos"> 258</span></a><span class="sd">            the default node color (`self._const.COLOR_NODE_DEFAULT`) is used.</span>
</span><span id="StateTransitionGraph-259"><a href="#StateTransitionGraph-259"><span class="linenos"> 259</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-260"><a href="#StateTransitionGraph-260"><span class="linenos"> 260</span></a><span class="sd">        - label : str, optional</span>
</span><span id="StateTransitionGraph-261"><a href="#StateTransitionGraph-261"><span class="linenos"> 261</span></a><span class="sd">            Label for the node. If not provided, it is auto-generated from the state ID</span>
</span><span id="StateTransitionGraph-262"><a href="#StateTransitionGraph-262"><span class="linenos"> 262</span></a><span class="sd">            (especially for tuples).</span>
</span><span id="StateTransitionGraph-263"><a href="#StateTransitionGraph-263"><span class="linenos"> 263</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-264"><a href="#StateTransitionGraph-264"><span class="linenos"> 264</span></a><span class="sd">        - **kwargs : dict</span>
</span><span id="StateTransitionGraph-265"><a href="#StateTransitionGraph-265"><span class="linenos"> 265</span></a><span class="sd">            Arbitrary additional key-value pairs to set as node attributes. These can include</span>
</span><span id="StateTransitionGraph-266"><a href="#StateTransitionGraph-266"><span class="linenos"> 266</span></a><span class="sd">            any custom metadata.</span>
</span><span id="StateTransitionGraph-267"><a href="#StateTransitionGraph-267"><span class="linenos"> 267</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-268"><a href="#StateTransitionGraph-268"><span class="linenos"> 268</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph-269"><a href="#StateTransitionGraph-269"><span class="linenos"> 269</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph-270"><a href="#StateTransitionGraph-270"><span class="linenos"> 270</span></a><span class="sd">        KeyError</span>
</span><span id="StateTransitionGraph-271"><a href="#StateTransitionGraph-271"><span class="linenos"> 271</span></a><span class="sd">            If the specified state is not present in the graph.</span>
</span><span id="StateTransitionGraph-272"><a href="#StateTransitionGraph-272"><span class="linenos"> 272</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-273"><a href="#StateTransitionGraph-273"><span class="linenos"> 273</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-274"><a href="#StateTransitionGraph-274"><span class="linenos"> 274</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-275"><a href="#StateTransitionGraph-275"><span class="linenos"> 275</span></a><span class="sd">        - This method ensures that required attributes (like `color` and `label`) are set for visualization. </span>
</span><span id="StateTransitionGraph-276"><a href="#StateTransitionGraph-276"><span class="linenos"> 276</span></a><span class="sd">        - Existing node attributes are updated or extended with `kwargs`.</span>
</span><span id="StateTransitionGraph-277"><a href="#StateTransitionGraph-277"><span class="linenos"> 277</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph-278"><a href="#StateTransitionGraph-278"><span class="linenos"> 278</span></a>        <span class="k">if</span> <span class="n">state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="StateTransitionGraph-279"><a href="#StateTransitionGraph-279"><span class="linenos"> 279</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State &#39;</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&#39; does not exist in the graph.&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-280"><a href="#StateTransitionGraph-280"><span class="linenos"> 280</span></a>        
</span><span id="StateTransitionGraph-281"><a href="#StateTransitionGraph-281"><span class="linenos"> 281</span></a>        <span class="c1"># mandatory for plotting</span>
</span><span id="StateTransitionGraph-282"><a href="#StateTransitionGraph-282"><span class="linenos"> 282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addState</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
</span><span id="StateTransitionGraph-283"><a href="#StateTransitionGraph-283"><span class="linenos"> 283</span></a>        
</span><span id="StateTransitionGraph-284"><a href="#StateTransitionGraph-284"><span class="linenos"> 284</span></a>        <span class="c1"># # Add any additional attributes</span>
</span><span id="StateTransitionGraph-285"><a href="#StateTransitionGraph-285"><span class="linenos"> 285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">state</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="StateTransitionGraph-286"><a href="#StateTransitionGraph-286"><span class="linenos"> 286</span></a>        
</span><span id="StateTransitionGraph-287"><a href="#StateTransitionGraph-287"><span class="linenos"> 287</span></a>    <span class="k">def</span> <span class="nf">setAllStateDefaultProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="StateTransitionGraph-288"><a href="#StateTransitionGraph-288"><span class="linenos"> 288</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-289"><a href="#StateTransitionGraph-289"><span class="linenos"> 289</span></a><span class="sd">        Set default visual and metadata properties for all states (nodes) in the graph.</span>
</span><span id="StateTransitionGraph-290"><a href="#StateTransitionGraph-290"><span class="linenos"> 290</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-291"><a href="#StateTransitionGraph-291"><span class="linenos"> 291</span></a><span class="sd">        This method applies `setStateProperties()` to every node, ensuring each state</span>
</span><span id="StateTransitionGraph-292"><a href="#StateTransitionGraph-292"><span class="linenos"> 292</span></a><span class="sd">        has at least the required default attributes (e.g., color and label).</span>
</span><span id="StateTransitionGraph-293"><a href="#StateTransitionGraph-293"><span class="linenos"> 293</span></a><span class="sd">        Any additional keyword arguments are passed to `setStateProperties()`.</span>
</span><span id="StateTransitionGraph-294"><a href="#StateTransitionGraph-294"><span class="linenos"> 294</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-295"><a href="#StateTransitionGraph-295"><span class="linenos"> 295</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-296"><a href="#StateTransitionGraph-296"><span class="linenos"> 296</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-297"><a href="#StateTransitionGraph-297"><span class="linenos"> 297</span></a><span class="sd">        **kwargs : dict, optional</span>
</span><span id="StateTransitionGraph-298"><a href="#StateTransitionGraph-298"><span class="linenos"> 298</span></a><span class="sd">            Optional keyword arguments to apply uniformly to all nodes,</span>
</span><span id="StateTransitionGraph-299"><a href="#StateTransitionGraph-299"><span class="linenos"> 299</span></a><span class="sd">            such as color=&#39;gray&#39;, group=&#39;core&#39;, etc.</span>
</span><span id="StateTransitionGraph-300"><a href="#StateTransitionGraph-300"><span class="linenos"> 300</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-301"><a href="#StateTransitionGraph-301"><span class="linenos"> 301</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-302"><a href="#StateTransitionGraph-302"><span class="linenos"> 302</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-303"><a href="#StateTransitionGraph-303"><span class="linenos"> 303</span></a><span class="sd">        - This method is useful for initializing node attributes before plotting</span>
</span><span id="StateTransitionGraph-304"><a href="#StateTransitionGraph-304"><span class="linenos"> 304</span></a><span class="sd">          or performing other graph-based computations.</span>
</span><span id="StateTransitionGraph-305"><a href="#StateTransitionGraph-305"><span class="linenos"> 305</span></a><span class="sd">        - Nodes without existing attributes will receive defaults via `addState()`.</span>
</span><span id="StateTransitionGraph-306"><a href="#StateTransitionGraph-306"><span class="linenos"> 306</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-307"><a href="#StateTransitionGraph-307"><span class="linenos"> 307</span></a>        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
</span><span id="StateTransitionGraph-308"><a href="#StateTransitionGraph-308"><span class="linenos"> 308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">setStateProperties</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="StateTransitionGraph-309"><a href="#StateTransitionGraph-309"><span class="linenos"> 309</span></a>
</span><span id="StateTransitionGraph-310"><a href="#StateTransitionGraph-310"><span class="linenos"> 310</span></a>        
</span><span id="StateTransitionGraph-311"><a href="#StateTransitionGraph-311"><span class="linenos"> 311</span></a>    <span class="c1">#def addTransition(self, origin_state, list_destination_state, sym_rate, color=plt.cm.tab10(5), tid = None):        </span>
</span><span id="StateTransitionGraph-312"><a href="#StateTransitionGraph-312"><span class="linenos"> 312</span></a>    <span class="k">def</span> <span class="nf">addTransition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin_state</span><span class="p">,</span> <span class="n">destination_state</span><span class="p">,</span> <span class="n">sym_rate</span><span class="p">,</span> <span class="n">tid</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>     
</span><span id="StateTransitionGraph-313"><a href="#StateTransitionGraph-313"><span class="linenos"> 313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-314"><a href="#StateTransitionGraph-314"><span class="linenos"> 314</span></a><span class="sd">        Add a directed transition (edge) between two states with a symbolic transition rate.</span>
</span><span id="StateTransitionGraph-315"><a href="#StateTransitionGraph-315"><span class="linenos"> 315</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-316"><a href="#StateTransitionGraph-316"><span class="linenos"> 316</span></a><span class="sd">        This method adds a directed edge from `origin_state` to `destination_state`,</span>
</span><span id="StateTransitionGraph-317"><a href="#StateTransitionGraph-317"><span class="linenos"> 317</span></a><span class="sd">        stores both the symbolic and numerical rate, and sets optional display properties</span>
</span><span id="StateTransitionGraph-318"><a href="#StateTransitionGraph-318"><span class="linenos"> 318</span></a><span class="sd">        such as color, label, and transition ID. If the edge already exists, a warning is issued.</span>
</span><span id="StateTransitionGraph-319"><a href="#StateTransitionGraph-319"><span class="linenos"> 319</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-320"><a href="#StateTransitionGraph-320"><span class="linenos"> 320</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-321"><a href="#StateTransitionGraph-321"><span class="linenos"> 321</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-322"><a href="#StateTransitionGraph-322"><span class="linenos"> 322</span></a><span class="sd">        - origin_state : hashable</span>
</span><span id="StateTransitionGraph-323"><a href="#StateTransitionGraph-323"><span class="linenos"> 323</span></a><span class="sd">            The source node (state) of the transition.</span>
</span><span id="StateTransitionGraph-324"><a href="#StateTransitionGraph-324"><span class="linenos"> 324</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-325"><a href="#StateTransitionGraph-325"><span class="linenos"> 325</span></a><span class="sd">        - destination_state : hashable</span>
</span><span id="StateTransitionGraph-326"><a href="#StateTransitionGraph-326"><span class="linenos"> 326</span></a><span class="sd">            The target node (state) of the transition.</span>
</span><span id="StateTransitionGraph-327"><a href="#StateTransitionGraph-327"><span class="linenos"> 327</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-328"><a href="#StateTransitionGraph-328"><span class="linenos"> 328</span></a><span class="sd">        - sym_rate : sympy.Expr</span>
</span><span id="StateTransitionGraph-329"><a href="#StateTransitionGraph-329"><span class="linenos"> 329</span></a><span class="sd">            A symbolic expression representing the transition rate.</span>
</span><span id="StateTransitionGraph-330"><a href="#StateTransitionGraph-330"><span class="linenos"> 330</span></a><span class="sd">            This will be numerically evaluated using internal substitutions (`self._subs`).</span>
</span><span id="StateTransitionGraph-331"><a href="#StateTransitionGraph-331"><span class="linenos"> 331</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-332"><a href="#StateTransitionGraph-332"><span class="linenos"> 332</span></a><span class="sd">        - tid : str or int, optional</span>
</span><span id="StateTransitionGraph-333"><a href="#StateTransitionGraph-333"><span class="linenos"> 333</span></a><span class="sd">            A transition identifier (e.g. for grouping or styling).</span>
</span><span id="StateTransitionGraph-334"><a href="#StateTransitionGraph-334"><span class="linenos"> 334</span></a><span class="sd">            If provided, the color will default to `self._const.COLOR_TRANSITIONS[tid]` if not set explicitly.</span>
</span><span id="StateTransitionGraph-335"><a href="#StateTransitionGraph-335"><span class="linenos"> 335</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-336"><a href="#StateTransitionGraph-336"><span class="linenos"> 336</span></a><span class="sd">        - color : str, optional</span>
</span><span id="StateTransitionGraph-337"><a href="#StateTransitionGraph-337"><span class="linenos"> 337</span></a><span class="sd">            Color for the edge (used in visualization). Defaults to the transition-specific color</span>
</span><span id="StateTransitionGraph-338"><a href="#StateTransitionGraph-338"><span class="linenos"> 338</span></a><span class="sd">            if `tid` is provided.</span>
</span><span id="StateTransitionGraph-339"><a href="#StateTransitionGraph-339"><span class="linenos"> 339</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-340"><a href="#StateTransitionGraph-340"><span class="linenos"> 340</span></a><span class="sd">        - label : str, optional</span>
</span><span id="StateTransitionGraph-341"><a href="#StateTransitionGraph-341"><span class="linenos"> 341</span></a><span class="sd">            LaTeX-formatted string for labeling the edge. If not provided, a default label is</span>
</span><span id="StateTransitionGraph-342"><a href="#StateTransitionGraph-342"><span class="linenos"> 342</span></a><span class="sd">            generated using `sympy.latex(sym_rate)`.</span>
</span><span id="StateTransitionGraph-343"><a href="#StateTransitionGraph-343"><span class="linenos"> 343</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-344"><a href="#StateTransitionGraph-344"><span class="linenos"> 344</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-345"><a href="#StateTransitionGraph-345"><span class="linenos"> 345</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-346"><a href="#StateTransitionGraph-346"><span class="linenos"> 346</span></a><span class="sd">        - The numeric rate is computed by substituting known parameter values into `sym_rate`.</span>
</span><span id="StateTransitionGraph-347"><a href="#StateTransitionGraph-347"><span class="linenos"> 347</span></a><span class="sd">        - The following attributes are stored on the edge:</span>
</span><span id="StateTransitionGraph-348"><a href="#StateTransitionGraph-348"><span class="linenos"> 348</span></a><span class="sd">            - `rate` (float): numeric value of the transition rate</span>
</span><span id="StateTransitionGraph-349"><a href="#StateTransitionGraph-349"><span class="linenos"> 349</span></a><span class="sd">            - `sym_rate` (sympy.Expr): original symbolic expression</span>
</span><span id="StateTransitionGraph-350"><a href="#StateTransitionGraph-350"><span class="linenos"> 350</span></a><span class="sd">            - `label` (str): display label</span>
</span><span id="StateTransitionGraph-351"><a href="#StateTransitionGraph-351"><span class="linenos"> 351</span></a><span class="sd">            - `color` (str): edge color</span>
</span><span id="StateTransitionGraph-352"><a href="#StateTransitionGraph-352"><span class="linenos"> 352</span></a><span class="sd">            - `tid` (str or int): transition ID</span>
</span><span id="StateTransitionGraph-353"><a href="#StateTransitionGraph-353"><span class="linenos"> 353</span></a><span class="sd">        - If the edge already exists, a `UserWarning` is issued but the edge is still overwritten.</span>
</span><span id="StateTransitionGraph-354"><a href="#StateTransitionGraph-354"><span class="linenos"> 354</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph-355"><a href="#StateTransitionGraph-355"><span class="linenos"> 355</span></a>        <span class="k">if</span> <span class="n">tid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-356"><a href="#StateTransitionGraph-356"><span class="linenos"> 356</span></a>            <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-357"><a href="#StateTransitionGraph-357"><span class="linenos"> 357</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_TRANSITIONS</span><span class="p">[</span> <span class="n">tid</span> <span class="p">]</span>
</span><span id="StateTransitionGraph-358"><a href="#StateTransitionGraph-358"><span class="linenos"> 358</span></a>                
</span><span id="StateTransitionGraph-359"><a href="#StateTransitionGraph-359"><span class="linenos"> 359</span></a>        <span class="n">rate</span> <span class="o">=</span> <span class="n">sym_rate</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subs</span> <span class="p">)</span>
</span><span id="StateTransitionGraph-360"><a href="#StateTransitionGraph-360"><span class="linenos"> 360</span></a>        
</span><span id="StateTransitionGraph-361"><a href="#StateTransitionGraph-361"><span class="linenos"> 361</span></a>        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;$&quot;</span><span class="o">+</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">sym_rate</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;$&quot;</span>
</span><span id="StateTransitionGraph-362"><a href="#StateTransitionGraph-362"><span class="linenos"> 362</span></a>                
</span><span id="StateTransitionGraph-363"><a href="#StateTransitionGraph-363"><span class="linenos"> 363</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">origin_state</span><span class="p">,</span> <span class="n">destination_state</span><span class="p">):</span>
</span><span id="StateTransitionGraph-364"><a href="#StateTransitionGraph-364"><span class="linenos"> 364</span></a>            <span class="n">theedge</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">origin_state</span><span class="p">][</span><span class="n">destination_state</span><span class="p">]</span>
</span><span id="StateTransitionGraph-365"><a href="#StateTransitionGraph-365"><span class="linenos"> 365</span></a>            <span class="n">warningstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Edge already exists: </span><span class="si">{</span><span class="n">origin_state</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">destination_state</span><span class="si">}</span><span class="s2"> with rate </span><span class="si">{</span><span class="n">theedge</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StateTransitionGraph-366"><a href="#StateTransitionGraph-366"><span class="linenos"> 366</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warningstr</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
</span><span id="StateTransitionGraph-367"><a href="#StateTransitionGraph-367"><span class="linenos"> 367</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">origin_state</span><span class="p">,</span> <span class="n">destination_state</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">rate</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">string</span><span class="p">,</span> 
</span><span id="StateTransitionGraph-368"><a href="#StateTransitionGraph-368"><span class="linenos"> 368</span></a>                   <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">sym_rate</span><span class="o">=</span><span class="n">sym_rate</span><span class="p">,</span> <span class="n">tid</span><span class="o">=</span><span class="n">tid</span><span class="p">)</span>
</span><span id="StateTransitionGraph-369"><a href="#StateTransitionGraph-369"><span class="linenos"> 369</span></a>    
</span><span id="StateTransitionGraph-370"><a href="#StateTransitionGraph-370"><span class="linenos"> 370</span></a>    <span class="k">def</span> <span class="nf">sym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="StateTransitionGraph-371"><a href="#StateTransitionGraph-371"><span class="linenos"> 371</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-372"><a href="#StateTransitionGraph-372"><span class="linenos"> 372</span></a><span class="sd">        Retrieve the symbolic representation of a model parameter.</span>
</span><span id="StateTransitionGraph-373"><a href="#StateTransitionGraph-373"><span class="linenos"> 373</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-374"><a href="#StateTransitionGraph-374"><span class="linenos"> 374</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-375"><a href="#StateTransitionGraph-375"><span class="linenos"> 375</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-376"><a href="#StateTransitionGraph-376"><span class="linenos"> 376</span></a><span class="sd">        key : str</span>
</span><span id="StateTransitionGraph-377"><a href="#StateTransitionGraph-377"><span class="linenos"> 377</span></a><span class="sd">            The name of the parameter (e.g., &#39;lambda&#39;, &#39;mu&#39;, &#39;n&#39;).</span>
</span><span id="StateTransitionGraph-378"><a href="#StateTransitionGraph-378"><span class="linenos"> 378</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-379"><a href="#StateTransitionGraph-379"><span class="linenos"> 379</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-380"><a href="#StateTransitionGraph-380"><span class="linenos"> 380</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-381"><a href="#StateTransitionGraph-381"><span class="linenos"> 381</span></a><span class="sd">        sympy.Symbol</span>
</span><span id="StateTransitionGraph-382"><a href="#StateTransitionGraph-382"><span class="linenos"> 382</span></a><span class="sd">            The symbolic variable corresponding to the given key.</span>
</span><span id="StateTransitionGraph-383"><a href="#StateTransitionGraph-383"><span class="linenos"> 383</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-384"><a href="#StateTransitionGraph-384"><span class="linenos"> 384</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph-385"><a href="#StateTransitionGraph-385"><span class="linenos"> 385</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph-386"><a href="#StateTransitionGraph-386"><span class="linenos"> 386</span></a><span class="sd">        KeyError</span>
</span><span id="StateTransitionGraph-387"><a href="#StateTransitionGraph-387"><span class="linenos"> 387</span></a><span class="sd">            If the key does not exist in the internal symbolic mapping (`_sym`).</span>
</span><span id="StateTransitionGraph-388"><a href="#StateTransitionGraph-388"><span class="linenos"> 388</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-389"><a href="#StateTransitionGraph-389"><span class="linenos"> 389</span></a><span class="sd">        Examples</span>
</span><span id="StateTransitionGraph-390"><a href="#StateTransitionGraph-390"><span class="linenos"> 390</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph-391"><a href="#StateTransitionGraph-391"><span class="linenos"> 391</span></a><span class="sd">        &gt;&gt;&gt; G.sym(&#39;lambda&#39;)</span>
</span><span id="StateTransitionGraph-392"><a href="#StateTransitionGraph-392"><span class="linenos"> 392</span></a><span class="sd">        lambda</span>
</span><span id="StateTransitionGraph-393"><a href="#StateTransitionGraph-393"><span class="linenos"> 393</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-394"><a href="#StateTransitionGraph-394"><span class="linenos"> 394</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-395"><a href="#StateTransitionGraph-395"><span class="linenos"> 395</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-396"><a href="#StateTransitionGraph-396"><span class="linenos"> 396</span></a><span class="sd">        - The symbolic mapping is initialized during object construction based on the `parameters` dictionary.</span>
</span><span id="StateTransitionGraph-397"><a href="#StateTransitionGraph-397"><span class="linenos"> 397</span></a><span class="sd">        - To access the symbol using dot-notation, use `.sym_key` attributes created during initialization.</span>
</span><span id="StateTransitionGraph-398"><a href="#StateTransitionGraph-398"><span class="linenos"> 398</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-399"><a href="#StateTransitionGraph-399"><span class="linenos"> 399</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="StateTransitionGraph-400"><a href="#StateTransitionGraph-400"><span class="linenos"> 400</span></a>
</span><span id="StateTransitionGraph-401"><a href="#StateTransitionGraph-401"><span class="linenos"> 401</span></a>        
</span><span id="StateTransitionGraph-402"><a href="#StateTransitionGraph-402"><span class="linenos"> 402</span></a>    <span class="nd">@property</span>
</span><span id="StateTransitionGraph-403"><a href="#StateTransitionGraph-403"><span class="linenos"> 403</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph-404"><a href="#StateTransitionGraph-404"><span class="linenos"> 404</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-405"><a href="#StateTransitionGraph-405"><span class="linenos"> 405</span></a><span class="sd">        Return the model parameters as a dictionary.</span>
</span><span id="StateTransitionGraph-406"><a href="#StateTransitionGraph-406"><span class="linenos"> 406</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-407"><a href="#StateTransitionGraph-407"><span class="linenos"> 407</span></a><span class="sd">        This includes the original numerical values provided during initialization.</span>
</span><span id="StateTransitionGraph-408"><a href="#StateTransitionGraph-408"><span class="linenos"> 408</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-409"><a href="#StateTransitionGraph-409"><span class="linenos"> 409</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-410"><a href="#StateTransitionGraph-410"><span class="linenos"> 410</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-411"><a href="#StateTransitionGraph-411"><span class="linenos"> 411</span></a><span class="sd">        dict</span>
</span><span id="StateTransitionGraph-412"><a href="#StateTransitionGraph-412"><span class="linenos"> 412</span></a><span class="sd">            Dictionary of parameter names and their corresponding numeric values.</span>
</span><span id="StateTransitionGraph-413"><a href="#StateTransitionGraph-413"><span class="linenos"> 413</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-414"><a href="#StateTransitionGraph-414"><span class="linenos"> 414</span></a><span class="sd">        Examples</span>
</span><span id="StateTransitionGraph-415"><a href="#StateTransitionGraph-415"><span class="linenos"> 415</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph-416"><a href="#StateTransitionGraph-416"><span class="linenos"> 416</span></a><span class="sd">        &gt;&gt;&gt; G.parameters</span>
</span><span id="StateTransitionGraph-417"><a href="#StateTransitionGraph-417"><span class="linenos"> 417</span></a><span class="sd">        {&#39;lambda&#39;: 1.0, &#39;mu&#39;: 0.5, &#39;n&#39;: 3}</span>
</span><span id="StateTransitionGraph-418"><a href="#StateTransitionGraph-418"><span class="linenos"> 418</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-419"><a href="#StateTransitionGraph-419"><span class="linenos"> 419</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-420"><a href="#StateTransitionGraph-420"><span class="linenos"> 420</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-421"><a href="#StateTransitionGraph-421"><span class="linenos"> 421</span></a><span class="sd">        - This property does not return symbolic values. Use `self.sym(key)` for symbolic access.</span>
</span><span id="StateTransitionGraph-422"><a href="#StateTransitionGraph-422"><span class="linenos"> 422</span></a><span class="sd">        - Parameter symbols can also be accessed using attributes like `sym_lambda` or the `sym()` method.</span>
</span><span id="StateTransitionGraph-423"><a href="#StateTransitionGraph-423"><span class="linenos"> 423</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-424"><a href="#StateTransitionGraph-424"><span class="linenos"> 424</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span>
</span><span id="StateTransitionGraph-425"><a href="#StateTransitionGraph-425"><span class="linenos"> 425</span></a>
</span><span id="StateTransitionGraph-426"><a href="#StateTransitionGraph-426"><span class="linenos"> 426</span></a>    
</span><span id="StateTransitionGraph-427"><a href="#StateTransitionGraph-427"><span class="linenos"> 427</span></a>
</span><span id="StateTransitionGraph-428"><a href="#StateTransitionGraph-428"><span class="linenos"> 428</span></a>    <span class="nd">@property</span>
</span><span id="StateTransitionGraph-429"><a href="#StateTransitionGraph-429"><span class="linenos"> 429</span></a>    <span class="k">def</span> <span class="nf">rate_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph-430"><a href="#StateTransitionGraph-430"><span class="linenos"> 430</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-431"><a href="#StateTransitionGraph-431"><span class="linenos"> 431</span></a><span class="sd">        Return the continuous-time rate matrix (Q matrix) of the state transition graph.</span>
</span><span id="StateTransitionGraph-432"><a href="#StateTransitionGraph-432"><span class="linenos"> 432</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-433"><a href="#StateTransitionGraph-433"><span class="linenos"> 433</span></a><span class="sd">        This matrix defines the transition rates between all pairs of states in the</span>
</span><span id="StateTransitionGraph-434"><a href="#StateTransitionGraph-434"><span class="linenos"> 434</span></a><span class="sd">        continuous-time Markov chain (CTMC) represented by this graph.</span>
</span><span id="StateTransitionGraph-435"><a href="#StateTransitionGraph-435"><span class="linenos"> 435</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-436"><a href="#StateTransitionGraph-436"><span class="linenos"> 436</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-437"><a href="#StateTransitionGraph-437"><span class="linenos"> 437</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-438"><a href="#StateTransitionGraph-438"><span class="linenos"> 438</span></a><span class="sd">        numpy.ndarray or None</span>
</span><span id="StateTransitionGraph-439"><a href="#StateTransitionGraph-439"><span class="linenos"> 439</span></a><span class="sd">            The rate matrix `Q`, where `Q[i, j]` is the transition rate from state `i` to `j`.</span>
</span><span id="StateTransitionGraph-440"><a href="#StateTransitionGraph-440"><span class="linenos"> 440</span></a><span class="sd">            Returns `None` if the rate matrix has not been computed yet.</span>
</span><span id="StateTransitionGraph-441"><a href="#StateTransitionGraph-441"><span class="linenos"> 441</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-442"><a href="#StateTransitionGraph-442"><span class="linenos"> 442</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-443"><a href="#StateTransitionGraph-443"><span class="linenos"> 443</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-444"><a href="#StateTransitionGraph-444"><span class="linenos"> 444</span></a><span class="sd">        - The matrix is typically generated via a method like `computeRateMatrix()` or similar.</span>
</span><span id="StateTransitionGraph-445"><a href="#StateTransitionGraph-445"><span class="linenos"> 445</span></a><span class="sd">        - Internal state indexing is handled by `_n2i` (node-to-index mapping).</span>
</span><span id="StateTransitionGraph-446"><a href="#StateTransitionGraph-446"><span class="linenos"> 446</span></a><span class="sd">        - The rate matrix is stored internally as `_rate_matrix`.</span>
</span><span id="StateTransitionGraph-447"><a href="#StateTransitionGraph-447"><span class="linenos"> 447</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-448"><a href="#StateTransitionGraph-448"><span class="linenos"> 448</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span>
</span><span id="StateTransitionGraph-449"><a href="#StateTransitionGraph-449"><span class="linenos"> 449</span></a>
</span><span id="StateTransitionGraph-450"><a href="#StateTransitionGraph-450"><span class="linenos"> 450</span></a>
</span><span id="StateTransitionGraph-451"><a href="#StateTransitionGraph-451"><span class="linenos"> 451</span></a>
</span><span id="StateTransitionGraph-452"><a href="#StateTransitionGraph-452"><span class="linenos"> 452</span></a>    <span class="nd">@property</span>
</span><span id="StateTransitionGraph-453"><a href="#StateTransitionGraph-453"><span class="linenos"> 453</span></a>    <span class="k">def</span> <span class="nf">state_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph-454"><a href="#StateTransitionGraph-454"><span class="linenos"> 454</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-455"><a href="#StateTransitionGraph-455"><span class="linenos"> 455</span></a><span class="sd">        Return the steady-state probabilities of the continuous-time Markov chain (CTMC).</span>
</span><span id="StateTransitionGraph-456"><a href="#StateTransitionGraph-456"><span class="linenos"> 456</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-457"><a href="#StateTransitionGraph-457"><span class="linenos"> 457</span></a><span class="sd">        These probabilities represent the long-run proportion of time the system spends</span>
</span><span id="StateTransitionGraph-458"><a href="#StateTransitionGraph-458"><span class="linenos"> 458</span></a><span class="sd">        in each state, assuming the CTMC is irreducible and positive recurrent.</span>
</span><span id="StateTransitionGraph-459"><a href="#StateTransitionGraph-459"><span class="linenos"> 459</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-460"><a href="#StateTransitionGraph-460"><span class="linenos"> 460</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-461"><a href="#StateTransitionGraph-461"><span class="linenos"> 461</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-462"><a href="#StateTransitionGraph-462"><span class="linenos"> 462</span></a><span class="sd">        dict or None</span>
</span><span id="StateTransitionGraph-463"><a href="#StateTransitionGraph-463"><span class="linenos"> 463</span></a><span class="sd">            A dictionary mapping each state to its steady-state probability.</span>
</span><span id="StateTransitionGraph-464"><a href="#StateTransitionGraph-464"><span class="linenos"> 464</span></a><span class="sd">            Returns `None` if the probabilities have not yet been computed.</span>
</span><span id="StateTransitionGraph-465"><a href="#StateTransitionGraph-465"><span class="linenos"> 465</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-466"><a href="#StateTransitionGraph-466"><span class="linenos"> 466</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-467"><a href="#StateTransitionGraph-467"><span class="linenos"> 467</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-468"><a href="#StateTransitionGraph-468"><span class="linenos"> 468</span></a><span class="sd">        - The probabilities are stored internally after being computed via a dedicated method</span>
</span><span id="StateTransitionGraph-469"><a href="#StateTransitionGraph-469"><span class="linenos"> 469</span></a><span class="sd">          `calcSteadyStateProbs()`.</span>
</span><span id="StateTransitionGraph-470"><a href="#StateTransitionGraph-470"><span class="linenos"> 470</span></a><span class="sd">        - The result is stored in the `_state_probabilities` attribute.</span>
</span><span id="StateTransitionGraph-471"><a href="#StateTransitionGraph-471"><span class="linenos"> 471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-472"><a href="#StateTransitionGraph-472"><span class="linenos"> 472</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_probabilities</span>
</span><span id="StateTransitionGraph-473"><a href="#StateTransitionGraph-473"><span class="linenos"> 473</span></a>
</span><span id="StateTransitionGraph-474"><a href="#StateTransitionGraph-474"><span class="linenos"> 474</span></a>     
</span><span id="StateTransitionGraph-475"><a href="#StateTransitionGraph-475"><span class="linenos"> 475</span></a>    
</span><span id="StateTransitionGraph-476"><a href="#StateTransitionGraph-476"><span class="linenos"> 476</span></a>    <span class="k">def</span> <span class="nf">printEdges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="StateTransitionGraph-477"><a href="#StateTransitionGraph-477"><span class="linenos"> 477</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-478"><a href="#StateTransitionGraph-478"><span class="linenos"> 478</span></a><span class="sd">        Print all outgoing edges from a given state in the graph.</span>
</span><span id="StateTransitionGraph-479"><a href="#StateTransitionGraph-479"><span class="linenos"> 479</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-480"><a href="#StateTransitionGraph-480"><span class="linenos"> 480</span></a><span class="sd">        For each edge from the specified `state`, this method prints the destination</span>
</span><span id="StateTransitionGraph-481"><a href="#StateTransitionGraph-481"><span class="linenos"> 481</span></a><span class="sd">        state and the corresponding transition label (typically the symbolic rate).</span>
</span><span id="StateTransitionGraph-482"><a href="#StateTransitionGraph-482"><span class="linenos"> 482</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-483"><a href="#StateTransitionGraph-483"><span class="linenos"> 483</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-484"><a href="#StateTransitionGraph-484"><span class="linenos"> 484</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-485"><a href="#StateTransitionGraph-485"><span class="linenos"> 485</span></a><span class="sd">        state : hashable</span>
</span><span id="StateTransitionGraph-486"><a href="#StateTransitionGraph-486"><span class="linenos"> 486</span></a><span class="sd">            The source node (state) from which outgoing edges will be printed.            </span>
</span><span id="StateTransitionGraph-487"><a href="#StateTransitionGraph-487"><span class="linenos"> 487</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-488"><a href="#StateTransitionGraph-488"><span class="linenos"> 488</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-489"><a href="#StateTransitionGraph-489"><span class="linenos"> 489</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-490"><a href="#StateTransitionGraph-490"><span class="linenos"> 490</span></a><span class="sd">        None</span>
</span><span id="StateTransitionGraph-491"><a href="#StateTransitionGraph-491"><span class="linenos"> 491</span></a><span class="sd">            This method prints output directly to the console and does not return a value.</span>
</span><span id="StateTransitionGraph-492"><a href="#StateTransitionGraph-492"><span class="linenos"> 492</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-493"><a href="#StateTransitionGraph-493"><span class="linenos"> 493</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-494"><a href="#StateTransitionGraph-494"><span class="linenos"> 494</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-495"><a href="#StateTransitionGraph-495"><span class="linenos"> 495</span></a><span class="sd">        - The transition label is retrieved from the edge attribute `&#39;label&#39;`.</span>
</span><span id="StateTransitionGraph-496"><a href="#StateTransitionGraph-496"><span class="linenos"> 496</span></a><span class="sd">        - Assumes `state` exists in the graph; otherwise, a KeyError will be raised.</span>
</span><span id="StateTransitionGraph-497"><a href="#StateTransitionGraph-497"><span class="linenos"> 497</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-498"><a href="#StateTransitionGraph-498"><span class="linenos"> 498</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;from </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-499"><a href="#StateTransitionGraph-499"><span class="linenos"> 499</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="StateTransitionGraph-500"><a href="#StateTransitionGraph-500"><span class="linenos"> 500</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
</span><span id="StateTransitionGraph-501"><a href="#StateTransitionGraph-501"><span class="linenos"> 501</span></a>            <span class="n">rate</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
</span><span id="StateTransitionGraph-502"><a href="#StateTransitionGraph-502"><span class="linenos"> 502</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; -&gt; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">rate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-503"><a href="#StateTransitionGraph-503"><span class="linenos"> 503</span></a>
</span><span id="StateTransitionGraph-504"><a href="#StateTransitionGraph-504"><span class="linenos"> 504</span></a>            
</span><span id="StateTransitionGraph-505"><a href="#StateTransitionGraph-505"><span class="linenos"> 505</span></a>    <span class="k">def</span> <span class="nf">createRateMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph-506"><a href="#StateTransitionGraph-506"><span class="linenos"> 506</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-507"><a href="#StateTransitionGraph-507"><span class="linenos"> 507</span></a><span class="sd">        Construct the continuous-time Markov chain (CTMC) rate matrix Q from the graph.</span>
</span><span id="StateTransitionGraph-508"><a href="#StateTransitionGraph-508"><span class="linenos"> 508</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-509"><a href="#StateTransitionGraph-509"><span class="linenos"> 509</span></a><span class="sd">        This method generates the generator matrix `Q` corresponding to the structure and</span>
</span><span id="StateTransitionGraph-510"><a href="#StateTransitionGraph-510"><span class="linenos"> 510</span></a><span class="sd">        rates defined in the directed graph. Each node represents a system state, and each</span>
</span><span id="StateTransitionGraph-511"><a href="#StateTransitionGraph-511"><span class="linenos"> 511</span></a><span class="sd">        directed edge must have a `&#39;rate&#39;` attribute representing the transition rate from</span>
</span><span id="StateTransitionGraph-512"><a href="#StateTransitionGraph-512"><span class="linenos"> 512</span></a><span class="sd">        one state to another.</span>
</span><span id="StateTransitionGraph-513"><a href="#StateTransitionGraph-513"><span class="linenos"> 513</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-514"><a href="#StateTransitionGraph-514"><span class="linenos"> 514</span></a><span class="sd">        The matrix `Q` is constructed such that:</span>
</span><span id="StateTransitionGraph-515"><a href="#StateTransitionGraph-515"><span class="linenos"> 515</span></a><span class="sd">        - `Q[i, j]` is the transition rate from state `i` to state `j`</span>
</span><span id="StateTransitionGraph-516"><a href="#StateTransitionGraph-516"><span class="linenos"> 516</span></a><span class="sd">        - Diagonal entries satisfy `Q[i, i] = -sum(Q[i, j]) for j ≠ i`, so that each row sums to 0</span>
</span><span id="StateTransitionGraph-517"><a href="#StateTransitionGraph-517"><span class="linenos"> 517</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-518"><a href="#StateTransitionGraph-518"><span class="linenos"> 518</span></a><span class="sd">        The resulting matrix and the internal node-to-index mapping (`_n2i`) are stored</span>
</span><span id="StateTransitionGraph-519"><a href="#StateTransitionGraph-519"><span class="linenos"> 519</span></a><span class="sd">        as attributes of the graph.</span>
</span><span id="StateTransitionGraph-520"><a href="#StateTransitionGraph-520"><span class="linenos"> 520</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-521"><a href="#StateTransitionGraph-521"><span class="linenos"> 521</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-522"><a href="#StateTransitionGraph-522"><span class="linenos"> 522</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-523"><a href="#StateTransitionGraph-523"><span class="linenos"> 523</span></a><span class="sd">        None</span>
</span><span id="StateTransitionGraph-524"><a href="#StateTransitionGraph-524"><span class="linenos"> 524</span></a><span class="sd">            The method updates internal attributes:</span>
</span><span id="StateTransitionGraph-525"><a href="#StateTransitionGraph-525"><span class="linenos"> 525</span></a><span class="sd">            - `_rate_matrix` : numpy.ndarray</span>
</span><span id="StateTransitionGraph-526"><a href="#StateTransitionGraph-526"><span class="linenos"> 526</span></a><span class="sd">                The CTMC rate matrix Q</span>
</span><span id="StateTransitionGraph-527"><a href="#StateTransitionGraph-527"><span class="linenos"> 527</span></a><span class="sd">            - `_n2i` : dict</span>
</span><span id="StateTransitionGraph-528"><a href="#StateTransitionGraph-528"><span class="linenos"> 528</span></a><span class="sd">                Mapping from node identifiers to matrix row/column indices</span>
</span><span id="StateTransitionGraph-529"><a href="#StateTransitionGraph-529"><span class="linenos"> 529</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-530"><a href="#StateTransitionGraph-530"><span class="linenos"> 530</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-531"><a href="#StateTransitionGraph-531"><span class="linenos"> 531</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-532"><a href="#StateTransitionGraph-532"><span class="linenos"> 532</span></a><span class="sd">        - Assumes all edges in the graph have a `&#39;rate&#39;` attribute.</span>
</span><span id="StateTransitionGraph-533"><a href="#StateTransitionGraph-533"><span class="linenos"> 533</span></a><span class="sd">        - The node order used in the matrix is consistent with the order from `list(self.nodes)`.</span>
</span><span id="StateTransitionGraph-534"><a href="#StateTransitionGraph-534"><span class="linenos"> 534</span></a><span class="sd">        - Use `self.rate_matrix` to access the generated matrix after this method is called.</span>
</span><span id="StateTransitionGraph-535"><a href="#StateTransitionGraph-535"><span class="linenos"> 535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-536"><a href="#StateTransitionGraph-536"><span class="linenos"> 536</span></a>        <span class="n">n2i</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph-537"><a href="#StateTransitionGraph-537"><span class="linenos"> 537</span></a>        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="StateTransitionGraph-538"><a href="#StateTransitionGraph-538"><span class="linenos"> 538</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
</span><span id="StateTransitionGraph-539"><a href="#StateTransitionGraph-539"><span class="linenos"> 539</span></a>            <span class="n">n2i</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>         
</span><span id="StateTransitionGraph-540"><a href="#StateTransitionGraph-540"><span class="linenos"> 540</span></a>        <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)))</span> <span class="c1"># rate matrix</span>
</span><span id="StateTransitionGraph-541"><a href="#StateTransitionGraph-541"><span class="linenos"> 541</span></a>        
</span><span id="StateTransitionGraph-542"><a href="#StateTransitionGraph-542"><span class="linenos"> 542</span></a>        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
</span><span id="StateTransitionGraph-543"><a href="#StateTransitionGraph-543"><span class="linenos"> 543</span></a>            <span class="n">i0</span> <span class="o">=</span> <span class="n">n2i</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="StateTransitionGraph-544"><a href="#StateTransitionGraph-544"><span class="linenos"> 544</span></a>            <span class="n">i1</span> <span class="o">=</span> <span class="n">n2i</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="StateTransitionGraph-545"><a href="#StateTransitionGraph-545"><span class="linenos"> 545</span></a>            <span class="n">Q</span><span class="p">[</span><span class="n">i0</span><span class="p">,</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;rate&quot;</span><span class="p">]</span> 
</span><span id="StateTransitionGraph-546"><a href="#StateTransitionGraph-546"><span class="linenos"> 546</span></a>            
</span><span id="StateTransitionGraph-547"><a href="#StateTransitionGraph-547"><span class="linenos"> 547</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="o">-</span><span class="n">Q</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="StateTransitionGraph-548"><a href="#StateTransitionGraph-548"><span class="linenos"> 548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="o">=</span> <span class="n">Q</span>
</span><span id="StateTransitionGraph-549"><a href="#StateTransitionGraph-549"><span class="linenos"> 549</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="o">=</span> <span class="n">n2i</span>
</span><span id="StateTransitionGraph-550"><a href="#StateTransitionGraph-550"><span class="linenos"> 550</span></a>        <span class="c1">#return Q, n2i</span>
</span><span id="StateTransitionGraph-551"><a href="#StateTransitionGraph-551"><span class="linenos"> 551</span></a>    
</span><span id="StateTransitionGraph-552"><a href="#StateTransitionGraph-552"><span class="linenos"> 552</span></a>    <span class="k">def</span> <span class="nf">calcSteadyStateProbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>        
</span><span id="StateTransitionGraph-553"><a href="#StateTransitionGraph-553"><span class="linenos"> 553</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-554"><a href="#StateTransitionGraph-554"><span class="linenos"> 554</span></a><span class="sd">        Compute the steady-state probabilities of the continuous-time Markov chain (CTMC).</span>
</span><span id="StateTransitionGraph-555"><a href="#StateTransitionGraph-555"><span class="linenos"> 555</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-556"><a href="#StateTransitionGraph-556"><span class="linenos"> 556</span></a><span class="sd">        This method calculates the stationary distribution of the CTMC defined by the rate</span>
</span><span id="StateTransitionGraph-557"><a href="#StateTransitionGraph-557"><span class="linenos"> 557</span></a><span class="sd">        matrix of the state transition graph. The computation solves the linear system</span>
</span><span id="StateTransitionGraph-558"><a href="#StateTransitionGraph-558"><span class="linenos"> 558</span></a><span class="sd">        `XQ = 0` with the constraint that the probabilities X sum to 1, using a modified</span>
</span><span id="StateTransitionGraph-559"><a href="#StateTransitionGraph-559"><span class="linenos"> 559</span></a><span class="sd">        version of the rate matrix `Q`.</span>
</span><span id="StateTransitionGraph-560"><a href="#StateTransitionGraph-560"><span class="linenos"> 560</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-561"><a href="#StateTransitionGraph-561"><span class="linenos"> 561</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-562"><a href="#StateTransitionGraph-562"><span class="linenos"> 562</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-563"><a href="#StateTransitionGraph-563"><span class="linenos"> 563</span></a><span class="sd">        verbose : bool, optional</span>
</span><span id="StateTransitionGraph-564"><a href="#StateTransitionGraph-564"><span class="linenos"> 564</span></a><span class="sd">            If True, prints the rate matrix, the modified matrix, the right-hand side vector,</span>
</span><span id="StateTransitionGraph-565"><a href="#StateTransitionGraph-565"><span class="linenos"> 565</span></a><span class="sd">            and the resulting steady-state probabilities.</span>
</span><span id="StateTransitionGraph-566"><a href="#StateTransitionGraph-566"><span class="linenos"> 566</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-567"><a href="#StateTransitionGraph-567"><span class="linenos"> 567</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-568"><a href="#StateTransitionGraph-568"><span class="linenos"> 568</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-569"><a href="#StateTransitionGraph-569"><span class="linenos"> 569</span></a><span class="sd">        probs : dict</span>
</span><span id="StateTransitionGraph-570"><a href="#StateTransitionGraph-570"><span class="linenos"> 570</span></a><span class="sd">            A dictionary mapping each state (node in the graph) to its steady-state probability.</span>
</span><span id="StateTransitionGraph-571"><a href="#StateTransitionGraph-571"><span class="linenos"> 571</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-572"><a href="#StateTransitionGraph-572"><span class="linenos"> 572</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-573"><a href="#StateTransitionGraph-573"><span class="linenos"> 573</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-574"><a href="#StateTransitionGraph-574"><span class="linenos"> 574</span></a><span class="sd">        - The graph must already contain valid transition rates on its edges.</span>
</span><span id="StateTransitionGraph-575"><a href="#StateTransitionGraph-575"><span class="linenos"> 575</span></a><span class="sd">        - If the rate matrix has not yet been created, `createRateMatrix()` is called automatically.</span>
</span><span id="StateTransitionGraph-576"><a href="#StateTransitionGraph-576"><span class="linenos"> 576</span></a><span class="sd">        - The method modifies the last column of the rate matrix to impose the normalization constraint</span>
</span><span id="StateTransitionGraph-577"><a href="#StateTransitionGraph-577"><span class="linenos"> 577</span></a><span class="sd">          `sum(X) = 1`.</span>
</span><span id="StateTransitionGraph-578"><a href="#StateTransitionGraph-578"><span class="linenos"> 578</span></a><span class="sd">        - The inverse of the modified matrix is computed directly, so the graph should be small enough</span>
</span><span id="StateTransitionGraph-579"><a href="#StateTransitionGraph-579"><span class="linenos"> 579</span></a><span class="sd">          to avoid numerical instability or performance issues.</span>
</span><span id="StateTransitionGraph-580"><a href="#StateTransitionGraph-580"><span class="linenos"> 580</span></a><span class="sd">        - The resulting probabilities are stored internally in `_state_probabilities` and can be accessed</span>
</span><span id="StateTransitionGraph-581"><a href="#StateTransitionGraph-581"><span class="linenos"> 581</span></a><span class="sd">          via the `state_probabilities` property.</span>
</span><span id="StateTransitionGraph-582"><a href="#StateTransitionGraph-582"><span class="linenos"> 582</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-583"><a href="#StateTransitionGraph-583"><span class="linenos"> 583</span></a>        
</span><span id="StateTransitionGraph-584"><a href="#StateTransitionGraph-584"><span class="linenos"> 584</span></a>        <span class="c1"># compute transition matrix if not already done</span>
</span><span id="StateTransitionGraph-585"><a href="#StateTransitionGraph-585"><span class="linenos"> 585</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">createRateMatrix</span><span class="p">()</span>
</span><span id="StateTransitionGraph-586"><a href="#StateTransitionGraph-586"><span class="linenos"> 586</span></a>        <span class="n">Q2</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="StateTransitionGraph-587"><a href="#StateTransitionGraph-587"><span class="linenos"> 587</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="StateTransitionGraph-588"><a href="#StateTransitionGraph-588"><span class="linenos"> 588</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rate matrix Q&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-589"><a href="#StateTransitionGraph-589"><span class="linenos"> 589</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Q=</span><span class="se">\n</span><span class="si">{</span><span class="n">Q2</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-590"><a href="#StateTransitionGraph-590"><span class="linenos"> 590</span></a>        
</span><span id="StateTransitionGraph-591"><a href="#StateTransitionGraph-591"><span class="linenos"> 591</span></a>        <span class="n">Q2</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="StateTransitionGraph-592"><a href="#StateTransitionGraph-592"><span class="linenos"> 592</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>        
</span><span id="StateTransitionGraph-593"><a href="#StateTransitionGraph-593"><span class="linenos"> 593</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Matrix is changed to</span><span class="se">\n</span><span class="s1">Q2=</span><span class="se">\n</span><span class="si">{</span><span class="n">Q2</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-594"><a href="#StateTransitionGraph-594"><span class="linenos"> 594</span></a>
</span><span id="StateTransitionGraph-595"><a href="#StateTransitionGraph-595"><span class="linenos"> 595</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Q2</span><span class="p">))</span>
</span><span id="StateTransitionGraph-596"><a href="#StateTransitionGraph-596"><span class="linenos"> 596</span></a>        <span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="StateTransitionGraph-597"><a href="#StateTransitionGraph-597"><span class="linenos"> 597</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="StateTransitionGraph-598"><a href="#StateTransitionGraph-598"><span class="linenos"> 598</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Solve X = b @ Q2&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-599"><a href="#StateTransitionGraph-599"><span class="linenos"> 599</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;b=</span><span class="se">\n</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-600"><a href="#StateTransitionGraph-600"><span class="linenos"> 600</span></a>        
</span><span id="StateTransitionGraph-601"><a href="#StateTransitionGraph-601"><span class="linenos"> 601</span></a>        <span class="c1"># state probabilities</span>
</span><span id="StateTransitionGraph-602"><a href="#StateTransitionGraph-602"><span class="linenos"> 602</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">b</span> <span class="o">@</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span> <span class="c1"># compute the matrix inverse</span>
</span><span id="StateTransitionGraph-603"><a href="#StateTransitionGraph-603"><span class="linenos"> 603</span></a>            
</span><span id="StateTransitionGraph-604"><a href="#StateTransitionGraph-604"><span class="linenos"> 604</span></a>        <span class="c1"># Generate a matrix with P(X,Y)</span>
</span><span id="StateTransitionGraph-605"><a href="#StateTransitionGraph-605"><span class="linenos"> 605</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph-606"><a href="#StateTransitionGraph-606"><span class="linenos"> 606</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
</span><span id="StateTransitionGraph-607"><a href="#StateTransitionGraph-607"><span class="linenos"> 607</span></a>            <span class="n">matrix</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">]</span>
</span><span id="StateTransitionGraph-608"><a href="#StateTransitionGraph-608"><span class="linenos"> 608</span></a>        
</span><span id="StateTransitionGraph-609"><a href="#StateTransitionGraph-609"><span class="linenos"> 609</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="StateTransitionGraph-610"><a href="#StateTransitionGraph-610"><span class="linenos"> 610</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Steady-state probabilities X&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-611"><a href="#StateTransitionGraph-611"><span class="linenos"> 611</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;X=</span><span class="se">\n</span><span class="si">{</span><span class="n">matrix</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-612"><a href="#StateTransitionGraph-612"><span class="linenos"> 612</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state_probabilities</span> <span class="o">=</span> <span class="n">matrix</span>
</span><span id="StateTransitionGraph-613"><a href="#StateTransitionGraph-613"><span class="linenos"> 613</span></a>        <span class="k">return</span> <span class="n">matrix</span>
</span><span id="StateTransitionGraph-614"><a href="#StateTransitionGraph-614"><span class="linenos"> 614</span></a>        
</span><span id="StateTransitionGraph-615"><a href="#StateTransitionGraph-615"><span class="linenos"> 615</span></a>    <span class="k">def</span> <span class="nf">calcTransitionProbabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph-616"><a href="#StateTransitionGraph-616"><span class="linenos"> 616</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-617"><a href="#StateTransitionGraph-617"><span class="linenos"> 617</span></a><span class="sd">        Compute and store transition probabilities for each node in the graph of the embedded discrete Markov chain.</span>
</span><span id="StateTransitionGraph-618"><a href="#StateTransitionGraph-618"><span class="linenos"> 618</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-619"><a href="#StateTransitionGraph-619"><span class="linenos"> 619</span></a><span class="sd">        This method processes each node in the graph, treating outgoing edges as</span>
</span><span id="StateTransitionGraph-620"><a href="#StateTransitionGraph-620"><span class="linenos"> 620</span></a><span class="sd">        transitions in an embedded discrete-time Markov chain derived from a continuous-time</span>
</span><span id="StateTransitionGraph-621"><a href="#StateTransitionGraph-621"><span class="linenos"> 621</span></a><span class="sd">        Markov chain (CTMC). Transition *rates* on outgoing edges are normalized into</span>
</span><span id="StateTransitionGraph-622"><a href="#StateTransitionGraph-622"><span class="linenos"> 622</span></a><span class="sd">        *probabilities*, and relevant data is stored in the node attributes.</span>
</span><span id="StateTransitionGraph-623"><a href="#StateTransitionGraph-623"><span class="linenos"> 623</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-624"><a href="#StateTransitionGraph-624"><span class="linenos"> 624</span></a><span class="sd">        For each node, the following attributes are set:</span>
</span><span id="StateTransitionGraph-625"><a href="#StateTransitionGraph-625"><span class="linenos"> 625</span></a><span class="sd">        - `&quot;transitionProbs&quot;` : np.ndarray</span>
</span><span id="StateTransitionGraph-626"><a href="#StateTransitionGraph-626"><span class="linenos"> 626</span></a><span class="sd">            Array of transition probabilities to successor nodes.</span>
</span><span id="StateTransitionGraph-627"><a href="#StateTransitionGraph-627"><span class="linenos"> 627</span></a><span class="sd">        - `&quot;transitionNodes&quot;` : list</span>
</span><span id="StateTransitionGraph-628"><a href="#StateTransitionGraph-628"><span class="linenos"> 628</span></a><span class="sd">            List of successor node identifiers (ordered as in the probability array).</span>
</span><span id="StateTransitionGraph-629"><a href="#StateTransitionGraph-629"><span class="linenos"> 629</span></a><span class="sd">        - `&quot;sumOutgoingRates&quot;` : float</span>
</span><span id="StateTransitionGraph-630"><a href="#StateTransitionGraph-630"><span class="linenos"> 630</span></a><span class="sd">            Sum of all outgoing transition rates. Used to model the exponential waiting time</span>
</span><span id="StateTransitionGraph-631"><a href="#StateTransitionGraph-631"><span class="linenos"> 631</span></a><span class="sd">            in continuous-time simulation (`T ~ Exp(sumOutgoingRates)`).</span>
</span><span id="StateTransitionGraph-632"><a href="#StateTransitionGraph-632"><span class="linenos"> 632</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-633"><a href="#StateTransitionGraph-633"><span class="linenos"> 633</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-634"><a href="#StateTransitionGraph-634"><span class="linenos"> 634</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-635"><a href="#StateTransitionGraph-635"><span class="linenos"> 635</span></a><span class="sd">        - The graph must be a directed graph where each edge has a `&#39;rate&#39;` attribute.</span>
</span><span id="StateTransitionGraph-636"><a href="#StateTransitionGraph-636"><span class="linenos"> 636</span></a><span class="sd">        - Nodes with no outgoing edges are considered absorbing states.</span>
</span><span id="StateTransitionGraph-637"><a href="#StateTransitionGraph-637"><span class="linenos"> 637</span></a><span class="sd">        - Useful for discrete-event simulation and Markov chain Monte Carlo (MCMC) modeling.</span>
</span><span id="StateTransitionGraph-638"><a href="#StateTransitionGraph-638"><span class="linenos"> 638</span></a><span class="sd">        - Sets an internal flag `_transitionProbabilitesComputed = True` upon completion.</span>
</span><span id="StateTransitionGraph-639"><a href="#StateTransitionGraph-639"><span class="linenos"> 639</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-640"><a href="#StateTransitionGraph-640"><span class="linenos"> 640</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph-641"><a href="#StateTransitionGraph-641"><span class="linenos"> 641</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph-642"><a href="#StateTransitionGraph-642"><span class="linenos"> 642</span></a><span class="sd">        KeyError</span>
</span><span id="StateTransitionGraph-643"><a href="#StateTransitionGraph-643"><span class="linenos"> 643</span></a><span class="sd">            If any outgoing edge lacks a `&#39;rate&#39;` attribute.</span>
</span><span id="StateTransitionGraph-644"><a href="#StateTransitionGraph-644"><span class="linenos"> 644</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-645"><a href="#StateTransitionGraph-645"><span class="linenos"> 645</span></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="StateTransitionGraph-646"><a href="#StateTransitionGraph-646"><span class="linenos"> 646</span></a>            <span class="n">successors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
</span><span id="StateTransitionGraph-647"><a href="#StateTransitionGraph-647"><span class="linenos"> 647</span></a>            <span class="n">rates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">nbr</span><span class="p">][</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">successors</span><span class="p">])</span>
</span><span id="StateTransitionGraph-648"><a href="#StateTransitionGraph-648"><span class="linenos"> 648</span></a>            <span class="n">probs</span> <span class="o">=</span> <span class="n">rates</span> <span class="o">/</span> <span class="n">rates</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Normalize to probabilities</span>
</span><span id="StateTransitionGraph-649"><a href="#StateTransitionGraph-649"><span class="linenos"> 649</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionProbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">probs</span> <span class="c1"># probabilities</span>
</span><span id="StateTransitionGraph-650"><a href="#StateTransitionGraph-650"><span class="linenos"> 650</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionNodes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">successors</span> <span class="c1"># list of nodes</span>
</span><span id="StateTransitionGraph-651"><a href="#StateTransitionGraph-651"><span class="linenos"> 651</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;sumOutgoingRates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rates</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># time in state ~ EXP(sumOutgoingRates)</span>
</span><span id="StateTransitionGraph-652"><a href="#StateTransitionGraph-652"><span class="linenos"> 652</span></a>            <span class="n">numel</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">successors</span><span class="p">)</span>
</span><span id="StateTransitionGraph-653"><a href="#StateTransitionGraph-653"><span class="linenos"> 653</span></a>            <span class="k">if</span> <span class="n">numel</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
</span><span id="StateTransitionGraph-654"><a href="#StateTransitionGraph-654"><span class="linenos"> 654</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absorbing state: </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-655"><a href="#StateTransitionGraph-655"><span class="linenos"> 655</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transitionProbabilitesComputed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="StateTransitionGraph-656"><a href="#StateTransitionGraph-656"><span class="linenos"> 656</span></a>                
</span><span id="StateTransitionGraph-657"><a href="#StateTransitionGraph-657"><span class="linenos"> 657</span></a>    <span class="k">def</span> <span class="nf">simulateMarkovModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startNode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numEvents</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="StateTransitionGraph-658"><a href="#StateTransitionGraph-658"><span class="linenos"> 658</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-659"><a href="#StateTransitionGraph-659"><span class="linenos"> 659</span></a><span class="sd">        Simulate a trajectory through the state transition graph as a continuous-time Markov chain (CTMC).</span>
</span><span id="StateTransitionGraph-660"><a href="#StateTransitionGraph-660"><span class="linenos"> 660</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph-661"><a href="#StateTransitionGraph-661"><span class="linenos"> 661</span></a><span class="sd">        This method performs a discrete-event simulation of the CTMC by generating a random walk</span>
</span><span id="StateTransitionGraph-662"><a href="#StateTransitionGraph-662"><span class="linenos"> 662</span></a><span class="sd">        through the graph, starting at `startNode` (or a default node if not specified). Transitions</span>
</span><span id="StateTransitionGraph-663"><a href="#StateTransitionGraph-663"><span class="linenos"> 663</span></a><span class="sd">        are chosen based on the normalized transition probabilities computed from edge rates, and</span>
</span><span id="StateTransitionGraph-664"><a href="#StateTransitionGraph-664"><span class="linenos"> 664</span></a><span class="sd">        dwell times are sampled from exponential distributions based on the total outgoing rate</span>
</span><span id="StateTransitionGraph-665"><a href="#StateTransitionGraph-665"><span class="linenos"> 665</span></a><span class="sd">        from each state.</span>
</span><span id="StateTransitionGraph-666"><a href="#StateTransitionGraph-666"><span class="linenos"> 666</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph-667"><a href="#StateTransitionGraph-667"><span class="linenos"> 667</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-668"><a href="#StateTransitionGraph-668"><span class="linenos"> 668</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-669"><a href="#StateTransitionGraph-669"><span class="linenos"> 669</span></a><span class="sd">        - startNode : hashable, optional</span>
</span><span id="StateTransitionGraph-670"><a href="#StateTransitionGraph-670"><span class="linenos"> 670</span></a><span class="sd">            The node at which the simulation starts. If not specified, the first node in the graph</span>
</span><span id="StateTransitionGraph-671"><a href="#StateTransitionGraph-671"><span class="linenos"> 671</span></a><span class="sd">            (based on insertion order) is used.</span>
</span><span id="StateTransitionGraph-672"><a href="#StateTransitionGraph-672"><span class="linenos"> 672</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph-673"><a href="#StateTransitionGraph-673"><span class="linenos"> 673</span></a><span class="sd">        - numEvents : int, optional</span>
</span><span id="StateTransitionGraph-674"><a href="#StateTransitionGraph-674"><span class="linenos"> 674</span></a><span class="sd">            The number of transition events (steps) to simulate. Default is 10.</span>
</span><span id="StateTransitionGraph-675"><a href="#StateTransitionGraph-675"><span class="linenos"> 675</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph-676"><a href="#StateTransitionGraph-676"><span class="linenos"> 676</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-677"><a href="#StateTransitionGraph-677"><span class="linenos"> 677</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-678"><a href="#StateTransitionGraph-678"><span class="linenos"> 678</span></a><span class="sd">        states : list</span>
</span><span id="StateTransitionGraph-679"><a href="#StateTransitionGraph-679"><span class="linenos"> 679</span></a><span class="sd">            A list of visited states, representing the sequence of nodes traversed in the simulation.</span>
</span><span id="StateTransitionGraph-680"><a href="#StateTransitionGraph-680"><span class="linenos"> 680</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph-681"><a href="#StateTransitionGraph-681"><span class="linenos"> 681</span></a><span class="sd">        times : numpy.ndarray</span>
</span><span id="StateTransitionGraph-682"><a href="#StateTransitionGraph-682"><span class="linenos"> 682</span></a><span class="sd">            An array of dwell times in each state, sampled from exponential distributions</span>
</span><span id="StateTransitionGraph-683"><a href="#StateTransitionGraph-683"><span class="linenos"> 683</span></a><span class="sd">            with rate equal to the sum of outgoing transition rates from each state.</span>
</span><span id="StateTransitionGraph-684"><a href="#StateTransitionGraph-684"><span class="linenos"> 684</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph-685"><a href="#StateTransitionGraph-685"><span class="linenos"> 685</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-686"><a href="#StateTransitionGraph-686"><span class="linenos"> 686</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-687"><a href="#StateTransitionGraph-687"><span class="linenos"> 687</span></a><span class="sd">        - This method automatically calls `calcTransitionProbabilities()` if transition probabilities</span>
</span><span id="StateTransitionGraph-688"><a href="#StateTransitionGraph-688"><span class="linenos"> 688</span></a><span class="sd">          have not yet been computed.</span>
</span><span id="StateTransitionGraph-689"><a href="#StateTransitionGraph-689"><span class="linenos"> 689</span></a><span class="sd">        - If an absorbing state (i.e., a node with no outgoing edges) is reached, the simulation stops early.</span>
</span><span id="StateTransitionGraph-690"><a href="#StateTransitionGraph-690"><span class="linenos"> 690</span></a><span class="sd">        - The cumulative time can be obtained by `np.cumsum(times)`.</span>
</span><span id="StateTransitionGraph-691"><a href="#StateTransitionGraph-691"><span class="linenos"> 691</span></a><span class="sd">        - State durations follow `Exp(sumOutgoingRates)` distributions per CTMC theory.</span>
</span><span id="StateTransitionGraph-692"><a href="#StateTransitionGraph-692"><span class="linenos"> 692</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-693"><a href="#StateTransitionGraph-693"><span class="linenos"> 693</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transitionProbabilitesComputed</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcTransitionProbabilities</span><span class="p">()</span>
</span><span id="StateTransitionGraph-694"><a href="#StateTransitionGraph-694"><span class="linenos"> 694</span></a>        
</span><span id="StateTransitionGraph-695"><a href="#StateTransitionGraph-695"><span class="linenos"> 695</span></a>        <span class="c1"># simulate random walk through Graph = Markov Chain</span>
</span><span id="StateTransitionGraph-696"><a href="#StateTransitionGraph-696"><span class="linenos"> 696</span></a>        <span class="k">if</span> <span class="n">startNode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-697"><a href="#StateTransitionGraph-697"><span class="linenos"> 697</span></a>            <span class="n">startNode</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="StateTransitionGraph-698"><a href="#StateTransitionGraph-698"><span class="linenos"> 698</span></a>        
</span><span id="StateTransitionGraph-699"><a href="#StateTransitionGraph-699"><span class="linenos"> 699</span></a>
</span><span id="StateTransitionGraph-700"><a href="#StateTransitionGraph-700"><span class="linenos"> 700</span></a>        <span class="n">states</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># list of states</span>
</span><span id="StateTransitionGraph-701"><a href="#StateTransitionGraph-701"><span class="linenos"> 701</span></a>        <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numEvents</span><span class="p">)</span> <span class="c1"># time per state</span>
</span><span id="StateTransitionGraph-702"><a href="#StateTransitionGraph-702"><span class="linenos"> 702</span></a>
</span><span id="StateTransitionGraph-703"><a href="#StateTransitionGraph-703"><span class="linenos"> 703</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="n">startNode</span>
</span><span id="StateTransitionGraph-704"><a href="#StateTransitionGraph-704"><span class="linenos"> 704</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numEvents</span><span class="p">):</span>
</span><span id="StateTransitionGraph-705"><a href="#StateTransitionGraph-705"><span class="linenos"> 705</span></a>            <span class="n">outgoingRate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;sumOutgoingRates&quot;</span><span class="p">]</span>  <span class="c1"># time in state ~ EXP(sumOutgoingRates)</span>
</span><span id="StateTransitionGraph-706"><a href="#StateTransitionGraph-706"><span class="linenos"> 706</span></a>            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="n">outgoingRate</span><span class="p">)</span> <span class="c1"># exponentially distributed time in state</span>
</span><span id="StateTransitionGraph-707"><a href="#StateTransitionGraph-707"><span class="linenos"> 707</span></a>            <span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span><span id="StateTransitionGraph-708"><a href="#StateTransitionGraph-708"><span class="linenos"> 708</span></a>            
</span><span id="StateTransitionGraph-709"><a href="#StateTransitionGraph-709"><span class="linenos"> 709</span></a>            <span class="c1"># get next node    </span>
</span><span id="StateTransitionGraph-710"><a href="#StateTransitionGraph-710"><span class="linenos"> 710</span></a>            <span class="n">probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionProbs&quot;</span><span class="p">]</span> <span class="c1"># probabilities</span>
</span><span id="StateTransitionGraph-711"><a href="#StateTransitionGraph-711"><span class="linenos"> 711</span></a>            <span class="n">successors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionNodes&quot;</span><span class="p">]</span> <span class="c1"># list of nodes        </span>
</span><span id="StateTransitionGraph-712"><a href="#StateTransitionGraph-712"><span class="linenos"> 712</span></a>            <span class="n">numel</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">successors</span><span class="p">)</span>
</span><span id="StateTransitionGraph-713"><a href="#StateTransitionGraph-713"><span class="linenos"> 713</span></a>            <span class="k">if</span> <span class="n">numel</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
</span><span id="StateTransitionGraph-714"><a href="#StateTransitionGraph-714"><span class="linenos"> 714</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absorbing state: </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-715"><a href="#StateTransitionGraph-715"><span class="linenos"> 715</span></a>                <span class="k">break</span>
</span><span id="StateTransitionGraph-716"><a href="#StateTransitionGraph-716"><span class="linenos"> 716</span></a>            <span class="k">elif</span> <span class="n">numel</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span><span id="StateTransitionGraph-717"><a href="#StateTransitionGraph-717"><span class="linenos"> 717</span></a>                <span class="n">nextNode</span> <span class="o">=</span> <span class="n">successors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StateTransitionGraph-718"><a href="#StateTransitionGraph-718"><span class="linenos"> 718</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph-719"><a href="#StateTransitionGraph-719"><span class="linenos"> 719</span></a>                <span class="n">nextNode</span> <span class="o">=</span> <span class="n">successors</span><span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">numel</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probs</span><span class="p">)</span> <span class="p">]</span>
</span><span id="StateTransitionGraph-720"><a href="#StateTransitionGraph-720"><span class="linenos"> 720</span></a>            <span class="c1"># edge = G[node][nextNode]</span>
</span><span id="StateTransitionGraph-721"><a href="#StateTransitionGraph-721"><span class="linenos"> 721</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="n">nextNode</span>
</span><span id="StateTransitionGraph-722"><a href="#StateTransitionGraph-722"><span class="linenos"> 722</span></a>            
</span><span id="StateTransitionGraph-723"><a href="#StateTransitionGraph-723"><span class="linenos"> 723</span></a>        <span class="k">return</span> <span class="n">states</span><span class="p">,</span> <span class="n">times</span>
</span><span id="StateTransitionGraph-724"><a href="#StateTransitionGraph-724"><span class="linenos"> 724</span></a>    
</span><span id="StateTransitionGraph-725"><a href="#StateTransitionGraph-725"><span class="linenos"> 725</span></a>    <span class="k">def</span> <span class="nf">calcProbabilitiesSimulationRun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">times</span><span class="p">):</span>
</span><span id="StateTransitionGraph-726"><a href="#StateTransitionGraph-726"><span class="linenos"> 726</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-727"><a href="#StateTransitionGraph-727"><span class="linenos"> 727</span></a><span class="sd">        Estimate empirical state probabilities from a simulation run of the CTMC.</span>
</span><span id="StateTransitionGraph-728"><a href="#StateTransitionGraph-728"><span class="linenos"> 728</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-729"><a href="#StateTransitionGraph-729"><span class="linenos"> 729</span></a><span class="sd">        This method computes the fraction of total time spent in each state during a simulation.</span>
</span><span id="StateTransitionGraph-730"><a href="#StateTransitionGraph-730"><span class="linenos"> 730</span></a><span class="sd">        It uses the sequence of visited states and corresponding sojourn times to estimate the</span>
</span><span id="StateTransitionGraph-731"><a href="#StateTransitionGraph-731"><span class="linenos"> 731</span></a><span class="sd">        empirical (time-weighted) probability distribution over states.</span>
</span><span id="StateTransitionGraph-732"><a href="#StateTransitionGraph-732"><span class="linenos"> 732</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-733"><a href="#StateTransitionGraph-733"><span class="linenos"> 733</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-734"><a href="#StateTransitionGraph-734"><span class="linenos"> 734</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-735"><a href="#StateTransitionGraph-735"><span class="linenos"> 735</span></a><span class="sd">        - states : list of tuple</span>
</span><span id="StateTransitionGraph-736"><a href="#StateTransitionGraph-736"><span class="linenos"> 736</span></a><span class="sd">            A list of state identifiers visited during the simulation.    </span>
</span><span id="StateTransitionGraph-737"><a href="#StateTransitionGraph-737"><span class="linenos"> 737</span></a><span class="sd">        - times : numpy.ndarray</span>
</span><span id="StateTransitionGraph-738"><a href="#StateTransitionGraph-738"><span class="linenos"> 738</span></a><span class="sd">            An array of sojourn times corresponding to each visited state, same length as `states`.</span>
</span><span id="StateTransitionGraph-739"><a href="#StateTransitionGraph-739"><span class="linenos"> 739</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-740"><a href="#StateTransitionGraph-740"><span class="linenos"> 740</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-741"><a href="#StateTransitionGraph-741"><span class="linenos"> 741</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-742"><a href="#StateTransitionGraph-742"><span class="linenos"> 742</span></a><span class="sd">        simProbs : dict</span>
</span><span id="StateTransitionGraph-743"><a href="#StateTransitionGraph-743"><span class="linenos"> 743</span></a><span class="sd">            A dictionary mapping each unique state to its estimated empirical probability,</span>
</span><span id="StateTransitionGraph-744"><a href="#StateTransitionGraph-744"><span class="linenos"> 744</span></a><span class="sd">            based on total time spent in that state relative to the simulation duration.</span>
</span><span id="StateTransitionGraph-745"><a href="#StateTransitionGraph-745"><span class="linenos"> 745</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-746"><a href="#StateTransitionGraph-746"><span class="linenos"> 746</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-747"><a href="#StateTransitionGraph-747"><span class="linenos"> 747</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-748"><a href="#StateTransitionGraph-748"><span class="linenos"> 748</span></a><span class="sd">        - Internally, states are mapped to flat indices for efficient counting using NumPy.</span>
</span><span id="StateTransitionGraph-749"><a href="#StateTransitionGraph-749"><span class="linenos"> 749</span></a><span class="sd">        - This method assumes that `states` contains only valid node identifiers from the graph.</span>
</span><span id="StateTransitionGraph-750"><a href="#StateTransitionGraph-750"><span class="linenos"> 750</span></a><span class="sd">        - If `_n2i` (node-to-index mapping) has not been initialized, it will be computed here.</span>
</span><span id="StateTransitionGraph-751"><a href="#StateTransitionGraph-751"><span class="linenos"> 751</span></a><span class="sd">        - This is especially useful for validating analytical steady-state probabilities</span>
</span><span id="StateTransitionGraph-752"><a href="#StateTransitionGraph-752"><span class="linenos"> 752</span></a><span class="sd">          against sampled simulation results. Or in case of state-space explosions.</span>
</span><span id="StateTransitionGraph-753"><a href="#StateTransitionGraph-753"><span class="linenos"> 753</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph-754"><a href="#StateTransitionGraph-754"><span class="linenos"> 754</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-755"><a href="#StateTransitionGraph-755"><span class="linenos"> 755</span></a>            <span class="n">n2i</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph-756"><a href="#StateTransitionGraph-756"><span class="linenos"> 756</span></a>            <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="StateTransitionGraph-757"><a href="#StateTransitionGraph-757"><span class="linenos"> 757</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
</span><span id="StateTransitionGraph-758"><a href="#StateTransitionGraph-758"><span class="linenos"> 758</span></a>                <span class="n">n2i</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>     
</span><span id="StateTransitionGraph-759"><a href="#StateTransitionGraph-759"><span class="linenos"> 759</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="o">=</span> <span class="n">n2i</span>
</span><span id="StateTransitionGraph-760"><a href="#StateTransitionGraph-760"><span class="linenos"> 760</span></a>                
</span><span id="StateTransitionGraph-761"><a href="#StateTransitionGraph-761"><span class="linenos"> 761</span></a>        
</span><span id="StateTransitionGraph-762"><a href="#StateTransitionGraph-762"><span class="linenos"> 762</span></a>        <span class="c1"># Map tuples to flat indices</span>
</span><span id="StateTransitionGraph-763"><a href="#StateTransitionGraph-763"><span class="linenos"> 763</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
</span><span id="StateTransitionGraph-764"><a href="#StateTransitionGraph-764"><span class="linenos"> 764</span></a>        <span class="n">max_vals</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="StateTransitionGraph-765"><a href="#StateTransitionGraph-765"><span class="linenos"> 765</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel_multi_index</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">max_vals</span><span class="p">)</span>
</span><span id="StateTransitionGraph-766"><a href="#StateTransitionGraph-766"><span class="linenos"> 766</span></a>
</span><span id="StateTransitionGraph-767"><a href="#StateTransitionGraph-767"><span class="linenos"> 767</span></a>        <span class="c1"># Weighted bincount</span>
</span><span id="StateTransitionGraph-768"><a href="#StateTransitionGraph-768"><span class="linenos"> 768</span></a>        <span class="n">bincount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
</span><span id="StateTransitionGraph-769"><a href="#StateTransitionGraph-769"><span class="linenos"> 769</span></a>
</span><span id="StateTransitionGraph-770"><a href="#StateTransitionGraph-770"><span class="linenos"> 770</span></a>        <span class="c1"># Decode back to tuples</span>
</span><span id="StateTransitionGraph-771"><a href="#StateTransitionGraph-771"><span class="linenos"> 771</span></a>        <span class="n">tuple_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">bincount</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="n">max_vals</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
</span><span id="StateTransitionGraph-772"><a href="#StateTransitionGraph-772"><span class="linenos"> 772</span></a>        <span class="n">timePerState</span> <span class="o">=</span> <span class="n">bincount</span><span class="p">[</span><span class="n">bincount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="StateTransitionGraph-773"><a href="#StateTransitionGraph-773"><span class="linenos"> 773</span></a>
</span><span id="StateTransitionGraph-774"><a href="#StateTransitionGraph-774"><span class="linenos"> 774</span></a>        <span class="n">simProbs</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph-775"><a href="#StateTransitionGraph-775"><span class="linenos"> 775</span></a>        <span class="n">totalTime</span> <span class="o">=</span> <span class="n">times</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="StateTransitionGraph-776"><a href="#StateTransitionGraph-776"><span class="linenos"> 776</span></a>        <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tuple_indices</span><span class="p">,</span> <span class="n">timePerState</span><span class="p">):</span>
</span><span id="StateTransitionGraph-777"><a href="#StateTransitionGraph-777"><span class="linenos"> 777</span></a>            <span class="n">simProbs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">totalTime</span>
</span><span id="StateTransitionGraph-778"><a href="#StateTransitionGraph-778"><span class="linenos"> 778</span></a>            <span class="c1">#print(f&quot;Tuple {tuple(t)} → weighted count: {c}&quot;)</span>
</span><span id="StateTransitionGraph-779"><a href="#StateTransitionGraph-779"><span class="linenos"> 779</span></a>        <span class="k">return</span> <span class="n">simProbs</span>
</span><span id="StateTransitionGraph-780"><a href="#StateTransitionGraph-780"><span class="linenos"> 780</span></a>    
</span><span id="StateTransitionGraph-781"><a href="#StateTransitionGraph-781"><span class="linenos"> 781</span></a>    
</span><span id="StateTransitionGraph-782"><a href="#StateTransitionGraph-782"><span class="linenos"> 782</span></a>    <span class="k">def</span> <span class="nf">_draw_networkx_edge_labels</span><span class="p">(</span>
</span><span id="StateTransitionGraph-783"><a href="#StateTransitionGraph-783"><span class="linenos"> 783</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="StateTransitionGraph-784"><a href="#StateTransitionGraph-784"><span class="linenos"> 784</span></a>        <span class="n">pos</span><span class="p">,</span>
</span><span id="StateTransitionGraph-785"><a href="#StateTransitionGraph-785"><span class="linenos"> 785</span></a>        <span class="n">edge_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
</span><span id="StateTransitionGraph-786"><a href="#StateTransitionGraph-786"><span class="linenos"> 786</span></a>        <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">font_family</span><span class="o">=</span><span class="s2">&quot;sans-serif&quot;</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
</span><span id="StateTransitionGraph-787"><a href="#StateTransitionGraph-787"><span class="linenos"> 787</span></a>        <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="StateTransitionGraph-788"><a href="#StateTransitionGraph-788"><span class="linenos"> 788</span></a>        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
</span><span id="StateTransitionGraph-789"><a href="#StateTransitionGraph-789"><span class="linenos"> 789</span></a>        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rad</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="StateTransitionGraph-790"><a href="#StateTransitionGraph-790"><span class="linenos"> 790</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-791"><a href="#StateTransitionGraph-791"><span class="linenos"> 791</span></a><span class="sd">        Draw edge labels for a directed graph with optional curved edge support.</span>
</span><span id="StateTransitionGraph-792"><a href="#StateTransitionGraph-792"><span class="linenos"> 792</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-793"><a href="#StateTransitionGraph-793"><span class="linenos"> 793</span></a><span class="sd">        This method extends NetworkX&#39;s default edge label drawing by supporting</span>
</span><span id="StateTransitionGraph-794"><a href="#StateTransitionGraph-794"><span class="linenos"> 794</span></a><span class="sd">        curved (bended) edges through quadratic Bézier control points. It places</span>
</span><span id="StateTransitionGraph-795"><a href="#StateTransitionGraph-795"><span class="linenos"> 795</span></a><span class="sd">        labels dynamically at a specified position along the curve and optionally</span>
</span><span id="StateTransitionGraph-796"><a href="#StateTransitionGraph-796"><span class="linenos"> 796</span></a><span class="sd">        rotates them to follow the edge orientation.</span>
</span><span id="StateTransitionGraph-797"><a href="#StateTransitionGraph-797"><span class="linenos"> 797</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-798"><a href="#StateTransitionGraph-798"><span class="linenos"> 798</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-799"><a href="#StateTransitionGraph-799"><span class="linenos"> 799</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-800"><a href="#StateTransitionGraph-800"><span class="linenos"> 800</span></a><span class="sd">        pos : dict</span>
</span><span id="StateTransitionGraph-801"><a href="#StateTransitionGraph-801"><span class="linenos"> 801</span></a><span class="sd">            Dictionary mapping nodes to positions (2D coordinates). Required.</span>
</span><span id="StateTransitionGraph-802"><a href="#StateTransitionGraph-802"><span class="linenos"> 802</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-803"><a href="#StateTransitionGraph-803"><span class="linenos"> 803</span></a><span class="sd">        edge_labels : dict, optional</span>
</span><span id="StateTransitionGraph-804"><a href="#StateTransitionGraph-804"><span class="linenos"> 804</span></a><span class="sd">            Dictionary mapping edge tuples `(u, v)` to label strings. If None,</span>
</span><span id="StateTransitionGraph-805"><a href="#StateTransitionGraph-805"><span class="linenos"> 805</span></a><span class="sd">            edge data is used and converted to strings automatically.</span>
</span><span id="StateTransitionGraph-806"><a href="#StateTransitionGraph-806"><span class="linenos"> 806</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-807"><a href="#StateTransitionGraph-807"><span class="linenos"> 807</span></a><span class="sd">        label_pos : float, optional</span>
</span><span id="StateTransitionGraph-808"><a href="#StateTransitionGraph-808"><span class="linenos"> 808</span></a><span class="sd">            Position along the edge to place the label (0=head, 1=tail).</span>
</span><span id="StateTransitionGraph-809"><a href="#StateTransitionGraph-809"><span class="linenos"> 809</span></a><span class="sd">            Default is 0.75 (closer to the target node).</span>
</span><span id="StateTransitionGraph-810"><a href="#StateTransitionGraph-810"><span class="linenos"> 810</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-811"><a href="#StateTransitionGraph-811"><span class="linenos"> 811</span></a><span class="sd">        font_size : int, optional</span>
</span><span id="StateTransitionGraph-812"><a href="#StateTransitionGraph-812"><span class="linenos"> 812</span></a><span class="sd">            Font size of the edge labels. Default is 10.</span>
</span><span id="StateTransitionGraph-813"><a href="#StateTransitionGraph-813"><span class="linenos"> 813</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-814"><a href="#StateTransitionGraph-814"><span class="linenos"> 814</span></a><span class="sd">        font_color : str, optional</span>
</span><span id="StateTransitionGraph-815"><a href="#StateTransitionGraph-815"><span class="linenos"> 815</span></a><span class="sd">            Font color for the edge labels. Default is &#39;k&#39; (black).</span>
</span><span id="StateTransitionGraph-816"><a href="#StateTransitionGraph-816"><span class="linenos"> 816</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-817"><a href="#StateTransitionGraph-817"><span class="linenos"> 817</span></a><span class="sd">        font_family : str, optional</span>
</span><span id="StateTransitionGraph-818"><a href="#StateTransitionGraph-818"><span class="linenos"> 818</span></a><span class="sd">            Font family for the edge labels. Default is &#39;sans-serif&#39;.</span>
</span><span id="StateTransitionGraph-819"><a href="#StateTransitionGraph-819"><span class="linenos"> 819</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-820"><a href="#StateTransitionGraph-820"><span class="linenos"> 820</span></a><span class="sd">        font_weight : str, optional</span>
</span><span id="StateTransitionGraph-821"><a href="#StateTransitionGraph-821"><span class="linenos"> 821</span></a><span class="sd">            Font weight for the edge labels (e.g., &#39;normal&#39;, &#39;bold&#39;). Default is &#39;normal&#39;.</span>
</span><span id="StateTransitionGraph-822"><a href="#StateTransitionGraph-822"><span class="linenos"> 822</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-823"><a href="#StateTransitionGraph-823"><span class="linenos"> 823</span></a><span class="sd">        alpha : float, optional</span>
</span><span id="StateTransitionGraph-824"><a href="#StateTransitionGraph-824"><span class="linenos"> 824</span></a><span class="sd">            Opacity for the edge labels. If None, labels are fully opaque.</span>
</span><span id="StateTransitionGraph-825"><a href="#StateTransitionGraph-825"><span class="linenos"> 825</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-826"><a href="#StateTransitionGraph-826"><span class="linenos"> 826</span></a><span class="sd">        bbox : dict, optional</span>
</span><span id="StateTransitionGraph-827"><a href="#StateTransitionGraph-827"><span class="linenos"> 827</span></a><span class="sd">            Matplotlib-style bbox dictionary to style the label background.</span>
</span><span id="StateTransitionGraph-828"><a href="#StateTransitionGraph-828"><span class="linenos"> 828</span></a><span class="sd">            Default is a white rounded box.</span>
</span><span id="StateTransitionGraph-829"><a href="#StateTransitionGraph-829"><span class="linenos"> 829</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-830"><a href="#StateTransitionGraph-830"><span class="linenos"> 830</span></a><span class="sd">        horizontalalignment : str, optional</span>
</span><span id="StateTransitionGraph-831"><a href="#StateTransitionGraph-831"><span class="linenos"> 831</span></a><span class="sd">            Horizontal alignment of the text. Default is &#39;center&#39;.</span>
</span><span id="StateTransitionGraph-832"><a href="#StateTransitionGraph-832"><span class="linenos"> 832</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-833"><a href="#StateTransitionGraph-833"><span class="linenos"> 833</span></a><span class="sd">        verticalalignment : str, optional</span>
</span><span id="StateTransitionGraph-834"><a href="#StateTransitionGraph-834"><span class="linenos"> 834</span></a><span class="sd">            Vertical alignment of the text. Default is &#39;center&#39;.</span>
</span><span id="StateTransitionGraph-835"><a href="#StateTransitionGraph-835"><span class="linenos"> 835</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-836"><a href="#StateTransitionGraph-836"><span class="linenos"> 836</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="StateTransitionGraph-837"><a href="#StateTransitionGraph-837"><span class="linenos"> 837</span></a><span class="sd">            Axes on which to draw the labels. If None, uses the current axes.</span>
</span><span id="StateTransitionGraph-838"><a href="#StateTransitionGraph-838"><span class="linenos"> 838</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-839"><a href="#StateTransitionGraph-839"><span class="linenos"> 839</span></a><span class="sd">        rotate : bool, optional</span>
</span><span id="StateTransitionGraph-840"><a href="#StateTransitionGraph-840"><span class="linenos"> 840</span></a><span class="sd">            Whether to rotate the label to match the edge direction. Default is True.</span>
</span><span id="StateTransitionGraph-841"><a href="#StateTransitionGraph-841"><span class="linenos"> 841</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-842"><a href="#StateTransitionGraph-842"><span class="linenos"> 842</span></a><span class="sd">        clip_on : bool, optional</span>
</span><span id="StateTransitionGraph-843"><a href="#StateTransitionGraph-843"><span class="linenos"> 843</span></a><span class="sd">            Whether to clip labels at the plot boundary. Default is True.</span>
</span><span id="StateTransitionGraph-844"><a href="#StateTransitionGraph-844"><span class="linenos"> 844</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-845"><a href="#StateTransitionGraph-845"><span class="linenos"> 845</span></a><span class="sd">        rad : float, optional</span>
</span><span id="StateTransitionGraph-846"><a href="#StateTransitionGraph-846"><span class="linenos"> 846</span></a><span class="sd">            Curvature of the edge (used to determine Bézier control point).</span>
</span><span id="StateTransitionGraph-847"><a href="#StateTransitionGraph-847"><span class="linenos"> 847</span></a><span class="sd">            Positive values bend counterclockwise; negative values clockwise. Default is 0 (straight).</span>
</span><span id="StateTransitionGraph-848"><a href="#StateTransitionGraph-848"><span class="linenos"> 848</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-849"><a href="#StateTransitionGraph-849"><span class="linenos"> 849</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-850"><a href="#StateTransitionGraph-850"><span class="linenos"> 850</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-851"><a href="#StateTransitionGraph-851"><span class="linenos"> 851</span></a><span class="sd">        dict</span>
</span><span id="StateTransitionGraph-852"><a href="#StateTransitionGraph-852"><span class="linenos"> 852</span></a><span class="sd">            Dictionary mapping edge tuples `(u, v)` to the corresponding matplotlib Text objects.</span>
</span><span id="StateTransitionGraph-853"><a href="#StateTransitionGraph-853"><span class="linenos"> 853</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-854"><a href="#StateTransitionGraph-854"><span class="linenos"> 854</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-855"><a href="#StateTransitionGraph-855"><span class="linenos"> 855</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-856"><a href="#StateTransitionGraph-856"><span class="linenos"> 856</span></a><span class="sd">        - If `rotate=True`, label text is automatically aligned with the direction of the edge.</span>
</span><span id="StateTransitionGraph-857"><a href="#StateTransitionGraph-857"><span class="linenos"> 857</span></a><span class="sd">        - Curvature (`rad`) enables visualization of bidirectional transitions using bent edges.</span>
</span><span id="StateTransitionGraph-858"><a href="#StateTransitionGraph-858"><span class="linenos"> 858</span></a><span class="sd">        - This method is intended for internal use and supports bended edge label placement to match custom edge rendering.</span>
</span><span id="StateTransitionGraph-859"><a href="#StateTransitionGraph-859"><span class="linenos"> 859</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-860"><a href="#StateTransitionGraph-860"><span class="linenos"> 860</span></a><span class="sd">        See Also</span>
</span><span id="StateTransitionGraph-861"><a href="#StateTransitionGraph-861"><span class="linenos"> 861</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph-862"><a href="#StateTransitionGraph-862"><span class="linenos"> 862</span></a><span class="sd">        draw</span>
</span><span id="StateTransitionGraph-863"><a href="#StateTransitionGraph-863"><span class="linenos"> 863</span></a><span class="sd">        draw_networkx</span>
</span><span id="StateTransitionGraph-864"><a href="#StateTransitionGraph-864"><span class="linenos"> 864</span></a><span class="sd">        draw_networkx_nodes</span>
</span><span id="StateTransitionGraph-865"><a href="#StateTransitionGraph-865"><span class="linenos"> 865</span></a><span class="sd">        draw_networkx_edges</span>
</span><span id="StateTransitionGraph-866"><a href="#StateTransitionGraph-866"><span class="linenos"> 866</span></a><span class="sd">        draw_networkx_labels</span>
</span><span id="StateTransitionGraph-867"><a href="#StateTransitionGraph-867"><span class="linenos"> 867</span></a><span class="sd">        &quot;&quot;&quot;</span>                
</span><span id="StateTransitionGraph-868"><a href="#StateTransitionGraph-868"><span class="linenos"> 868</span></a>        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-869"><a href="#StateTransitionGraph-869"><span class="linenos"> 869</span></a>            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="StateTransitionGraph-870"><a href="#StateTransitionGraph-870"><span class="linenos"> 870</span></a>        <span class="k">if</span> <span class="n">edge_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-871"><a href="#StateTransitionGraph-871"><span class="linenos"> 871</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">{(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span> <span class="n">d</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
</span><span id="StateTransitionGraph-872"><a href="#StateTransitionGraph-872"><span class="linenos"> 872</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph-873"><a href="#StateTransitionGraph-873"><span class="linenos"> 873</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="n">edge_labels</span>
</span><span id="StateTransitionGraph-874"><a href="#StateTransitionGraph-874"><span class="linenos"> 874</span></a>        <span class="n">text_items</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph-875"><a href="#StateTransitionGraph-875"><span class="linenos"> 875</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">),</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StateTransitionGraph-876"><a href="#StateTransitionGraph-876"><span class="linenos"> 876</span></a>            <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">n1</span><span class="p">]</span>
</span><span id="StateTransitionGraph-877"><a href="#StateTransitionGraph-877"><span class="linenos"> 877</span></a>            <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">n2</span><span class="p">]</span>
</span><span id="StateTransitionGraph-878"><a href="#StateTransitionGraph-878"><span class="linenos"> 878</span></a>            <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StateTransitionGraph-879"><a href="#StateTransitionGraph-879"><span class="linenos"> 879</span></a>                <span class="n">x1</span> <span class="o">*</span> <span class="n">label_pos</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">label_pos</span><span class="p">),</span>
</span><span id="StateTransitionGraph-880"><a href="#StateTransitionGraph-880"><span class="linenos"> 880</span></a>                <span class="n">y1</span> <span class="o">*</span> <span class="n">label_pos</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">label_pos</span><span class="p">),</span>
</span><span id="StateTransitionGraph-881"><a href="#StateTransitionGraph-881"><span class="linenos"> 881</span></a>            <span class="p">)</span>
</span><span id="StateTransitionGraph-882"><a href="#StateTransitionGraph-882"><span class="linenos"> 882</span></a>            <span class="n">pos_1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">n1</span><span class="p">]))</span>
</span><span id="StateTransitionGraph-883"><a href="#StateTransitionGraph-883"><span class="linenos"> 883</span></a>            <span class="n">pos_2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">n2</span><span class="p">]))</span>
</span><span id="StateTransitionGraph-884"><a href="#StateTransitionGraph-884"><span class="linenos"> 884</span></a>            <span class="c1">#linear_mid = 0.5*pos_1 + 0.5*pos_2</span>
</span><span id="StateTransitionGraph-885"><a href="#StateTransitionGraph-885"><span class="linenos"> 885</span></a>            <span class="n">linear_mid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">label_pos</span><span class="p">)</span><span class="o">*</span><span class="n">pos_1</span> <span class="o">+</span> <span class="n">label_pos</span><span class="o">*</span><span class="n">pos_2</span>
</span><span id="StateTransitionGraph-886"><a href="#StateTransitionGraph-886"><span class="linenos"> 886</span></a>            <span class="n">d_pos</span> <span class="o">=</span> <span class="n">pos_2</span> <span class="o">-</span> <span class="n">pos_1</span>
</span><span id="StateTransitionGraph-887"><a href="#StateTransitionGraph-887"><span class="linenos"> 887</span></a>            <span class="n">rotation_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
</span><span id="StateTransitionGraph-888"><a href="#StateTransitionGraph-888"><span class="linenos"> 888</span></a>            <span class="n">ctrl_1</span> <span class="o">=</span> <span class="n">linear_mid</span> <span class="o">+</span> <span class="n">rad</span><span class="o">*</span><span class="n">rotation_matrix</span><span class="nd">@d_pos</span>
</span><span id="StateTransitionGraph-889"><a href="#StateTransitionGraph-889"><span class="linenos"> 889</span></a>            <span class="n">ctrl_mid_1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">pos_1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">ctrl_1</span>
</span><span id="StateTransitionGraph-890"><a href="#StateTransitionGraph-890"><span class="linenos"> 890</span></a>            <span class="n">ctrl_mid_2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">pos_2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">ctrl_1</span>
</span><span id="StateTransitionGraph-891"><a href="#StateTransitionGraph-891"><span class="linenos"> 891</span></a>            <span class="n">bezier_mid</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">ctrl_mid_1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">ctrl_mid_2</span>
</span><span id="StateTransitionGraph-892"><a href="#StateTransitionGraph-892"><span class="linenos"> 892</span></a>            <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">bezier_mid</span><span class="p">)</span>
</span><span id="StateTransitionGraph-893"><a href="#StateTransitionGraph-893"><span class="linenos"> 893</span></a>
</span><span id="StateTransitionGraph-894"><a href="#StateTransitionGraph-894"><span class="linenos"> 894</span></a>            <span class="k">if</span> <span class="n">rotate</span><span class="p">:</span>
</span><span id="StateTransitionGraph-895"><a href="#StateTransitionGraph-895"><span class="linenos"> 895</span></a>                <span class="c1"># in degrees</span>
</span><span id="StateTransitionGraph-896"><a href="#StateTransitionGraph-896"><span class="linenos"> 896</span></a>                <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span>
</span><span id="StateTransitionGraph-897"><a href="#StateTransitionGraph-897"><span class="linenos"> 897</span></a>                <span class="c1"># make label orientation &quot;right-side-up&quot;</span>
</span><span id="StateTransitionGraph-898"><a href="#StateTransitionGraph-898"><span class="linenos"> 898</span></a>                <span class="k">if</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
</span><span id="StateTransitionGraph-899"><a href="#StateTransitionGraph-899"><span class="linenos"> 899</span></a>                    <span class="n">angle</span> <span class="o">-=</span> <span class="mi">180</span>
</span><span id="StateTransitionGraph-900"><a href="#StateTransitionGraph-900"><span class="linenos"> 900</span></a>                <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">:</span>
</span><span id="StateTransitionGraph-901"><a href="#StateTransitionGraph-901"><span class="linenos"> 901</span></a>                    <span class="n">angle</span> <span class="o">+=</span> <span class="mi">180</span>
</span><span id="StateTransitionGraph-902"><a href="#StateTransitionGraph-902"><span class="linenos"> 902</span></a>                <span class="c1"># transform data coordinate angle to screen coordinate angle</span>
</span><span id="StateTransitionGraph-903"><a href="#StateTransitionGraph-903"><span class="linenos"> 903</span></a>                <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="StateTransitionGraph-904"><a href="#StateTransitionGraph-904"><span class="linenos"> 904</span></a>                <span class="n">trans_angle</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform_angles</span><span class="p">(</span>
</span><span id="StateTransitionGraph-905"><a href="#StateTransitionGraph-905"><span class="linenos"> 905</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">angle</span><span class="p">,)),</span> <span class="n">xy</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="StateTransitionGraph-906"><a href="#StateTransitionGraph-906"><span class="linenos"> 906</span></a>                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StateTransitionGraph-907"><a href="#StateTransitionGraph-907"><span class="linenos"> 907</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph-908"><a href="#StateTransitionGraph-908"><span class="linenos"> 908</span></a>                <span class="n">trans_angle</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="StateTransitionGraph-909"><a href="#StateTransitionGraph-909"><span class="linenos"> 909</span></a>            <span class="c1"># use default box of white with white border</span>
</span><span id="StateTransitionGraph-910"><a href="#StateTransitionGraph-910"><span class="linenos"> 910</span></a>            <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-911"><a href="#StateTransitionGraph-911"><span class="linenos"> 911</span></a>                <span class="n">bbox</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">fc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</span><span id="StateTransitionGraph-912"><a href="#StateTransitionGraph-912"><span class="linenos"> 912</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="StateTransitionGraph-913"><a href="#StateTransitionGraph-913"><span class="linenos"> 913</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># this makes &quot;1&quot; and 1 labeled the same</span>
</span><span id="StateTransitionGraph-914"><a href="#StateTransitionGraph-914"><span class="linenos"> 914</span></a>
</span><span id="StateTransitionGraph-915"><a href="#StateTransitionGraph-915"><span class="linenos"> 915</span></a>            <span class="n">t</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
</span><span id="StateTransitionGraph-916"><a href="#StateTransitionGraph-916"><span class="linenos"> 916</span></a>                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span>
</span><span id="StateTransitionGraph-917"><a href="#StateTransitionGraph-917"><span class="linenos"> 917</span></a>                <span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">font_family</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">font_weight</span><span class="p">,</span>
</span><span id="StateTransitionGraph-918"><a href="#StateTransitionGraph-918"><span class="linenos"> 918</span></a>                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="StateTransitionGraph-919"><a href="#StateTransitionGraph-919"><span class="linenos"> 919</span></a>                <span class="n">horizontalalignment</span><span class="o">=</span><span class="n">horizontalalignment</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="n">verticalalignment</span><span class="p">,</span>
</span><span id="StateTransitionGraph-920"><a href="#StateTransitionGraph-920"><span class="linenos"> 920</span></a>                <span class="n">rotation</span><span class="o">=</span><span class="n">trans_angle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span>
</span><span id="StateTransitionGraph-921"><a href="#StateTransitionGraph-921"><span class="linenos"> 921</span></a>                <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">clip_on</span><span class="o">=</span><span class="n">clip_on</span><span class="p">)</span>
</span><span id="StateTransitionGraph-922"><a href="#StateTransitionGraph-922"><span class="linenos"> 922</span></a>            <span class="n">text_items</span><span class="p">[(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">t</span>
</span><span id="StateTransitionGraph-923"><a href="#StateTransitionGraph-923"><span class="linenos"> 923</span></a>
</span><span id="StateTransitionGraph-924"><a href="#StateTransitionGraph-924"><span class="linenos"> 924</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="StateTransitionGraph-925"><a href="#StateTransitionGraph-925"><span class="linenos"> 925</span></a>
</span><span id="StateTransitionGraph-926"><a href="#StateTransitionGraph-926"><span class="linenos"> 926</span></a>        <span class="k">return</span> <span class="n">text_items</span>    
</span><span id="StateTransitionGraph-927"><a href="#StateTransitionGraph-927"><span class="linenos"> 927</span></a>
</span><span id="StateTransitionGraph-928"><a href="#StateTransitionGraph-928"><span class="linenos"> 928</span></a>    
</span><span id="StateTransitionGraph-929"><a href="#StateTransitionGraph-929"><span class="linenos"> 929</span></a>    <span class="k">def</span> <span class="nf">drawTransitionGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="StateTransitionGraph-930"><a href="#StateTransitionGraph-930"><span class="linenos"> 930</span></a>                        <span class="n">bended</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rad</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="StateTransitionGraph-931"><a href="#StateTransitionGraph-931"><span class="linenos"> 931</span></a>                        <span class="n">edge_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_shapes</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
</span><span id="StateTransitionGraph-932"><a href="#StateTransitionGraph-932"><span class="linenos"> 932</span></a>                        <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="StateTransitionGraph-933"><a href="#StateTransitionGraph-933"><span class="linenos"> 933</span></a>                        <span class="n">fontcolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.75</span><span class="p">):</span>        
</span><span id="StateTransitionGraph-934"><a href="#StateTransitionGraph-934"><span class="linenos"> 934</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-935"><a href="#StateTransitionGraph-935"><span class="linenos"> 935</span></a><span class="sd">        Visualize the state transition graph with nodes and directed edges.</span>
</span><span id="StateTransitionGraph-936"><a href="#StateTransitionGraph-936"><span class="linenos"> 936</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-937"><a href="#StateTransitionGraph-937"><span class="linenos"> 937</span></a><span class="sd">        This method draws the graph using `matplotlib` and `networkx`, including labels,</span>
</span><span id="StateTransitionGraph-938"><a href="#StateTransitionGraph-938"><span class="linenos"> 938</span></a><span class="sd">        node colors, and optional curved (bended) edges for better visualization of</span>
</span><span id="StateTransitionGraph-939"><a href="#StateTransitionGraph-939"><span class="linenos"> 939</span></a><span class="sd">        bidirectional transitions. It supports layout customization and is useful for</span>
</span><span id="StateTransitionGraph-940"><a href="#StateTransitionGraph-940"><span class="linenos"> 940</span></a><span class="sd">        understanding the structure of the Markov model.</span>
</span><span id="StateTransitionGraph-941"><a href="#StateTransitionGraph-941"><span class="linenos"> 941</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-942"><a href="#StateTransitionGraph-942"><span class="linenos"> 942</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-943"><a href="#StateTransitionGraph-943"><span class="linenos"> 943</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-944"><a href="#StateTransitionGraph-944"><span class="linenos"> 944</span></a><span class="sd">        pos : dict, optional</span>
</span><span id="StateTransitionGraph-945"><a href="#StateTransitionGraph-945"><span class="linenos"> 945</span></a><span class="sd">            A dictionary mapping nodes to positions. If None, a Kamada-Kawai layout is used.</span>
</span><span id="StateTransitionGraph-946"><a href="#StateTransitionGraph-946"><span class="linenos"> 946</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-947"><a href="#StateTransitionGraph-947"><span class="linenos"> 947</span></a><span class="sd">        bended : bool, optional</span>
</span><span id="StateTransitionGraph-948"><a href="#StateTransitionGraph-948"><span class="linenos"> 948</span></a><span class="sd">            If True, edges are drawn with curvature using arcs. Useful for distinguishing</span>
</span><span id="StateTransitionGraph-949"><a href="#StateTransitionGraph-949"><span class="linenos"> 949</span></a><span class="sd">            bidirectional transitions. Default is False.</span>
</span><span id="StateTransitionGraph-950"><a href="#StateTransitionGraph-950"><span class="linenos"> 950</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-951"><a href="#StateTransitionGraph-951"><span class="linenos"> 951</span></a><span class="sd">        node_size : int, optional</span>
</span><span id="StateTransitionGraph-952"><a href="#StateTransitionGraph-952"><span class="linenos"> 952</span></a><span class="sd">            Size of the nodes in the plot. Default is 1000.</span>
</span><span id="StateTransitionGraph-953"><a href="#StateTransitionGraph-953"><span class="linenos"> 953</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-954"><a href="#StateTransitionGraph-954"><span class="linenos"> 954</span></a><span class="sd">        num : int, optional</span>
</span><span id="StateTransitionGraph-955"><a href="#StateTransitionGraph-955"><span class="linenos"> 955</span></a><span class="sd">            Figure number for matplotlib (useful for managing multiple figures). Default is 1.</span>
</span><span id="StateTransitionGraph-956"><a href="#StateTransitionGraph-956"><span class="linenos"> 956</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-957"><a href="#StateTransitionGraph-957"><span class="linenos"> 957</span></a><span class="sd">        rad : float, optional</span>
</span><span id="StateTransitionGraph-958"><a href="#StateTransitionGraph-958"><span class="linenos"> 958</span></a><span class="sd">            The curvature radius for bended edges. Only used if `bended=True`. Default is -0.2.</span>
</span><span id="StateTransitionGraph-959"><a href="#StateTransitionGraph-959"><span class="linenos"> 959</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-960"><a href="#StateTransitionGraph-960"><span class="linenos"> 960</span></a><span class="sd">        edge_labels : dict, optional</span>
</span><span id="StateTransitionGraph-961"><a href="#StateTransitionGraph-961"><span class="linenos"> 961</span></a><span class="sd">            Optional dictionary mapping edges `(u, v)` to labels. If None, the `&#39;label&#39;`</span>
</span><span id="StateTransitionGraph-962"><a href="#StateTransitionGraph-962"><span class="linenos"> 962</span></a><span class="sd">            attribute from each edge is used.</span>
</span><span id="StateTransitionGraph-963"><a href="#StateTransitionGraph-963"><span class="linenos"> 963</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-964"><a href="#StateTransitionGraph-964"><span class="linenos"> 964</span></a><span class="sd">        node_shapes : str, optional</span>
</span><span id="StateTransitionGraph-965"><a href="#StateTransitionGraph-965"><span class="linenos"> 965</span></a><span class="sd">            Shape of the nodes (e.g., `&#39;o&#39;` for circle, `&#39;s&#39;` for square). Default is `&#39;o&#39;`.</span>
</span><span id="StateTransitionGraph-966"><a href="#StateTransitionGraph-966"><span class="linenos"> 966</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-967"><a href="#StateTransitionGraph-967"><span class="linenos"> 967</span></a><span class="sd">        figsize : tuple, optional</span>
</span><span id="StateTransitionGraph-968"><a href="#StateTransitionGraph-968"><span class="linenos"> 968</span></a><span class="sd">            Size of the matplotlib figure. Default is (14, 7).</span>
</span><span id="StateTransitionGraph-969"><a href="#StateTransitionGraph-969"><span class="linenos"> 969</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-970"><a href="#StateTransitionGraph-970"><span class="linenos"> 970</span></a><span class="sd">        clear : bool, optional</span>
</span><span id="StateTransitionGraph-971"><a href="#StateTransitionGraph-971"><span class="linenos"> 971</span></a><span class="sd">            If True, clears the figure before plotting. Default is True.</span>
</span><span id="StateTransitionGraph-972"><a href="#StateTransitionGraph-972"><span class="linenos"> 972</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-973"><a href="#StateTransitionGraph-973"><span class="linenos"> 973</span></a><span class="sd">        fontsize : int, optional</span>
</span><span id="StateTransitionGraph-974"><a href="#StateTransitionGraph-974"><span class="linenos"> 974</span></a><span class="sd">            Font size used for node labels. Default is 10.</span>
</span><span id="StateTransitionGraph-975"><a href="#StateTransitionGraph-975"><span class="linenos"> 975</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-976"><a href="#StateTransitionGraph-976"><span class="linenos"> 976</span></a><span class="sd">        fontcolor : str, optional</span>
</span><span id="StateTransitionGraph-977"><a href="#StateTransitionGraph-977"><span class="linenos"> 977</span></a><span class="sd">            Font color for node labels. Default is `&#39;black&#39;`.</span>
</span><span id="StateTransitionGraph-978"><a href="#StateTransitionGraph-978"><span class="linenos"> 978</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-979"><a href="#StateTransitionGraph-979"><span class="linenos"> 979</span></a><span class="sd">        label_pos : float, optional</span>
</span><span id="StateTransitionGraph-980"><a href="#StateTransitionGraph-980"><span class="linenos"> 980</span></a><span class="sd">            Position of edge labels along the edge (0=start, 1=end). Default is 0.75.</span>
</span><span id="StateTransitionGraph-981"><a href="#StateTransitionGraph-981"><span class="linenos"> 981</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-982"><a href="#StateTransitionGraph-982"><span class="linenos"> 982</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-983"><a href="#StateTransitionGraph-983"><span class="linenos"> 983</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-984"><a href="#StateTransitionGraph-984"><span class="linenos"> 984</span></a><span class="sd">        fig : matplotlib.figure.Figure</span>
</span><span id="StateTransitionGraph-985"><a href="#StateTransitionGraph-985"><span class="linenos"> 985</span></a><span class="sd">            The created matplotlib figure object.</span>
</span><span id="StateTransitionGraph-986"><a href="#StateTransitionGraph-986"><span class="linenos"> 986</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-987"><a href="#StateTransitionGraph-987"><span class="linenos"> 987</span></a><span class="sd">        ax : matplotlib.axes.Axes</span>
</span><span id="StateTransitionGraph-988"><a href="#StateTransitionGraph-988"><span class="linenos"> 988</span></a><span class="sd">            The axes object where the graph is drawn.</span>
</span><span id="StateTransitionGraph-989"><a href="#StateTransitionGraph-989"><span class="linenos"> 989</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-990"><a href="#StateTransitionGraph-990"><span class="linenos"> 990</span></a><span class="sd">        pos : dict</span>
</span><span id="StateTransitionGraph-991"><a href="#StateTransitionGraph-991"><span class="linenos"> 991</span></a><span class="sd">            The dictionary of node positions used for drawing.</span>
</span><span id="StateTransitionGraph-992"><a href="#StateTransitionGraph-992"><span class="linenos"> 992</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-993"><a href="#StateTransitionGraph-993"><span class="linenos"> 993</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-994"><a href="#StateTransitionGraph-994"><span class="linenos"> 994</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-995"><a href="#StateTransitionGraph-995"><span class="linenos"> 995</span></a><span class="sd">        - Node labels and colors must be set beforehand using `addState()` or `setStateProperties()`.</span>
</span><span id="StateTransitionGraph-996"><a href="#StateTransitionGraph-996"><span class="linenos"> 996</span></a><span class="sd">        - Edge attributes must include `&#39;label&#39;` and `&#39;color&#39;`.</span>
</span><span id="StateTransitionGraph-997"><a href="#StateTransitionGraph-997"><span class="linenos"> 997</span></a><span class="sd">        - This method modifies the current matplotlib figure and is intended for interactive or inline use.</span>
</span><span id="StateTransitionGraph-998"><a href="#StateTransitionGraph-998"><span class="linenos"> 998</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph-999"><a href="#StateTransitionGraph-999"><span class="linenos"> 999</span></a>        <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>        
</span><span id="StateTransitionGraph-1000"><a href="#StateTransitionGraph-1000"><span class="linenos">1000</span></a>        <span class="n">node_colors</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>        
</span><span id="StateTransitionGraph-1001"><a href="#StateTransitionGraph-1001"><span class="linenos">1001</span></a>        <span class="n">node_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
</span><span id="StateTransitionGraph-1002"><a href="#StateTransitionGraph-1002"><span class="linenos">1002</span></a>        <span class="c1">#node_shapes = {(hw,sw): &quot;o&quot; if hw+sw&lt;G.N else &quot;s&quot; for hw,sw in G.nodes()}        </span>
</span><span id="StateTransitionGraph-1003"><a href="#StateTransitionGraph-1003"><span class="linenos">1003</span></a>            
</span><span id="StateTransitionGraph-1004"><a href="#StateTransitionGraph-1004"><span class="linenos">1004</span></a>        <span class="n">edge_cols</span> <span class="o">=</span> <span class="p">{(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span> <span class="bp">self</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
</span><span id="StateTransitionGraph-1005"><a href="#StateTransitionGraph-1005"><span class="linenos">1005</span></a>            
</span><span id="StateTransitionGraph-1006"><a href="#StateTransitionGraph-1006"><span class="linenos">1006</span></a>        <span class="k">if</span> <span class="n">edge_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1007"><a href="#StateTransitionGraph-1007"><span class="linenos">1007</span></a>            <span class="n">edge_labels</span> <span class="o">=</span> <span class="p">{(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span> <span class="bp">self</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
</span><span id="StateTransitionGraph-1008"><a href="#StateTransitionGraph-1008"><span class="linenos">1008</span></a>            
</span><span id="StateTransitionGraph-1009"><a href="#StateTransitionGraph-1009"><span class="linenos">1009</span></a>        <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1010"><a href="#StateTransitionGraph-1010"><span class="linenos">1010</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">kamada_kawai_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    
</span><span id="StateTransitionGraph-1011"><a href="#StateTransitionGraph-1011"><span class="linenos">1011</span></a>            
</span><span id="StateTransitionGraph-1012"><a href="#StateTransitionGraph-1012"><span class="linenos">1012</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="n">clear</span><span class="p">)</span>                        
</span><span id="StateTransitionGraph-1013"><a href="#StateTransitionGraph-1013"><span class="linenos">1013</span></a>        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span> <span class="n">node_shape</span> <span class="o">=</span> <span class="n">node_shapes</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">)</span>                    
</span><span id="StateTransitionGraph-1014"><a href="#StateTransitionGraph-1014"><span class="linenos">1014</span></a>        
</span><span id="StateTransitionGraph-1015"><a href="#StateTransitionGraph-1015"><span class="linenos">1015</span></a>        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="n">fontcolor</span><span class="p">)</span>  <span class="c1"># Draw node labels</span>
</span><span id="StateTransitionGraph-1016"><a href="#StateTransitionGraph-1016"><span class="linenos">1016</span></a>        <span class="k">if</span> <span class="n">bended</span><span class="p">:</span> 
</span><span id="StateTransitionGraph-1017"><a href="#StateTransitionGraph-1017"><span class="linenos">1017</span></a>            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>  <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="p">[</span><span class="n">edge_cols</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">],</span> 
</span><span id="StateTransitionGraph-1018"><a href="#StateTransitionGraph-1018"><span class="linenos">1018</span></a>                                   <span class="n">node_size</span> <span class="o">=</span> <span class="n">node_size</span><span class="p">,</span> 
</span><span id="StateTransitionGraph-1019"><a href="#StateTransitionGraph-1019"><span class="linenos">1019</span></a>                                   <span class="n">arrows</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">arrowstyle</span> <span class="o">=</span> <span class="s1">&#39;-|&gt;&#39;</span><span class="p">,</span>
</span><span id="StateTransitionGraph-1020"><a href="#StateTransitionGraph-1020"><span class="linenos">1020</span></a>                                   <span class="n">connectionstyle</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;arc3,rad=</span><span class="si">{</span><span class="n">rad</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>        
</span><span id="StateTransitionGraph-1021"><a href="#StateTransitionGraph-1021"><span class="linenos">1021</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_draw_networkx_edge_labels</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">,</span><span class="n">rotate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rad</span> <span class="o">=</span> <span class="n">rad</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="n">label_pos</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1022"><a href="#StateTransitionGraph-1022"><span class="linenos">1022</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1023"><a href="#StateTransitionGraph-1023"><span class="linenos">1023</span></a>            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>  <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="p">[</span><span class="n">edge_cols</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">],</span> 
</span><span id="StateTransitionGraph-1024"><a href="#StateTransitionGraph-1024"><span class="linenos">1024</span></a>                               <span class="n">node_size</span> <span class="o">=</span> <span class="n">node_size</span><span class="p">,</span> 
</span><span id="StateTransitionGraph-1025"><a href="#StateTransitionGraph-1025"><span class="linenos">1025</span></a>                               <span class="c1">#min_target_margin=17, arrowsize=15,</span>
</span><span id="StateTransitionGraph-1026"><a href="#StateTransitionGraph-1026"><span class="linenos">1026</span></a>                               <span class="n">arrows</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">arrowstyle</span> <span class="o">=</span> <span class="s1">&#39;-|&gt;&#39;</span><span class="p">)</span>                           
</span><span id="StateTransitionGraph-1027"><a href="#StateTransitionGraph-1027"><span class="linenos">1027</span></a>            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="n">label_pos</span><span class="p">)</span> <span class="c1">#, verticalalignment=&#39;center&#39;,)        </span>
</span><span id="StateTransitionGraph-1028"><a href="#StateTransitionGraph-1028"><span class="linenos">1028</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>    
</span><span id="StateTransitionGraph-1029"><a href="#StateTransitionGraph-1029"><span class="linenos">1029</span></a>        
</span><span id="StateTransitionGraph-1030"><a href="#StateTransitionGraph-1030"><span class="linenos">1030</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">(),</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">pos</span>
</span><span id="StateTransitionGraph-1031"><a href="#StateTransitionGraph-1031"><span class="linenos">1031</span></a>    
</span><span id="StateTransitionGraph-1032"><a href="#StateTransitionGraph-1032"><span class="linenos">1032</span></a>    <span class="k">def</span> <span class="nf">animateSimulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expectedTimePerState</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inNotebook</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1033"><a href="#StateTransitionGraph-1033"><span class="linenos">1033</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1034"><a href="#StateTransitionGraph-1034"><span class="linenos">1034</span></a><span class="sd">        Animate a simulation trajectory through the state transition graph.</span>
</span><span id="StateTransitionGraph-1035"><a href="#StateTransitionGraph-1035"><span class="linenos">1035</span></a><span class="sd">        The animation of the CTMC simulation run either in a Jupyter notebook or as a regular script.</span>
</span><span id="StateTransitionGraph-1036"><a href="#StateTransitionGraph-1036"><span class="linenos">1036</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1037"><a href="#StateTransitionGraph-1037"><span class="linenos">1037</span></a><span class="sd">        This method visualizes the path of a simulated or predefined sequence of states by</span>
</span><span id="StateTransitionGraph-1038"><a href="#StateTransitionGraph-1038"><span class="linenos">1038</span></a><span class="sd">        temporarily highlighting each visited state over time. The time spent in each state</span>
</span><span id="StateTransitionGraph-1039"><a href="#StateTransitionGraph-1039"><span class="linenos">1039</span></a><span class="sd">        is scaled relative to the average sojourn time to produce a visually smooth animation.</span>
</span><span id="StateTransitionGraph-1040"><a href="#StateTransitionGraph-1040"><span class="linenos">1040</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1041"><a href="#StateTransitionGraph-1041"><span class="linenos">1041</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-1042"><a href="#StateTransitionGraph-1042"><span class="linenos">1042</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-1043"><a href="#StateTransitionGraph-1043"><span class="linenos">1043</span></a><span class="sd">        - `expectedTimePerState` : float, optional</span>
</span><span id="StateTransitionGraph-1044"><a href="#StateTransitionGraph-1044"><span class="linenos">1044</span></a><span class="sd">            Approximate duration (in seconds) for an average state visit in the animation.</span>
</span><span id="StateTransitionGraph-1045"><a href="#StateTransitionGraph-1045"><span class="linenos">1045</span></a><span class="sd">            The actual pause duration for each state is scaled proportionally to its sojourn time.</span>
</span><span id="StateTransitionGraph-1046"><a href="#StateTransitionGraph-1046"><span class="linenos">1046</span></a><span class="sd">            Default is 1 second.</span>
</span><span id="StateTransitionGraph-1047"><a href="#StateTransitionGraph-1047"><span class="linenos">1047</span></a><span class="sd">            </span>
</span><span id="StateTransitionGraph-1048"><a href="#StateTransitionGraph-1048"><span class="linenos">1048</span></a><span class="sd">        - `inNotebook` : bool, optional</span>
</span><span id="StateTransitionGraph-1049"><a href="#StateTransitionGraph-1049"><span class="linenos">1049</span></a><span class="sd">            If True, uses Jupyter-compatible animation (with display + clear_output).</span>
</span><span id="StateTransitionGraph-1050"><a href="#StateTransitionGraph-1050"><span class="linenos">1050</span></a><span class="sd">            If False, uses standard matplotlib interactive animation. Default is True.</span>
</span><span id="StateTransitionGraph-1051"><a href="#StateTransitionGraph-1051"><span class="linenos">1051</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1052"><a href="#StateTransitionGraph-1052"><span class="linenos">1052</span></a><span class="sd">        - `**kwargs` : dict</span>
</span><span id="StateTransitionGraph-1053"><a href="#StateTransitionGraph-1053"><span class="linenos">1053</span></a><span class="sd">            Additional keyword arguments including:</span>
</span><span id="StateTransitionGraph-1054"><a href="#StateTransitionGraph-1054"><span class="linenos">1054</span></a><span class="sd">                - states : list</span>
</span><span id="StateTransitionGraph-1055"><a href="#StateTransitionGraph-1055"><span class="linenos">1055</span></a><span class="sd">                    A list of visited states (nodes) to animate.</span>
</span><span id="StateTransitionGraph-1056"><a href="#StateTransitionGraph-1056"><span class="linenos">1056</span></a><span class="sd">                - times : list or np.ndarray</span>
</span><span id="StateTransitionGraph-1057"><a href="#StateTransitionGraph-1057"><span class="linenos">1057</span></a><span class="sd">                    Sojourn times in each state (same length as `states`).</span>
</span><span id="StateTransitionGraph-1058"><a href="#StateTransitionGraph-1058"><span class="linenos">1058</span></a><span class="sd">                - startNode : hashable</span>
</span><span id="StateTransitionGraph-1059"><a href="#StateTransitionGraph-1059"><span class="linenos">1059</span></a><span class="sd">                    Optional start node for automatic simulation if `states` and `times` are not provided.</span>
</span><span id="StateTransitionGraph-1060"><a href="#StateTransitionGraph-1060"><span class="linenos">1060</span></a><span class="sd">                - numEvents : int</span>
</span><span id="StateTransitionGraph-1061"><a href="#StateTransitionGraph-1061"><span class="linenos">1061</span></a><span class="sd">                    Number of events (state transitions) to simulate.</span>
</span><span id="StateTransitionGraph-1062"><a href="#StateTransitionGraph-1062"><span class="linenos">1062</span></a><span class="sd">                - Additional drawing-related kwargs are passed to `drawTransitionGraph()`.</span>
</span><span id="StateTransitionGraph-1063"><a href="#StateTransitionGraph-1063"><span class="linenos">1063</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1064"><a href="#StateTransitionGraph-1064"><span class="linenos">1064</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph-1065"><a href="#StateTransitionGraph-1065"><span class="linenos">1065</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph-1066"><a href="#StateTransitionGraph-1066"><span class="linenos">1066</span></a><span class="sd">        ValueError</span>
</span><span id="StateTransitionGraph-1067"><a href="#StateTransitionGraph-1067"><span class="linenos">1067</span></a><span class="sd">            If neither a `(states, times)` pair nor `(startNode, numEvents)` are provided.</span>
</span><span id="StateTransitionGraph-1068"><a href="#StateTransitionGraph-1068"><span class="linenos">1068</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1069"><a href="#StateTransitionGraph-1069"><span class="linenos">1069</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-1070"><a href="#StateTransitionGraph-1070"><span class="linenos">1070</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-1071"><a href="#StateTransitionGraph-1071"><span class="linenos">1071</span></a><span class="sd">        None</span>
</span><span id="StateTransitionGraph-1072"><a href="#StateTransitionGraph-1072"><span class="linenos">1072</span></a><span class="sd">            The animation is shown interactively using matplotlib but no data is returned.</span>
</span><span id="StateTransitionGraph-1073"><a href="#StateTransitionGraph-1073"><span class="linenos">1073</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1074"><a href="#StateTransitionGraph-1074"><span class="linenos">1074</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-1075"><a href="#StateTransitionGraph-1075"><span class="linenos">1075</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-1076"><a href="#StateTransitionGraph-1076"><span class="linenos">1076</span></a><span class="sd">        - If `states` and `times` are not supplied, a simulation is run via `simulateMarkovModel()`.</span>
</span><span id="StateTransitionGraph-1077"><a href="#StateTransitionGraph-1077"><span class="linenos">1077</span></a><span class="sd">        - The function uses matplotlib&#39;s interactive mode (`plt.ion()`) to animate transitions.</span>
</span><span id="StateTransitionGraph-1078"><a href="#StateTransitionGraph-1078"><span class="linenos">1078</span></a><span class="sd">        - The average sojourn time across all states is used to normalize animation speed.</span>
</span><span id="StateTransitionGraph-1079"><a href="#StateTransitionGraph-1079"><span class="linenos">1079</span></a><span class="sd">        - Each visited state is highlighted in red for its corresponding (scaled) dwell time.</span>
</span><span id="StateTransitionGraph-1080"><a href="#StateTransitionGraph-1080"><span class="linenos">1080</span></a><span class="sd">        - Drawing arguments like layout, font size, or color can be customized via kwargs.</span>
</span><span id="StateTransitionGraph-1081"><a href="#StateTransitionGraph-1081"><span class="linenos">1081</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph-1082"><a href="#StateTransitionGraph-1082"><span class="linenos">1082</span></a>        <span class="c1"># expTimePerState: in seconds</span>
</span><span id="StateTransitionGraph-1083"><a href="#StateTransitionGraph-1083"><span class="linenos">1083</span></a>        <span class="k">if</span> <span class="s2">&quot;states&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;times&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1084"><a href="#StateTransitionGraph-1084"><span class="linenos">1084</span></a>            <span class="n">states</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;states&quot;</span><span class="p">]</span>
</span><span id="StateTransitionGraph-1085"><a href="#StateTransitionGraph-1085"><span class="linenos">1085</span></a>            <span class="n">times</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;times&quot;</span><span class="p">]</span>
</span><span id="StateTransitionGraph-1086"><a href="#StateTransitionGraph-1086"><span class="linenos">1086</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1087"><a href="#StateTransitionGraph-1087"><span class="linenos">1087</span></a>            <span class="c1"># Run default simulation if data not provided</span>
</span><span id="StateTransitionGraph-1088"><a href="#StateTransitionGraph-1088"><span class="linenos">1088</span></a>            <span class="k">if</span> <span class="s2">&quot;startNode&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;numEvents&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1089"><a href="#StateTransitionGraph-1089"><span class="linenos">1089</span></a>                <span class="n">states</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulateMarkovModel</span><span class="p">(</span><span class="n">startNode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numEvents</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1090"><a href="#StateTransitionGraph-1090"><span class="linenos">1090</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1091"><a href="#StateTransitionGraph-1091"><span class="linenos">1091</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must provide either (&#39;states&#39; and &#39;times&#39;) or (&#39;startNode&#39; and &#39;numEvents&#39;).&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1092"><a href="#StateTransitionGraph-1092"><span class="linenos">1092</span></a>        
</span><span id="StateTransitionGraph-1093"><a href="#StateTransitionGraph-1093"><span class="linenos">1093</span></a>        <span class="c1">#avg_OutGoingRate = np.mean([self.nodes[n].get(&quot;sumOutgoingRates&quot;, 0) for n in self.nodes])</span>
</span><span id="StateTransitionGraph-1094"><a href="#StateTransitionGraph-1094"><span class="linenos">1094</span></a>        <span class="n">avg_Time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="mf">1.0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sumOutgoingRates&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">])</span>
</span><span id="StateTransitionGraph-1095"><a href="#StateTransitionGraph-1095"><span class="linenos">1095</span></a>        
</span><span id="StateTransitionGraph-1096"><a href="#StateTransitionGraph-1096"><span class="linenos">1096</span></a>            
</span><span id="StateTransitionGraph-1097"><a href="#StateTransitionGraph-1097"><span class="linenos">1097</span></a>        <span class="c1"># Remove simulation-related keys before drawing</span>
</span><span id="StateTransitionGraph-1098"><a href="#StateTransitionGraph-1098"><span class="linenos">1098</span></a>        <span class="n">draw_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="s2">&quot;times&quot;</span><span class="p">,</span> <span class="s2">&quot;startNode&quot;</span><span class="p">,</span> <span class="s2">&quot;numEvents&quot;</span><span class="p">}}</span>
</span><span id="StateTransitionGraph-1099"><a href="#StateTransitionGraph-1099"><span class="linenos">1099</span></a>                
</span><span id="StateTransitionGraph-1100"><a href="#StateTransitionGraph-1100"><span class="linenos">1100</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawTransitionGraph</span><span class="p">(</span><span class="o">**</span><span class="n">draw_kwargs</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1101"><a href="#StateTransitionGraph-1101"><span class="linenos">1101</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="StateTransitionGraph-1102"><a href="#StateTransitionGraph-1102"><span class="linenos">1102</span></a>        
</span><span id="StateTransitionGraph-1103"><a href="#StateTransitionGraph-1103"><span class="linenos">1103</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">inNotebook</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1104"><a href="#StateTransitionGraph-1104"><span class="linenos">1104</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
</span><span id="StateTransitionGraph-1105"><a href="#StateTransitionGraph-1105"><span class="linenos">1105</span></a>                                
</span><span id="StateTransitionGraph-1106"><a href="#StateTransitionGraph-1106"><span class="linenos">1106</span></a>        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">states</span><span class="p">,</span><span class="n">times</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1107"><a href="#StateTransitionGraph-1107"><span class="linenos">1107</span></a>            <span class="k">if</span> <span class="n">inNotebook</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1108"><a href="#StateTransitionGraph-1108"><span class="linenos">1108</span></a>                <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1109"><a href="#StateTransitionGraph-1109"><span class="linenos">1109</span></a>                <span class="n">artist</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
</span><span id="StateTransitionGraph-1110"><a href="#StateTransitionGraph-1110"><span class="linenos">1110</span></a>                                                <span class="n">node_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_NODE_ANIMATION_HIGHLIGHT</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1111"><a href="#StateTransitionGraph-1111"><span class="linenos">1111</span></a>                <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1112"><a href="#StateTransitionGraph-1112"><span class="linenos">1112</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1113"><a href="#StateTransitionGraph-1113"><span class="linenos">1113</span></a>                <span class="n">artist</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="p">],</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
</span><span id="StateTransitionGraph-1114"><a href="#StateTransitionGraph-1114"><span class="linenos">1114</span></a>                                       <span class="n">node_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_NODE_ANIMATION_HIGHLIGHT</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1115"><a href="#StateTransitionGraph-1115"><span class="linenos">1115</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>                        
</span><span id="StateTransitionGraph-1116"><a href="#StateTransitionGraph-1116"><span class="linenos">1116</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="n">time</span><span class="o">/</span><span class="n">avg_Time</span><span class="o">*</span><span class="n">expectedTimePerState</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1117"><a href="#StateTransitionGraph-1117"><span class="linenos">1117</span></a>                
</span><span id="StateTransitionGraph-1118"><a href="#StateTransitionGraph-1118"><span class="linenos">1118</span></a>                <span class="c1"># Remove highlighted node    </span>
</span><span id="StateTransitionGraph-1119"><a href="#StateTransitionGraph-1119"><span class="linenos">1119</span></a>                <span class="n">artist</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="StateTransitionGraph-1120"><a href="#StateTransitionGraph-1120"><span class="linenos">1120</span></a>        
</span><span id="StateTransitionGraph-1121"><a href="#StateTransitionGraph-1121"><span class="linenos">1121</span></a>        <span class="k">pass</span>
</span><span id="StateTransitionGraph-1122"><a href="#StateTransitionGraph-1122"><span class="linenos">1122</span></a>    
</span><span id="StateTransitionGraph-1123"><a href="#StateTransitionGraph-1123"><span class="linenos">1123</span></a>        
</span><span id="StateTransitionGraph-1124"><a href="#StateTransitionGraph-1124"><span class="linenos">1124</span></a>    
</span><span id="StateTransitionGraph-1125"><a href="#StateTransitionGraph-1125"><span class="linenos">1125</span></a>    <span class="k">def</span> <span class="nf">states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1126"><a href="#StateTransitionGraph-1126"><span class="linenos">1126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1127"><a href="#StateTransitionGraph-1127"><span class="linenos">1127</span></a><span class="sd">        Return a view of the graph&#39;s states (nodes), optionally with attributes.</span>
</span><span id="StateTransitionGraph-1128"><a href="#StateTransitionGraph-1128"><span class="linenos">1128</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1129"><a href="#StateTransitionGraph-1129"><span class="linenos">1129</span></a><span class="sd">        This method is functionally identical to `self.nodes()` in NetworkX, but is</span>
</span><span id="StateTransitionGraph-1130"><a href="#StateTransitionGraph-1130"><span class="linenos">1130</span></a><span class="sd">        renamed to `states()` to reflect the semantics of a state transition graph or</span>
</span><span id="StateTransitionGraph-1131"><a href="#StateTransitionGraph-1131"><span class="linenos">1131</span></a><span class="sd">        Markov model, where nodes represent system states.</span>
</span><span id="StateTransitionGraph-1132"><a href="#StateTransitionGraph-1132"><span class="linenos">1132</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1133"><a href="#StateTransitionGraph-1133"><span class="linenos">1133</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-1134"><a href="#StateTransitionGraph-1134"><span class="linenos">1134</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-1135"><a href="#StateTransitionGraph-1135"><span class="linenos">1135</span></a><span class="sd">        data : bool, optional</span>
</span><span id="StateTransitionGraph-1136"><a href="#StateTransitionGraph-1136"><span class="linenos">1136</span></a><span class="sd">            If True, returns a view of `(node, attribute_dict)` pairs.</span>
</span><span id="StateTransitionGraph-1137"><a href="#StateTransitionGraph-1137"><span class="linenos">1137</span></a><span class="sd">            If False (default), returns a view of node identifiers only.</span>
</span><span id="StateTransitionGraph-1138"><a href="#StateTransitionGraph-1138"><span class="linenos">1138</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1139"><a href="#StateTransitionGraph-1139"><span class="linenos">1139</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-1140"><a href="#StateTransitionGraph-1140"><span class="linenos">1140</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-1141"><a href="#StateTransitionGraph-1141"><span class="linenos">1141</span></a><span class="sd">        networkx.classes.reportviews.NodeView or NodeDataView</span>
</span><span id="StateTransitionGraph-1142"><a href="#StateTransitionGraph-1142"><span class="linenos">1142</span></a><span class="sd">            A view over the graph’s nodes or `(node, data)` pairs, depending on the `data` flag.</span>
</span><span id="StateTransitionGraph-1143"><a href="#StateTransitionGraph-1143"><span class="linenos">1143</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1144"><a href="#StateTransitionGraph-1144"><span class="linenos">1144</span></a><span class="sd">        Examples</span>
</span><span id="StateTransitionGraph-1145"><a href="#StateTransitionGraph-1145"><span class="linenos">1145</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph-1146"><a href="#StateTransitionGraph-1146"><span class="linenos">1146</span></a><span class="sd">        &gt;&gt;&gt; G.states()</span>
</span><span id="StateTransitionGraph-1147"><a href="#StateTransitionGraph-1147"><span class="linenos">1147</span></a><span class="sd">        [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]</span>
</span><span id="StateTransitionGraph-1148"><a href="#StateTransitionGraph-1148"><span class="linenos">1148</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1149"><a href="#StateTransitionGraph-1149"><span class="linenos">1149</span></a><span class="sd">        &gt;&gt;&gt; list(G.states(data=True))</span>
</span><span id="StateTransitionGraph-1150"><a href="#StateTransitionGraph-1150"><span class="linenos">1150</span></a><span class="sd">        [(&#39;A&#39;, {&#39;color&#39;: &#39;red&#39;, &#39;label&#39;: &#39;Start&#39;}), (&#39;B&#39;, {...}), ...]</span>
</span><span id="StateTransitionGraph-1151"><a href="#StateTransitionGraph-1151"><span class="linenos">1151</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1152"><a href="#StateTransitionGraph-1152"><span class="linenos">1152</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-1153"><a href="#StateTransitionGraph-1153"><span class="linenos">1153</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-1154"><a href="#StateTransitionGraph-1154"><span class="linenos">1154</span></a><span class="sd">        - This is a convenience wrapper for semantic clarity in models where nodes represent states.</span>
</span><span id="StateTransitionGraph-1155"><a href="#StateTransitionGraph-1155"><span class="linenos">1155</span></a><span class="sd">        - The view is dynamic: changes to the graph are reflected in the returned view.</span>
</span><span id="StateTransitionGraph-1156"><a href="#StateTransitionGraph-1156"><span class="linenos">1156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1157"><a href="#StateTransitionGraph-1157"><span class="linenos">1157</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1158"><a href="#StateTransitionGraph-1158"><span class="linenos">1158</span></a>
</span><span id="StateTransitionGraph-1159"><a href="#StateTransitionGraph-1159"><span class="linenos">1159</span></a>    
</span><span id="StateTransitionGraph-1160"><a href="#StateTransitionGraph-1160"><span class="linenos">1160</span></a>    <span class="k">def</span> <span class="nf">setStateColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1161"><a href="#StateTransitionGraph-1161"><span class="linenos">1161</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1162"><a href="#StateTransitionGraph-1162"><span class="linenos">1162</span></a><span class="sd">        Set the color attribute of a specific state (node).</span>
</span><span id="StateTransitionGraph-1163"><a href="#StateTransitionGraph-1163"><span class="linenos">1163</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1164"><a href="#StateTransitionGraph-1164"><span class="linenos">1164</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-1165"><a href="#StateTransitionGraph-1165"><span class="linenos">1165</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-1166"><a href="#StateTransitionGraph-1166"><span class="linenos">1166</span></a><span class="sd">        state : hashable</span>
</span><span id="StateTransitionGraph-1167"><a href="#StateTransitionGraph-1167"><span class="linenos">1167</span></a><span class="sd">            The identifier of the state whose color is to be updated.</span>
</span><span id="StateTransitionGraph-1168"><a href="#StateTransitionGraph-1168"><span class="linenos">1168</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1169"><a href="#StateTransitionGraph-1169"><span class="linenos">1169</span></a><span class="sd">        color : str</span>
</span><span id="StateTransitionGraph-1170"><a href="#StateTransitionGraph-1170"><span class="linenos">1170</span></a><span class="sd">            The new color to assign to the state (used for visualization).</span>
</span><span id="StateTransitionGraph-1171"><a href="#StateTransitionGraph-1171"><span class="linenos">1171</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1172"><a href="#StateTransitionGraph-1172"><span class="linenos">1172</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-1173"><a href="#StateTransitionGraph-1173"><span class="linenos">1173</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-1174"><a href="#StateTransitionGraph-1174"><span class="linenos">1174</span></a><span class="sd">        None</span>
</span><span id="StateTransitionGraph-1175"><a href="#StateTransitionGraph-1175"><span class="linenos">1175</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1176"><a href="#StateTransitionGraph-1176"><span class="linenos">1176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
</span><span id="StateTransitionGraph-1177"><a href="#StateTransitionGraph-1177"><span class="linenos">1177</span></a>        
</span><span id="StateTransitionGraph-1178"><a href="#StateTransitionGraph-1178"><span class="linenos">1178</span></a>        
</span><span id="StateTransitionGraph-1179"><a href="#StateTransitionGraph-1179"><span class="linenos">1179</span></a>    <span class="k">def</span> <span class="nf">setStateLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1180"><a href="#StateTransitionGraph-1180"><span class="linenos">1180</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1181"><a href="#StateTransitionGraph-1181"><span class="linenos">1181</span></a><span class="sd">        Set the label attribute of a specific state (node).</span>
</span><span id="StateTransitionGraph-1182"><a href="#StateTransitionGraph-1182"><span class="linenos">1182</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1183"><a href="#StateTransitionGraph-1183"><span class="linenos">1183</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-1184"><a href="#StateTransitionGraph-1184"><span class="linenos">1184</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-1185"><a href="#StateTransitionGraph-1185"><span class="linenos">1185</span></a><span class="sd">        state : hashable</span>
</span><span id="StateTransitionGraph-1186"><a href="#StateTransitionGraph-1186"><span class="linenos">1186</span></a><span class="sd">            The identifier of the state whose label is to be updated.</span>
</span><span id="StateTransitionGraph-1187"><a href="#StateTransitionGraph-1187"><span class="linenos">1187</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1188"><a href="#StateTransitionGraph-1188"><span class="linenos">1188</span></a><span class="sd">        label : str</span>
</span><span id="StateTransitionGraph-1189"><a href="#StateTransitionGraph-1189"><span class="linenos">1189</span></a><span class="sd">            The new label to assign to the state (used for visualization or annotation).</span>
</span><span id="StateTransitionGraph-1190"><a href="#StateTransitionGraph-1190"><span class="linenos">1190</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1191"><a href="#StateTransitionGraph-1191"><span class="linenos">1191</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-1192"><a href="#StateTransitionGraph-1192"><span class="linenos">1192</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-1193"><a href="#StateTransitionGraph-1193"><span class="linenos">1193</span></a><span class="sd">        None</span>
</span><span id="StateTransitionGraph-1194"><a href="#StateTransitionGraph-1194"><span class="linenos">1194</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1195"><a href="#StateTransitionGraph-1195"><span class="linenos">1195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="StateTransitionGraph-1196"><a href="#StateTransitionGraph-1196"><span class="linenos">1196</span></a>
</span><span id="StateTransitionGraph-1197"><a href="#StateTransitionGraph-1197"><span class="linenos">1197</span></a>    <span class="k">def</span> <span class="nf">prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1198"><a href="#StateTransitionGraph-1198"><span class="linenos">1198</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1199"><a href="#StateTransitionGraph-1199"><span class="linenos">1199</span></a><span class="sd">        Return the steady-state probability of a specific state.</span>
</span><span id="StateTransitionGraph-1200"><a href="#StateTransitionGraph-1200"><span class="linenos">1200</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1201"><a href="#StateTransitionGraph-1201"><span class="linenos">1201</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-1202"><a href="#StateTransitionGraph-1202"><span class="linenos">1202</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-1203"><a href="#StateTransitionGraph-1203"><span class="linenos">1203</span></a><span class="sd">        state : hashable</span>
</span><span id="StateTransitionGraph-1204"><a href="#StateTransitionGraph-1204"><span class="linenos">1204</span></a><span class="sd">            The identifier of the state whose probability is to be retrieved.</span>
</span><span id="StateTransitionGraph-1205"><a href="#StateTransitionGraph-1205"><span class="linenos">1205</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1206"><a href="#StateTransitionGraph-1206"><span class="linenos">1206</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-1207"><a href="#StateTransitionGraph-1207"><span class="linenos">1207</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-1208"><a href="#StateTransitionGraph-1208"><span class="linenos">1208</span></a><span class="sd">        float</span>
</span><span id="StateTransitionGraph-1209"><a href="#StateTransitionGraph-1209"><span class="linenos">1209</span></a><span class="sd">            The steady-state probability of the specified state.</span>
</span><span id="StateTransitionGraph-1210"><a href="#StateTransitionGraph-1210"><span class="linenos">1210</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1211"><a href="#StateTransitionGraph-1211"><span class="linenos">1211</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph-1212"><a href="#StateTransitionGraph-1212"><span class="linenos">1212</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph-1213"><a href="#StateTransitionGraph-1213"><span class="linenos">1213</span></a><span class="sd">        KeyError</span>
</span><span id="StateTransitionGraph-1214"><a href="#StateTransitionGraph-1214"><span class="linenos">1214</span></a><span class="sd">            If the state is not found in the steady-state probability dictionary.</span>
</span><span id="StateTransitionGraph-1215"><a href="#StateTransitionGraph-1215"><span class="linenos">1215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1216"><a href="#StateTransitionGraph-1216"><span class="linenos">1216</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_probabilities</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="StateTransitionGraph-1217"><a href="#StateTransitionGraph-1217"><span class="linenos">1217</span></a>        
</span><span id="StateTransitionGraph-1218"><a href="#StateTransitionGraph-1218"><span class="linenos">1218</span></a>    
</span><span id="StateTransitionGraph-1219"><a href="#StateTransitionGraph-1219"><span class="linenos">1219</span></a>    <span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1220"><a href="#StateTransitionGraph-1220"><span class="linenos">1220</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1221"><a href="#StateTransitionGraph-1221"><span class="linenos">1221</span></a><span class="sd">        Return the steady-state probabilities for all states.</span>
</span><span id="StateTransitionGraph-1222"><a href="#StateTransitionGraph-1222"><span class="linenos">1222</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1223"><a href="#StateTransitionGraph-1223"><span class="linenos">1223</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-1224"><a href="#StateTransitionGraph-1224"><span class="linenos">1224</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-1225"><a href="#StateTransitionGraph-1225"><span class="linenos">1225</span></a><span class="sd">        dict</span>
</span><span id="StateTransitionGraph-1226"><a href="#StateTransitionGraph-1226"><span class="linenos">1226</span></a><span class="sd">            A dictionary mapping each state to its steady-state probability.</span>
</span><span id="StateTransitionGraph-1227"><a href="#StateTransitionGraph-1227"><span class="linenos">1227</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1228"><a href="#StateTransitionGraph-1228"><span class="linenos">1228</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-1229"><a href="#StateTransitionGraph-1229"><span class="linenos">1229</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-1230"><a href="#StateTransitionGraph-1230"><span class="linenos">1230</span></a><span class="sd">        - The probabilities are computed via `calcSteadyStateProbs()` and stored internally.</span>
</span><span id="StateTransitionGraph-1231"><a href="#StateTransitionGraph-1231"><span class="linenos">1231</span></a><span class="sd">        - Use this method to access the full steady-state distribution.</span>
</span><span id="StateTransitionGraph-1232"><a href="#StateTransitionGraph-1232"><span class="linenos">1232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1233"><a href="#StateTransitionGraph-1233"><span class="linenos">1233</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_probabilities</span>
</span><span id="StateTransitionGraph-1234"><a href="#StateTransitionGraph-1234"><span class="linenos">1234</span></a>
</span><span id="StateTransitionGraph-1235"><a href="#StateTransitionGraph-1235"><span class="linenos">1235</span></a>    <span class="k">def</span> <span class="nf">getEmptySystemProbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1236"><a href="#StateTransitionGraph-1236"><span class="linenos">1236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1237"><a href="#StateTransitionGraph-1237"><span class="linenos">1237</span></a><span class="sd">        Create an initial state distribution where all probability mass is in a single state.</span>
</span><span id="StateTransitionGraph-1238"><a href="#StateTransitionGraph-1238"><span class="linenos">1238</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1239"><a href="#StateTransitionGraph-1239"><span class="linenos">1239</span></a><span class="sd">        By default, this method returns a distribution where the entire probability mass</span>
</span><span id="StateTransitionGraph-1240"><a href="#StateTransitionGraph-1240"><span class="linenos">1240</span></a><span class="sd">        is placed on the first node in the graph. Alternatively, a specific starting state</span>
</span><span id="StateTransitionGraph-1241"><a href="#StateTransitionGraph-1241"><span class="linenos">1241</span></a><span class="sd">        can be provided.</span>
</span><span id="StateTransitionGraph-1242"><a href="#StateTransitionGraph-1242"><span class="linenos">1242</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1243"><a href="#StateTransitionGraph-1243"><span class="linenos">1243</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-1244"><a href="#StateTransitionGraph-1244"><span class="linenos">1244</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-1245"><a href="#StateTransitionGraph-1245"><span class="linenos">1245</span></a><span class="sd">        state : hashable, optional</span>
</span><span id="StateTransitionGraph-1246"><a href="#StateTransitionGraph-1246"><span class="linenos">1246</span></a><span class="sd">            The state to initialize with probability 1. If None, the first node</span>
</span><span id="StateTransitionGraph-1247"><a href="#StateTransitionGraph-1247"><span class="linenos">1247</span></a><span class="sd">            in the graph (based on insertion order) is used.</span>
</span><span id="StateTransitionGraph-1248"><a href="#StateTransitionGraph-1248"><span class="linenos">1248</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1249"><a href="#StateTransitionGraph-1249"><span class="linenos">1249</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-1250"><a href="#StateTransitionGraph-1250"><span class="linenos">1250</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-1251"><a href="#StateTransitionGraph-1251"><span class="linenos">1251</span></a><span class="sd">        dict</span>
</span><span id="StateTransitionGraph-1252"><a href="#StateTransitionGraph-1252"><span class="linenos">1252</span></a><span class="sd">            A dictionary representing the initial distribution over states.</span>
</span><span id="StateTransitionGraph-1253"><a href="#StateTransitionGraph-1253"><span class="linenos">1253</span></a><span class="sd">            The selected state has probability 1, and all others have 0.</span>
</span><span id="StateTransitionGraph-1254"><a href="#StateTransitionGraph-1254"><span class="linenos">1254</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1255"><a href="#StateTransitionGraph-1255"><span class="linenos">1255</span></a><span class="sd">        Examples</span>
</span><span id="StateTransitionGraph-1256"><a href="#StateTransitionGraph-1256"><span class="linenos">1256</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph-1257"><a href="#StateTransitionGraph-1257"><span class="linenos">1257</span></a><span class="sd">        &gt;&gt;&gt; X0 = G.getEmptySystem()</span>
</span><span id="StateTransitionGraph-1258"><a href="#StateTransitionGraph-1258"><span class="linenos">1258</span></a><span class="sd">        &gt;&gt;&gt; sum(X0.values())  # 1.0</span>
</span><span id="StateTransitionGraph-1259"><a href="#StateTransitionGraph-1259"><span class="linenos">1259</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1260"><a href="#StateTransitionGraph-1260"><span class="linenos">1260</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-1261"><a href="#StateTransitionGraph-1261"><span class="linenos">1261</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-1262"><a href="#StateTransitionGraph-1262"><span class="linenos">1262</span></a><span class="sd">        - This method is useful for setting up deterministic initial conditions</span>
</span><span id="StateTransitionGraph-1263"><a href="#StateTransitionGraph-1263"><span class="linenos">1263</span></a><span class="sd">          in transient simulations of a CTMC.</span>
</span><span id="StateTransitionGraph-1264"><a href="#StateTransitionGraph-1264"><span class="linenos">1264</span></a><span class="sd">        - The return format is compatible with methods like `transientProbs()`.</span>
</span><span id="StateTransitionGraph-1265"><a href="#StateTransitionGraph-1265"><span class="linenos">1265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1266"><a href="#StateTransitionGraph-1266"><span class="linenos">1266</span></a>        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1267"><a href="#StateTransitionGraph-1267"><span class="linenos">1267</span></a>            <span class="n">first_node</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">))</span>
</span><span id="StateTransitionGraph-1268"><a href="#StateTransitionGraph-1268"><span class="linenos">1268</span></a>        <span class="n">X0</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">first_node</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">}</span>
</span><span id="StateTransitionGraph-1269"><a href="#StateTransitionGraph-1269"><span class="linenos">1269</span></a>        <span class="k">return</span> <span class="n">X0</span>
</span><span id="StateTransitionGraph-1270"><a href="#StateTransitionGraph-1270"><span class="linenos">1270</span></a>
</span><span id="StateTransitionGraph-1271"><a href="#StateTransitionGraph-1271"><span class="linenos">1271</span></a>        
</span><span id="StateTransitionGraph-1272"><a href="#StateTransitionGraph-1272"><span class="linenos">1272</span></a>
</span><span id="StateTransitionGraph-1273"><a href="#StateTransitionGraph-1273"><span class="linenos">1273</span></a>    <span class="k">def</span> <span class="nf">transientProbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initialDistribution</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1274"><a href="#StateTransitionGraph-1274"><span class="linenos">1274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1275"><a href="#StateTransitionGraph-1275"><span class="linenos">1275</span></a><span class="sd">        Compute the transient state probabilities at time `t` for the CTMC.</span>
</span><span id="StateTransitionGraph-1276"><a href="#StateTransitionGraph-1276"><span class="linenos">1276</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1277"><a href="#StateTransitionGraph-1277"><span class="linenos">1277</span></a><span class="sd">        This method solves the forward equation of a continuous-time Markov chain (CTMC):</span>
</span><span id="StateTransitionGraph-1278"><a href="#StateTransitionGraph-1278"><span class="linenos">1278</span></a><span class="sd">        X(t) = X0 · expm(Q·t), where `Q` is the generator (rate) matrix and `X0` is the</span>
</span><span id="StateTransitionGraph-1279"><a href="#StateTransitionGraph-1279"><span class="linenos">1279</span></a><span class="sd">        initial state distribution. It returns a dictionary mapping each state to its</span>
</span><span id="StateTransitionGraph-1280"><a href="#StateTransitionGraph-1280"><span class="linenos">1280</span></a><span class="sd">        probability at time `t`.</span>
</span><span id="StateTransitionGraph-1281"><a href="#StateTransitionGraph-1281"><span class="linenos">1281</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1282"><a href="#StateTransitionGraph-1282"><span class="linenos">1282</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph-1283"><a href="#StateTransitionGraph-1283"><span class="linenos">1283</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph-1284"><a href="#StateTransitionGraph-1284"><span class="linenos">1284</span></a><span class="sd">        - `initialDistribution` : dict </span>
</span><span id="StateTransitionGraph-1285"><a href="#StateTransitionGraph-1285"><span class="linenos">1285</span></a><span class="sd">            A dictionary mapping states (nodes) to their initial probabilities at time `t=0`.</span>
</span><span id="StateTransitionGraph-1286"><a href="#StateTransitionGraph-1286"><span class="linenos">1286</span></a><span class="sd">            The keys must match the nodes in the graph, and the values should sum to 1.    </span>
</span><span id="StateTransitionGraph-1287"><a href="#StateTransitionGraph-1287"><span class="linenos">1287</span></a><span class="sd">            </span>
</span><span id="StateTransitionGraph-1288"><a href="#StateTransitionGraph-1288"><span class="linenos">1288</span></a><span class="sd">        - `t` : float</span>
</span><span id="StateTransitionGraph-1289"><a href="#StateTransitionGraph-1289"><span class="linenos">1289</span></a><span class="sd">            The time at which the transient distribution is to be evaluated.</span>
</span><span id="StateTransitionGraph-1290"><a href="#StateTransitionGraph-1290"><span class="linenos">1290</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1291"><a href="#StateTransitionGraph-1291"><span class="linenos">1291</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-1292"><a href="#StateTransitionGraph-1292"><span class="linenos">1292</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-1293"><a href="#StateTransitionGraph-1293"><span class="linenos">1293</span></a><span class="sd">        dict</span>
</span><span id="StateTransitionGraph-1294"><a href="#StateTransitionGraph-1294"><span class="linenos">1294</span></a><span class="sd">            A dictionary mapping each state (node) to its probability at time `t`.</span>
</span><span id="StateTransitionGraph-1295"><a href="#StateTransitionGraph-1295"><span class="linenos">1295</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1296"><a href="#StateTransitionGraph-1296"><span class="linenos">1296</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-1297"><a href="#StateTransitionGraph-1297"><span class="linenos">1297</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-1298"><a href="#StateTransitionGraph-1298"><span class="linenos">1298</span></a><span class="sd">        - The rate matrix `Q` is generated automatically if not yet computed.</span>
</span><span id="StateTransitionGraph-1299"><a href="#StateTransitionGraph-1299"><span class="linenos">1299</span></a><span class="sd">        - The state order in the rate matrix corresponds to the internal `_n2i` mapping.</span>
</span><span id="StateTransitionGraph-1300"><a href="#StateTransitionGraph-1300"><span class="linenos">1300</span></a><span class="sd">        - Internally, the dictionary `initialDistribution` is converted into a vector</span>
</span><span id="StateTransitionGraph-1301"><a href="#StateTransitionGraph-1301"><span class="linenos">1301</span></a><span class="sd">          aligned with the state indexing.</span>
</span><span id="StateTransitionGraph-1302"><a href="#StateTransitionGraph-1302"><span class="linenos">1302</span></a><span class="sd">        - The transient solution is computed using `scipy.linalg.expm` for matrix exponentiation.</span>
</span><span id="StateTransitionGraph-1303"><a href="#StateTransitionGraph-1303"><span class="linenos">1303</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1304"><a href="#StateTransitionGraph-1304"><span class="linenos">1304</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph-1305"><a href="#StateTransitionGraph-1305"><span class="linenos">1305</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph-1306"><a href="#StateTransitionGraph-1306"><span class="linenos">1306</span></a><span class="sd">        ValueError</span>
</span><span id="StateTransitionGraph-1307"><a href="#StateTransitionGraph-1307"><span class="linenos">1307</span></a><span class="sd">            If the input dictionary has missing states or probabilities that do not sum to 1.</span>
</span><span id="StateTransitionGraph-1308"><a href="#StateTransitionGraph-1308"><span class="linenos">1308</span></a><span class="sd">            (This is not enforced but recommended for correctness.)</span>
</span><span id="StateTransitionGraph-1309"><a href="#StateTransitionGraph-1309"><span class="linenos">1309</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph-1310"><a href="#StateTransitionGraph-1310"><span class="linenos">1310</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">createRateMatrix</span><span class="p">()</span>
</span><span id="StateTransitionGraph-1311"><a href="#StateTransitionGraph-1311"><span class="linenos">1311</span></a>        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span>
</span><span id="StateTransitionGraph-1312"><a href="#StateTransitionGraph-1312"><span class="linenos">1312</span></a>        <span class="n">X0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initialDistribution</span><span class="p">))</span>
</span><span id="StateTransitionGraph-1313"><a href="#StateTransitionGraph-1313"><span class="linenos">1313</span></a>        
</span><span id="StateTransitionGraph-1314"><a href="#StateTransitionGraph-1314"><span class="linenos">1314</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1315"><a href="#StateTransitionGraph-1315"><span class="linenos">1315</span></a>            <span class="n">X0</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">]</span> <span class="o">=</span> <span class="n">initialDistribution</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</span><span id="StateTransitionGraph-1316"><a href="#StateTransitionGraph-1316"><span class="linenos">1316</span></a>                
</span><span id="StateTransitionGraph-1317"><a href="#StateTransitionGraph-1317"><span class="linenos">1317</span></a>        
</span><span id="StateTransitionGraph-1318"><a href="#StateTransitionGraph-1318"><span class="linenos">1318</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">X0</span> <span class="o">@</span> <span class="n">expm</span><span class="p">(</span><span class="n">Q</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>    
</span><span id="StateTransitionGraph-1319"><a href="#StateTransitionGraph-1319"><span class="linenos">1319</span></a>        
</span><span id="StateTransitionGraph-1320"><a href="#StateTransitionGraph-1320"><span class="linenos">1320</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph-1321"><a href="#StateTransitionGraph-1321"><span class="linenos">1321</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1322"><a href="#StateTransitionGraph-1322"><span class="linenos">1322</span></a>            <span class="n">matrix</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">]</span>
</span><span id="StateTransitionGraph-1323"><a href="#StateTransitionGraph-1323"><span class="linenos">1323</span></a>                
</span><span id="StateTransitionGraph-1324"><a href="#StateTransitionGraph-1324"><span class="linenos">1324</span></a>        <span class="k">return</span> <span class="n">matrix</span>
</span><span id="StateTransitionGraph-1325"><a href="#StateTransitionGraph-1325"><span class="linenos">1325</span></a>        
</span><span id="StateTransitionGraph-1326"><a href="#StateTransitionGraph-1326"><span class="linenos">1326</span></a>    <span class="k">def</span> <span class="nf">symSolveMarkovModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1327"><a href="#StateTransitionGraph-1327"><span class="linenos">1327</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1328"><a href="#StateTransitionGraph-1328"><span class="linenos">1328</span></a><span class="sd">        Symbolically solve the global balance equations of the CTMC.</span>
</span><span id="StateTransitionGraph-1329"><a href="#StateTransitionGraph-1329"><span class="linenos">1329</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1330"><a href="#StateTransitionGraph-1330"><span class="linenos">1330</span></a><span class="sd">        This method constructs and solves the system of symbolic equations for the</span>
</span><span id="StateTransitionGraph-1331"><a href="#StateTransitionGraph-1331"><span class="linenos">1331</span></a><span class="sd">        steady-state probabilities of each state in the CTMC. It uses symbolic transition</span>
</span><span id="StateTransitionGraph-1332"><a href="#StateTransitionGraph-1332"><span class="linenos">1332</span></a><span class="sd">        rates stored on the edges to form balance equations for each node, along with</span>
</span><span id="StateTransitionGraph-1333"><a href="#StateTransitionGraph-1333"><span class="linenos">1333</span></a><span class="sd">        the normalization constraint that all probabilities sum to 1.</span>
</span><span id="StateTransitionGraph-1334"><a href="#StateTransitionGraph-1334"><span class="linenos">1334</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1335"><a href="#StateTransitionGraph-1335"><span class="linenos">1335</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph-1336"><a href="#StateTransitionGraph-1336"><span class="linenos">1336</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph-1337"><a href="#StateTransitionGraph-1337"><span class="linenos">1337</span></a><span class="sd">        solution : dict</span>
</span><span id="StateTransitionGraph-1338"><a href="#StateTransitionGraph-1338"><span class="linenos">1338</span></a><span class="sd">            A symbolic solution dictionary mapping SymPy symbols (e.g., x_{A}) to</span>
</span><span id="StateTransitionGraph-1339"><a href="#StateTransitionGraph-1339"><span class="linenos">1339</span></a><span class="sd">            expressions in terms of model parameters.</span>
</span><span id="StateTransitionGraph-1340"><a href="#StateTransitionGraph-1340"><span class="linenos">1340</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1341"><a href="#StateTransitionGraph-1341"><span class="linenos">1341</span></a><span class="sd">        num_solution : dict</span>
</span><span id="StateTransitionGraph-1342"><a href="#StateTransitionGraph-1342"><span class="linenos">1342</span></a><span class="sd">            A numerical dictionary mapping each state (node) to its steady-state probability,</span>
</span><span id="StateTransitionGraph-1343"><a href="#StateTransitionGraph-1343"><span class="linenos">1343</span></a><span class="sd">            computed by substituting the numeric values from `self._subs` into the symbolic solution.</span>
</span><span id="StateTransitionGraph-1344"><a href="#StateTransitionGraph-1344"><span class="linenos">1344</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1345"><a href="#StateTransitionGraph-1345"><span class="linenos">1345</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph-1346"><a href="#StateTransitionGraph-1346"><span class="linenos">1346</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph-1347"><a href="#StateTransitionGraph-1347"><span class="linenos">1347</span></a><span class="sd">        - For each node `s`, a symbolic variable `x_{label}` is created using the node&#39;s label attribute.</span>
</span><span id="StateTransitionGraph-1348"><a href="#StateTransitionGraph-1348"><span class="linenos">1348</span></a><span class="sd">        - One balance equation is created per state: total inflow = total outflow.</span>
</span><span id="StateTransitionGraph-1349"><a href="#StateTransitionGraph-1349"><span class="linenos">1349</span></a><span class="sd">        - An additional constraint `sum(x_i) = 1` ensures proper normalization.</span>
</span><span id="StateTransitionGraph-1350"><a href="#StateTransitionGraph-1350"><span class="linenos">1350</span></a><span class="sd">        - The symbolic system is solved with `sympy.solve`, and the results are simplified.</span>
</span><span id="StateTransitionGraph-1351"><a href="#StateTransitionGraph-1351"><span class="linenos">1351</span></a><span class="sd">        - Numeric values are computed by substituting known parameter values (`self._subs`) into the symbolic solution.</span>
</span><span id="StateTransitionGraph-1352"><a href="#StateTransitionGraph-1352"><span class="linenos">1352</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph-1353"><a href="#StateTransitionGraph-1353"><span class="linenos">1353</span></a><span class="sd">        Examples</span>
</span><span id="StateTransitionGraph-1354"><a href="#StateTransitionGraph-1354"><span class="linenos">1354</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph-1355"><a href="#StateTransitionGraph-1355"><span class="linenos">1355</span></a><span class="sd">        &gt;&gt;&gt; sym_sol, num_sol = G.symSolveMarkovModel()</span>
</span><span id="StateTransitionGraph-1356"><a href="#StateTransitionGraph-1356"><span class="linenos">1356</span></a><span class="sd">        &gt;&gt;&gt; sym_sol  # symbolic expressions for each state</span>
</span><span id="StateTransitionGraph-1357"><a href="#StateTransitionGraph-1357"><span class="linenos">1357</span></a><span class="sd">        &gt;&gt;&gt; num_sol  # evaluated numerical values for each state</span>
</span><span id="StateTransitionGraph-1358"><a href="#StateTransitionGraph-1358"><span class="linenos">1358</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph-1359"><a href="#StateTransitionGraph-1359"><span class="linenos">1359</span></a>        <span class="n">X</span><span class="o">=</span><span class="p">{}</span>
</span><span id="StateTransitionGraph-1360"><a href="#StateTransitionGraph-1360"><span class="linenos">1360</span></a>        <span class="n">to_solve</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StateTransitionGraph-1361"><a href="#StateTransitionGraph-1361"><span class="linenos">1361</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
</span><span id="StateTransitionGraph-1362"><a href="#StateTransitionGraph-1362"><span class="linenos">1362</span></a>            <span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x_</span><span class="se">{{</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1363"><a href="#StateTransitionGraph-1363"><span class="linenos">1363</span></a>            <span class="n">to_solve</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
</span><span id="StateTransitionGraph-1364"><a href="#StateTransitionGraph-1364"><span class="linenos">1364</span></a>        <span class="c1">#%</span>
</span><span id="StateTransitionGraph-1365"><a href="#StateTransitionGraph-1365"><span class="linenos">1365</span></a>        <span class="n">eqs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StateTransitionGraph-1366"><a href="#StateTransitionGraph-1366"><span class="linenos">1366</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
</span><span id="StateTransitionGraph-1367"><a href="#StateTransitionGraph-1367"><span class="linenos">1367</span></a>             <span class="n">succ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="c1"># raus</span>
</span><span id="StateTransitionGraph-1368"><a href="#StateTransitionGraph-1368"><span class="linenos">1368</span></a>             <span class="n">out_rate</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StateTransitionGraph-1369"><a href="#StateTransitionGraph-1369"><span class="linenos">1369</span></a>             <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">succ</span><span class="p">):</span>
</span><span id="StateTransitionGraph-1370"><a href="#StateTransitionGraph-1370"><span class="linenos">1370</span></a>                 <span class="c1">#out_rate += X[s]*self.edges[s, z][&quot;sym_rate&quot;]                 </span>
</span><span id="StateTransitionGraph-1371"><a href="#StateTransitionGraph-1371"><span class="linenos">1371</span></a>                 <span class="n">out_rate</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">z</span><span class="p">][</span><span class="s2">&quot;sym_rate&quot;</span><span class="p">]</span>
</span><span id="StateTransitionGraph-1372"><a href="#StateTransitionGraph-1372"><span class="linenos">1372</span></a>             
</span><span id="StateTransitionGraph-1373"><a href="#StateTransitionGraph-1373"><span class="linenos">1373</span></a>             <span class="n">in_rate</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StateTransitionGraph-1374"><a href="#StateTransitionGraph-1374"><span class="linenos">1374</span></a>             <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
</span><span id="StateTransitionGraph-1375"><a href="#StateTransitionGraph-1375"><span class="linenos">1375</span></a>                 <span class="c1">#in_rate += X[r]*self.edges[r,s][&quot;sym_rate&quot;] </span>
</span><span id="StateTransitionGraph-1376"><a href="#StateTransitionGraph-1376"><span class="linenos">1376</span></a>                 <span class="n">in_rate</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s</span><span class="p">][</span><span class="s2">&quot;sym_rate&quot;</span><span class="p">]</span> 
</span><span id="StateTransitionGraph-1377"><a href="#StateTransitionGraph-1377"><span class="linenos">1377</span></a>             <span class="n">eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">out_rate</span><span class="p">,</span> <span class="n">in_rate</span><span class="p">)</span> <span class="p">)</span>
</span><span id="StateTransitionGraph-1378"><a href="#StateTransitionGraph-1378"><span class="linenos">1378</span></a>        <span class="c1">#% </span>
</span><span id="StateTransitionGraph-1379"><a href="#StateTransitionGraph-1379"><span class="linenos">1379</span></a>        <span class="n">Xsum</span> <span class="o">=</span> <span class="mi">0</span>    
</span><span id="StateTransitionGraph-1380"><a href="#StateTransitionGraph-1380"><span class="linenos">1380</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
</span><span id="StateTransitionGraph-1381"><a href="#StateTransitionGraph-1381"><span class="linenos">1381</span></a>            <span class="n">Xsum</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
</span><span id="StateTransitionGraph-1382"><a href="#StateTransitionGraph-1382"><span class="linenos">1382</span></a>        
</span><span id="StateTransitionGraph-1383"><a href="#StateTransitionGraph-1383"><span class="linenos">1383</span></a>        <span class="n">eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">Xsum</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span>    
</span><span id="StateTransitionGraph-1384"><a href="#StateTransitionGraph-1384"><span class="linenos">1384</span></a>        <span class="c1">#%</span>
</span><span id="StateTransitionGraph-1385"><a href="#StateTransitionGraph-1385"><span class="linenos">1385</span></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,</span> <span class="n">to_solve</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1386"><a href="#StateTransitionGraph-1386"><span class="linenos">1386</span></a>        <span class="n">simplified_solution</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1387"><a href="#StateTransitionGraph-1387"><span class="linenos">1387</span></a>        <span class="c1">#print(simplified_solution)</span>
</span><span id="StateTransitionGraph-1388"><a href="#StateTransitionGraph-1388"><span class="linenos">1388</span></a>        <span class="n">num_solution</span> <span class="o">=</span> <span class="n">simplified_solution</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subs</span><span class="p">)</span>
</span><span id="StateTransitionGraph-1389"><a href="#StateTransitionGraph-1389"><span class="linenos">1389</span></a>        <span class="c1">#num_dict =  {str(var): str(sol) for var, sol in simplified_solution.items()}</span>
</span><span id="StateTransitionGraph-1390"><a href="#StateTransitionGraph-1390"><span class="linenos">1390</span></a>        <span class="n">num_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">num_solution</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">X</span><span class="p">}</span>                
</span><span id="StateTransitionGraph-1391"><a href="#StateTransitionGraph-1391"><span class="linenos">1391</span></a>        
</span><span id="StateTransitionGraph-1392"><a href="#StateTransitionGraph-1392"><span class="linenos">1392</span></a>        <span class="k">return</span> <span class="n">simplified_solution</span><span class="p">,</span> <span class="n">num_dict</span> 
</span></pre></div>


            <div class="docstring"><p>Initialize the StateTransitionGraph for continuous time Markov chains (CTMC). 
Extends the networkx.Graph class to include additional methods and properties 
for the analysis, visualization, and simulation of CTMCs. 
The analysis allows deriving the state probabilities in the steady-state 
and in the transient phase.</p>

<p>This constructor sets up symbolic and numeric parameters for the state transition graph,
imports a constants module dynamically, and initializes internal data structures for
rate matrix computation and steady-state probability analysis.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><p><code><a href="#StateTransitionGraph.parameters">parameters</a></code> : dict<br />
A dictionary mapping parameter names to their numerical values.<br />
  Example: {'lambda': 1.0, 'mu': 1.0}. 
  For each parameter key:</p>

<ul>
<li>A symbolic variable is created using sympy.symbols. Can be accessed as <code>G.sym("key")</code> or <code>G.sym_key</code></li>
<li>A variable is created which can be accessed via <code>G.key</code> (and the numerical value is assigned)</li>
<li><p>For the key="lambda", <code>G.lam</code> and <code>G.sym_lambda</code> are created</p>

<p>The parameters can be accessed via property <code><a href="#StateTransitionGraph.parameters">parameters</a></code></p></li>
</ul></li>
<li><code>constants</code> : str, optional
The name of a Python module (as string) to import dynamically and assign to <code>self.const</code>.
This can be used to store global or user-defined constants.
Default is "Constants".</li>
<li><code>*args</code> : tuple
Additional positional arguments passed to the base <code>networkx.DiGraph</code> constructor.</li>
<li><code>**kwargs</code> : dict
Additional keyword arguments passed to the base <code>networkx.DiGraph</code> constructor.</li>
</ul>

<h2 id="attributes">Attributes</h2>

<ul>
<li><code>_rate_matrix</code> : ndarray or None<br />
The continuous-time rate matrix <code>Q</code> of the CTMC. Computed when calling <code><a href="#StateTransitionGraph.createRateMatrix">createRateMatrix()</a></code>.</li>
<li><code>_state_probabilities</code> : dict or None<br />
Dictionary of steady-state probabilities, computed via <code><a href="#StateTransitionGraph.calcSteadyStateProbs">calcSteadyStateProbs()</a></code>.</li>
<li><code>_n2i</code> : dict or None<br />
Mapping from node identifiers to matrix row/column indices used for rate matrix construction.</li>
<li><code>_sym</code> : dict<br />
Mapping of parameter names (strings) to their symbolic <code>sympy</code> representations.</li>
<li><code>_subs</code> : dict<br />
Mapping from symbolic parameters to their numerical values (used for substitutions).</li>
<li><code>_parameters</code> : dict<br />
Copy of the original parameter dictionary passed at initialization.</li>
<li><code>_transitionProbabilitesComputed</code> : bool<br />
Internal flag indicating whether transition probabilities for the embedded Markov chain
have been computed.</li>
<li><code>const</code> : module<br />
Dynamically imported module (default <code>"Constants"</code>), used for storing user-defined constants 
such as colors or transition IDs.</li>
</ul>

<h2 id="inherits">Inherits</h2>

<pre><code>networkx.Graph: The base graph class from NetworkX.
</code></pre>
</div>


                            <div id="StateTransitionGraph.__init__" class="classattr">
                                        <input id="StateTransitionGraph.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">StateTransitionGraph</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parameters</span>, </span><span class="param"><span class="n">constants</span><span class="o">=</span><span class="s1">&#39;Constants&#39;</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="StateTransitionGraph.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.__init__-148"><a href="#StateTransitionGraph.__init__-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">constants</span><span class="o">=</span><span class="s2">&quot;Constants&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="StateTransitionGraph.__init__-149"><a href="#StateTransitionGraph.__init__-149"><span class="linenos">149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.__init__-150"><a href="#StateTransitionGraph.__init__-150"><span class="linenos">150</span></a><span class="sd">        Initialize the state transition graph with symbolic parameters.</span>
</span><span id="StateTransitionGraph.__init__-151"><a href="#StateTransitionGraph.__init__-151"><span class="linenos">151</span></a>
</span><span id="StateTransitionGraph.__init__-152"><a href="#StateTransitionGraph.__init__-152"><span class="linenos">152</span></a><span class="sd">        This constructor sets up the symbolic and numerical environment for modeling</span>
</span><span id="StateTransitionGraph.__init__-153"><a href="#StateTransitionGraph.__init__-153"><span class="linenos">153</span></a><span class="sd">        a CTMC. Parameters are stored as both symbolic expressions and numerical values,</span>
</span><span id="StateTransitionGraph.__init__-154"><a href="#StateTransitionGraph.__init__-154"><span class="linenos">154</span></a><span class="sd">        and convenient attribute access is provided for both forms.</span>
</span><span id="StateTransitionGraph.__init__-155"><a href="#StateTransitionGraph.__init__-155"><span class="linenos">155</span></a>
</span><span id="StateTransitionGraph.__init__-156"><a href="#StateTransitionGraph.__init__-156"><span class="linenos">156</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.__init__-157"><a href="#StateTransitionGraph.__init__-157"><span class="linenos">157</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.__init__-158"><a href="#StateTransitionGraph.__init__-158"><span class="linenos">158</span></a><span class="sd">        - `parameters` : dict  </span>
</span><span id="StateTransitionGraph.__init__-159"><a href="#StateTransitionGraph.__init__-159"><span class="linenos">159</span></a><span class="sd">          A dictionary mapping parameter names to their numerical values.     </span>
</span><span id="StateTransitionGraph.__init__-160"><a href="#StateTransitionGraph.__init__-160"><span class="linenos">160</span></a><span class="sd">            Example: {&#39;lambda&#39;: 1.0, &#39;mu&#39;: 1.0}. </span>
</span><span id="StateTransitionGraph.__init__-161"><a href="#StateTransitionGraph.__init__-161"><span class="linenos">161</span></a><span class="sd">            For each parameter key:</span>
</span><span id="StateTransitionGraph.__init__-162"><a href="#StateTransitionGraph.__init__-162"><span class="linenos">162</span></a><span class="sd">            - A symbolic variable is created using sympy.symbols. Can be accessed as `G.sym(&quot;key&quot;)` or `G.sym_key`</span>
</span><span id="StateTransitionGraph.__init__-163"><a href="#StateTransitionGraph.__init__-163"><span class="linenos">163</span></a><span class="sd">            - A variable is created which can be accessed via `G.key` (and the numerical value is assigned)</span>
</span><span id="StateTransitionGraph.__init__-164"><a href="#StateTransitionGraph.__init__-164"><span class="linenos">164</span></a><span class="sd">            - For the key=&quot;lambda&quot;, `G.lam` and `G.sym_lambda` are created</span>
</span><span id="StateTransitionGraph.__init__-165"><a href="#StateTransitionGraph.__init__-165"><span class="linenos">165</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph.__init__-166"><a href="#StateTransitionGraph.__init__-166"><span class="linenos">166</span></a><span class="sd">            The parameters can be accessed via property `parameters`</span>
</span><span id="StateTransitionGraph.__init__-167"><a href="#StateTransitionGraph.__init__-167"><span class="linenos">167</span></a><span class="sd">        - `constants` : str, optional</span>
</span><span id="StateTransitionGraph.__init__-168"><a href="#StateTransitionGraph.__init__-168"><span class="linenos">168</span></a><span class="sd">            The name of a Python module (as string) to import dynamically and assign to `self.const`.</span>
</span><span id="StateTransitionGraph.__init__-169"><a href="#StateTransitionGraph.__init__-169"><span class="linenos">169</span></a><span class="sd">            This can be used to store global or user-defined constants.</span>
</span><span id="StateTransitionGraph.__init__-170"><a href="#StateTransitionGraph.__init__-170"><span class="linenos">170</span></a><span class="sd">            Default is &quot;Constants&quot;.</span>
</span><span id="StateTransitionGraph.__init__-171"><a href="#StateTransitionGraph.__init__-171"><span class="linenos">171</span></a><span class="sd">        - `*args` : tuple</span>
</span><span id="StateTransitionGraph.__init__-172"><a href="#StateTransitionGraph.__init__-172"><span class="linenos">172</span></a><span class="sd">            Additional positional arguments passed to the base `networkx.DiGraph` constructor.</span>
</span><span id="StateTransitionGraph.__init__-173"><a href="#StateTransitionGraph.__init__-173"><span class="linenos">173</span></a><span class="sd">        - `**kwargs` : dict</span>
</span><span id="StateTransitionGraph.__init__-174"><a href="#StateTransitionGraph.__init__-174"><span class="linenos">174</span></a><span class="sd">            Additional keyword arguments passed to the base `networkx.DiGraph` constructor.</span>
</span><span id="StateTransitionGraph.__init__-175"><a href="#StateTransitionGraph.__init__-175"><span class="linenos">175</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph.__init__-176"><a href="#StateTransitionGraph.__init__-176"><span class="linenos">176</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="StateTransitionGraph.__init__-177"><a href="#StateTransitionGraph.__init__-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Rate Matrix Q of this transition graph</span>
</span><span id="StateTransitionGraph.__init__-178"><a href="#StateTransitionGraph.__init__-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state_probabilities</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># steady state proabilities of this CTMC</span>
</span><span id="StateTransitionGraph.__init__-179"><a href="#StateTransitionGraph.__init__-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># internal index for generating the rate matrix Q: dictionary (node to index)</span>
</span><span id="StateTransitionGraph.__init__-180"><a href="#StateTransitionGraph.__init__-180"><span class="linenos">180</span></a>        
</span><span id="StateTransitionGraph.__init__-181"><a href="#StateTransitionGraph.__init__-181"><span class="linenos">181</span></a>        <span class="c1">#parameters = {&#39;lambda&#39;: 1.0, &#39;mu&#39;:1.0, &#39;n&#39;:5}</span>
</span><span id="StateTransitionGraph.__init__-182"><a href="#StateTransitionGraph.__init__-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="StateTransitionGraph.__init__-183"><a href="#StateTransitionGraph.__init__-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">}</span>
</span><span id="StateTransitionGraph.__init__-184"><a href="#StateTransitionGraph.__init__-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_subs</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># contains symbolic parameter as key and provides numerical value for computation.</span>
</span><span id="StateTransitionGraph.__init__-185"><a href="#StateTransitionGraph.__init__-185"><span class="linenos">185</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
</span><span id="StateTransitionGraph.__init__-186"><a href="#StateTransitionGraph.__init__-186"><span class="linenos">186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_subs</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">]</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> 
</span><span id="StateTransitionGraph.__init__-187"><a href="#StateTransitionGraph.__init__-187"><span class="linenos">187</span></a>
</span><span id="StateTransitionGraph.__init__-188"><a href="#StateTransitionGraph.__init__-188"><span class="linenos">188</span></a>        <span class="c1"># access to parameters and symbols using dot-notation, e.g. G.lam, G.sym_lambda, or G.sym(&quot;lambda&quot;)</span>
</span><span id="StateTransitionGraph.__init__-189"><a href="#StateTransitionGraph.__init__-189"><span class="linenos">189</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StateTransitionGraph.__init__-190"><a href="#StateTransitionGraph.__init__-190"><span class="linenos">190</span></a>            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s1">&#39;lambda&#39;</span><span class="p">:</span>
</span><span id="StateTransitionGraph.__init__-191"><a href="#StateTransitionGraph.__init__-191"><span class="linenos">191</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;lam&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="StateTransitionGraph.__init__-192"><a href="#StateTransitionGraph.__init__-192"><span class="linenos">192</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph.__init__-193"><a href="#StateTransitionGraph.__init__-193"><span class="linenos">193</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="StateTransitionGraph.__init__-194"><a href="#StateTransitionGraph.__init__-194"><span class="linenos">194</span></a>            
</span><span id="StateTransitionGraph.__init__-195"><a href="#StateTransitionGraph.__init__-195"><span class="linenos">195</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;sym_&quot;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="StateTransitionGraph.__init__-196"><a href="#StateTransitionGraph.__init__-196"><span class="linenos">196</span></a>            
</span><span id="StateTransitionGraph.__init__-197"><a href="#StateTransitionGraph.__init__-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transitionProbabilitesComputed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="StateTransitionGraph.__init__-198"><a href="#StateTransitionGraph.__init__-198"><span class="linenos">198</span></a>        
</span><span id="StateTransitionGraph.__init__-199"><a href="#StateTransitionGraph.__init__-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_const</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">constants</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the state transition graph with symbolic parameters.</p>

<p>This constructor sets up the symbolic and numerical environment for modeling
a CTMC. Parameters are stored as both symbolic expressions and numerical values,
and convenient attribute access is provided for both forms.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><p><code><a href="#StateTransitionGraph.parameters">parameters</a></code> : dict<br />
A dictionary mapping parameter names to their numerical values.<br />
  Example: {'lambda': 1.0, 'mu': 1.0}. 
  For each parameter key:</p>

<ul>
<li>A symbolic variable is created using sympy.symbols. Can be accessed as <code>G.sym("key")</code> or <code>G.sym_key</code></li>
<li>A variable is created which can be accessed via <code>G.key</code> (and the numerical value is assigned)</li>
<li><p>For the key="lambda", <code>G.lam</code> and <code>G.sym_lambda</code> are created</p>

<p>The parameters can be accessed via property <code><a href="#StateTransitionGraph.parameters">parameters</a></code></p></li>
</ul></li>
<li><code>constants</code> : str, optional
The name of a Python module (as string) to import dynamically and assign to <code>self.const</code>.
This can be used to store global or user-defined constants.
Default is "Constants".</li>
<li><code>*args</code> : tuple
Additional positional arguments passed to the base <code>networkx.DiGraph</code> constructor.</li>
<li><code>**kwargs</code> : dict
Additional keyword arguments passed to the base <code>networkx.DiGraph</code> constructor.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.addState" class="classattr">
                                        <input id="StateTransitionGraph.addState-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">addState</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">state</span>, </span><span class="param"><span class="n">color</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">label</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.addState-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.addState"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.addState-203"><a href="#StateTransitionGraph.addState-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">addState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="StateTransitionGraph.addState-204"><a href="#StateTransitionGraph.addState-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.addState-205"><a href="#StateTransitionGraph.addState-205"><span class="linenos">205</span></a><span class="sd">        Add a state (node) to the graph with optional color and label attributes.</span>
</span><span id="StateTransitionGraph.addState-206"><a href="#StateTransitionGraph.addState-206"><span class="linenos">206</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addState-207"><a href="#StateTransitionGraph.addState-207"><span class="linenos">207</span></a><span class="sd">        If the node already exists, its attributes are updated with the provided values.</span>
</span><span id="StateTransitionGraph.addState-208"><a href="#StateTransitionGraph.addState-208"><span class="linenos">208</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addState-209"><a href="#StateTransitionGraph.addState-209"><span class="linenos">209</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.addState-210"><a href="#StateTransitionGraph.addState-210"><span class="linenos">210</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.addState-211"><a href="#StateTransitionGraph.addState-211"><span class="linenos">211</span></a><span class="sd">        - state : hashable</span>
</span><span id="StateTransitionGraph.addState-212"><a href="#StateTransitionGraph.addState-212"><span class="linenos">212</span></a><span class="sd">            The identifier for the state. Can be a string, int, or a tuple. If no label</span>
</span><span id="StateTransitionGraph.addState-213"><a href="#StateTransitionGraph.addState-213"><span class="linenos">213</span></a><span class="sd">            is provided, the label will be auto-generated as:</span>
</span><span id="StateTransitionGraph.addState-214"><a href="#StateTransitionGraph.addState-214"><span class="linenos">214</span></a><span class="sd">            - comma-separated string for tuples (e.g., `(1, 2)` -&gt; `&#39;1,2&#39;`)</span>
</span><span id="StateTransitionGraph.addState-215"><a href="#StateTransitionGraph.addState-215"><span class="linenos">215</span></a><span class="sd">            - stringified value for other types</span>
</span><span id="StateTransitionGraph.addState-216"><a href="#StateTransitionGraph.addState-216"><span class="linenos">216</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addState-217"><a href="#StateTransitionGraph.addState-217"><span class="linenos">217</span></a><span class="sd">        - color : str, optional</span>
</span><span id="StateTransitionGraph.addState-218"><a href="#StateTransitionGraph.addState-218"><span class="linenos">218</span></a><span class="sd">            The color assigned to the state (used for visualization).</span>
</span><span id="StateTransitionGraph.addState-219"><a href="#StateTransitionGraph.addState-219"><span class="linenos">219</span></a><span class="sd">            If not specified, defaults to `self.const.COLOR_NODE_DEFAULT`.</span>
</span><span id="StateTransitionGraph.addState-220"><a href="#StateTransitionGraph.addState-220"><span class="linenos">220</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addState-221"><a href="#StateTransitionGraph.addState-221"><span class="linenos">221</span></a><span class="sd">        - label : str, optional</span>
</span><span id="StateTransitionGraph.addState-222"><a href="#StateTransitionGraph.addState-222"><span class="linenos">222</span></a><span class="sd">            A label for the node (used for display or annotation). If not provided,</span>
</span><span id="StateTransitionGraph.addState-223"><a href="#StateTransitionGraph.addState-223"><span class="linenos">223</span></a><span class="sd">            it will be auto-generated from the state identifier.</span>
</span><span id="StateTransitionGraph.addState-224"><a href="#StateTransitionGraph.addState-224"><span class="linenos">224</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addState-225"><a href="#StateTransitionGraph.addState-225"><span class="linenos">225</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.addState-226"><a href="#StateTransitionGraph.addState-226"><span class="linenos">226</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.addState-227"><a href="#StateTransitionGraph.addState-227"><span class="linenos">227</span></a><span class="sd">        - This method wraps `self.add_node()` from NetworkX.</span>
</span><span id="StateTransitionGraph.addState-228"><a href="#StateTransitionGraph.addState-228"><span class="linenos">228</span></a><span class="sd">        - If the node already exists in the graph, this method does not raise an error;</span>
</span><span id="StateTransitionGraph.addState-229"><a href="#StateTransitionGraph.addState-229"><span class="linenos">229</span></a><span class="sd">          it will update the node’s existing attributes.</span>
</span><span id="StateTransitionGraph.addState-230"><a href="#StateTransitionGraph.addState-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.addState-231"><a href="#StateTransitionGraph.addState-231"><span class="linenos">231</span></a>        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph.addState-232"><a href="#StateTransitionGraph.addState-232"><span class="linenos">232</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="StateTransitionGraph.addState-233"><a href="#StateTransitionGraph.addState-233"><span class="linenos">233</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">state</span><span class="p">))</span> <span class="c1"># if state is a tuple</span>
</span><span id="StateTransitionGraph.addState-234"><a href="#StateTransitionGraph.addState-234"><span class="linenos">234</span></a>            <span class="k">else</span><span class="p">:</span> 
</span><span id="StateTransitionGraph.addState-235"><a href="#StateTransitionGraph.addState-235"><span class="linenos">235</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="StateTransitionGraph.addState-236"><a href="#StateTransitionGraph.addState-236"><span class="linenos">236</span></a>            <span class="c1">#self.nodes[state][&quot;label&quot;] = label</span>
</span><span id="StateTransitionGraph.addState-237"><a href="#StateTransitionGraph.addState-237"><span class="linenos">237</span></a>        
</span><span id="StateTransitionGraph.addState-238"><a href="#StateTransitionGraph.addState-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph.addState-239"><a href="#StateTransitionGraph.addState-239"><span class="linenos">239</span></a>            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_NODE_DEFAULT</span>
</span><span id="StateTransitionGraph.addState-240"><a href="#StateTransitionGraph.addState-240"><span class="linenos">240</span></a>        
</span><span id="StateTransitionGraph.addState-241"><a href="#StateTransitionGraph.addState-241"><span class="linenos">241</span></a>        <span class="c1"># no error if the node already exists.Attributes get updated if you pass them again.</span>
</span><span id="StateTransitionGraph.addState-242"><a href="#StateTransitionGraph.addState-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add a state (node) to the graph with optional color and label attributes.</p>

<p>If the node already exists, its attributes are updated with the provided values.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><p>state : hashable
The identifier for the state. Can be a string, int, or a tuple. If no label
is provided, the label will be auto-generated as:</p>

<ul>
<li>comma-separated string for tuples (e.g., <code>(1, 2)</code> -> <code>'1,2'</code>)</li>
<li>stringified value for other types</li>
</ul></li>
<li><p>color : str, optional
The color assigned to the state (used for visualization).
If not specified, defaults to <code>self.const.COLOR_NODE_DEFAULT</code>.</p></li>
<li><p>label : str, optional
A label for the node (used for display or annotation). If not provided,
it will be auto-generated from the state identifier.</p></li>
</ul>

<h2 id="notes">Notes</h2>

<ul>
<li>This method wraps <code>self.add_node()</code> from NetworkX.</li>
<li>If the node already exists in the graph, this method does not raise an error;
it will update the node’s existing attributes.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.setStateProperties" class="classattr">
                                        <input id="StateTransitionGraph.setStateProperties-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setStateProperties</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">state</span>, </span><span class="param"><span class="n">color</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">label</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.setStateProperties-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.setStateProperties"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.setStateProperties-244"><a href="#StateTransitionGraph.setStateProperties-244"><span class="linenos">244</span></a>    <span class="k">def</span> <span class="nf">setStateProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="StateTransitionGraph.setStateProperties-245"><a href="#StateTransitionGraph.setStateProperties-245"><span class="linenos">245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.setStateProperties-246"><a href="#StateTransitionGraph.setStateProperties-246"><span class="linenos">246</span></a><span class="sd">        Update visual or metadata properties for an existing state (node) in the graph.</span>
</span><span id="StateTransitionGraph.setStateProperties-247"><a href="#StateTransitionGraph.setStateProperties-247"><span class="linenos">247</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateProperties-248"><a href="#StateTransitionGraph.setStateProperties-248"><span class="linenos">248</span></a><span class="sd">        This method updates the node&#39;s attributes such as color, label, and any additional</span>
</span><span id="StateTransitionGraph.setStateProperties-249"><a href="#StateTransitionGraph.setStateProperties-249"><span class="linenos">249</span></a><span class="sd">        custom key-value pairs. The node must already exist in the graph.</span>
</span><span id="StateTransitionGraph.setStateProperties-250"><a href="#StateTransitionGraph.setStateProperties-250"><span class="linenos">250</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateProperties-251"><a href="#StateTransitionGraph.setStateProperties-251"><span class="linenos">251</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.setStateProperties-252"><a href="#StateTransitionGraph.setStateProperties-252"><span class="linenos">252</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.setStateProperties-253"><a href="#StateTransitionGraph.setStateProperties-253"><span class="linenos">253</span></a><span class="sd">        - state : hashable</span>
</span><span id="StateTransitionGraph.setStateProperties-254"><a href="#StateTransitionGraph.setStateProperties-254"><span class="linenos">254</span></a><span class="sd">            Identifier of the state to update. Must be a node already present in the graph.</span>
</span><span id="StateTransitionGraph.setStateProperties-255"><a href="#StateTransitionGraph.setStateProperties-255"><span class="linenos">255</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateProperties-256"><a href="#StateTransitionGraph.setStateProperties-256"><span class="linenos">256</span></a><span class="sd">        - color : str, optional</span>
</span><span id="StateTransitionGraph.setStateProperties-257"><a href="#StateTransitionGraph.setStateProperties-257"><span class="linenos">257</span></a><span class="sd">            Color assigned to the node, typically used for visualization. If not provided,</span>
</span><span id="StateTransitionGraph.setStateProperties-258"><a href="#StateTransitionGraph.setStateProperties-258"><span class="linenos">258</span></a><span class="sd">            the default node color (`self._const.COLOR_NODE_DEFAULT`) is used.</span>
</span><span id="StateTransitionGraph.setStateProperties-259"><a href="#StateTransitionGraph.setStateProperties-259"><span class="linenos">259</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateProperties-260"><a href="#StateTransitionGraph.setStateProperties-260"><span class="linenos">260</span></a><span class="sd">        - label : str, optional</span>
</span><span id="StateTransitionGraph.setStateProperties-261"><a href="#StateTransitionGraph.setStateProperties-261"><span class="linenos">261</span></a><span class="sd">            Label for the node. If not provided, it is auto-generated from the state ID</span>
</span><span id="StateTransitionGraph.setStateProperties-262"><a href="#StateTransitionGraph.setStateProperties-262"><span class="linenos">262</span></a><span class="sd">            (especially for tuples).</span>
</span><span id="StateTransitionGraph.setStateProperties-263"><a href="#StateTransitionGraph.setStateProperties-263"><span class="linenos">263</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateProperties-264"><a href="#StateTransitionGraph.setStateProperties-264"><span class="linenos">264</span></a><span class="sd">        - **kwargs : dict</span>
</span><span id="StateTransitionGraph.setStateProperties-265"><a href="#StateTransitionGraph.setStateProperties-265"><span class="linenos">265</span></a><span class="sd">            Arbitrary additional key-value pairs to set as node attributes. These can include</span>
</span><span id="StateTransitionGraph.setStateProperties-266"><a href="#StateTransitionGraph.setStateProperties-266"><span class="linenos">266</span></a><span class="sd">            any custom metadata.</span>
</span><span id="StateTransitionGraph.setStateProperties-267"><a href="#StateTransitionGraph.setStateProperties-267"><span class="linenos">267</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateProperties-268"><a href="#StateTransitionGraph.setStateProperties-268"><span class="linenos">268</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph.setStateProperties-269"><a href="#StateTransitionGraph.setStateProperties-269"><span class="linenos">269</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph.setStateProperties-270"><a href="#StateTransitionGraph.setStateProperties-270"><span class="linenos">270</span></a><span class="sd">        KeyError</span>
</span><span id="StateTransitionGraph.setStateProperties-271"><a href="#StateTransitionGraph.setStateProperties-271"><span class="linenos">271</span></a><span class="sd">            If the specified state is not present in the graph.</span>
</span><span id="StateTransitionGraph.setStateProperties-272"><a href="#StateTransitionGraph.setStateProperties-272"><span class="linenos">272</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateProperties-273"><a href="#StateTransitionGraph.setStateProperties-273"><span class="linenos">273</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.setStateProperties-274"><a href="#StateTransitionGraph.setStateProperties-274"><span class="linenos">274</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.setStateProperties-275"><a href="#StateTransitionGraph.setStateProperties-275"><span class="linenos">275</span></a><span class="sd">        - This method ensures that required attributes (like `color` and `label`) are set for visualization. </span>
</span><span id="StateTransitionGraph.setStateProperties-276"><a href="#StateTransitionGraph.setStateProperties-276"><span class="linenos">276</span></a><span class="sd">        - Existing node attributes are updated or extended with `kwargs`.</span>
</span><span id="StateTransitionGraph.setStateProperties-277"><a href="#StateTransitionGraph.setStateProperties-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph.setStateProperties-278"><a href="#StateTransitionGraph.setStateProperties-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="n">state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="StateTransitionGraph.setStateProperties-279"><a href="#StateTransitionGraph.setStateProperties-279"><span class="linenos">279</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State &#39;</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&#39; does not exist in the graph.&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.setStateProperties-280"><a href="#StateTransitionGraph.setStateProperties-280"><span class="linenos">280</span></a>        
</span><span id="StateTransitionGraph.setStateProperties-281"><a href="#StateTransitionGraph.setStateProperties-281"><span class="linenos">281</span></a>        <span class="c1"># mandatory for plotting</span>
</span><span id="StateTransitionGraph.setStateProperties-282"><a href="#StateTransitionGraph.setStateProperties-282"><span class="linenos">282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addState</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
</span><span id="StateTransitionGraph.setStateProperties-283"><a href="#StateTransitionGraph.setStateProperties-283"><span class="linenos">283</span></a>        
</span><span id="StateTransitionGraph.setStateProperties-284"><a href="#StateTransitionGraph.setStateProperties-284"><span class="linenos">284</span></a>        <span class="c1"># # Add any additional attributes</span>
</span><span id="StateTransitionGraph.setStateProperties-285"><a href="#StateTransitionGraph.setStateProperties-285"><span class="linenos">285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">state</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Update visual or metadata properties for an existing state (node) in the graph.</p>

<p>This method updates the node's attributes such as color, label, and any additional
custom key-value pairs. The node must already exist in the graph.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><p>state : hashable
Identifier of the state to update. Must be a node already present in the graph.</p></li>
<li><p>color : str, optional
Color assigned to the node, typically used for visualization. If not provided,
the default node color (<code>self._const.COLOR_NODE_DEFAULT</code>) is used.</p></li>
<li><p>label : str, optional
Label for the node. If not provided, it is auto-generated from the state ID
(especially for tuples).</p></li>
<li><p>**kwargs : dict
Arbitrary additional key-value pairs to set as node attributes. These can include
any custom metadata.</p></li>
</ul>

<h2 id="raises">Raises</h2>

<p>KeyError
    If the specified state is not present in the graph.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>This method ensures that required attributes (like <code>color</code> and <code>label</code>) are set for visualization. </li>
<li>Existing node attributes are updated or extended with <code>kwargs</code>.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.setAllStateDefaultProperties" class="classattr">
                                        <input id="StateTransitionGraph.setAllStateDefaultProperties-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setAllStateDefaultProperties</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.setAllStateDefaultProperties-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.setAllStateDefaultProperties"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.setAllStateDefaultProperties-287"><a href="#StateTransitionGraph.setAllStateDefaultProperties-287"><span class="linenos">287</span></a>    <span class="k">def</span> <span class="nf">setAllStateDefaultProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-288"><a href="#StateTransitionGraph.setAllStateDefaultProperties-288"><span class="linenos">288</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-289"><a href="#StateTransitionGraph.setAllStateDefaultProperties-289"><span class="linenos">289</span></a><span class="sd">        Set default visual and metadata properties for all states (nodes) in the graph.</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-290"><a href="#StateTransitionGraph.setAllStateDefaultProperties-290"><span class="linenos">290</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-291"><a href="#StateTransitionGraph.setAllStateDefaultProperties-291"><span class="linenos">291</span></a><span class="sd">        This method applies `setStateProperties()` to every node, ensuring each state</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-292"><a href="#StateTransitionGraph.setAllStateDefaultProperties-292"><span class="linenos">292</span></a><span class="sd">        has at least the required default attributes (e.g., color and label).</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-293"><a href="#StateTransitionGraph.setAllStateDefaultProperties-293"><span class="linenos">293</span></a><span class="sd">        Any additional keyword arguments are passed to `setStateProperties()`.</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-294"><a href="#StateTransitionGraph.setAllStateDefaultProperties-294"><span class="linenos">294</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-295"><a href="#StateTransitionGraph.setAllStateDefaultProperties-295"><span class="linenos">295</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-296"><a href="#StateTransitionGraph.setAllStateDefaultProperties-296"><span class="linenos">296</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-297"><a href="#StateTransitionGraph.setAllStateDefaultProperties-297"><span class="linenos">297</span></a><span class="sd">        **kwargs : dict, optional</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-298"><a href="#StateTransitionGraph.setAllStateDefaultProperties-298"><span class="linenos">298</span></a><span class="sd">            Optional keyword arguments to apply uniformly to all nodes,</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-299"><a href="#StateTransitionGraph.setAllStateDefaultProperties-299"><span class="linenos">299</span></a><span class="sd">            such as color=&#39;gray&#39;, group=&#39;core&#39;, etc.</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-300"><a href="#StateTransitionGraph.setAllStateDefaultProperties-300"><span class="linenos">300</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-301"><a href="#StateTransitionGraph.setAllStateDefaultProperties-301"><span class="linenos">301</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-302"><a href="#StateTransitionGraph.setAllStateDefaultProperties-302"><span class="linenos">302</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-303"><a href="#StateTransitionGraph.setAllStateDefaultProperties-303"><span class="linenos">303</span></a><span class="sd">        - This method is useful for initializing node attributes before plotting</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-304"><a href="#StateTransitionGraph.setAllStateDefaultProperties-304"><span class="linenos">304</span></a><span class="sd">          or performing other graph-based computations.</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-305"><a href="#StateTransitionGraph.setAllStateDefaultProperties-305"><span class="linenos">305</span></a><span class="sd">        - Nodes without existing attributes will receive defaults via `addState()`.</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-306"><a href="#StateTransitionGraph.setAllStateDefaultProperties-306"><span class="linenos">306</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-307"><a href="#StateTransitionGraph.setAllStateDefaultProperties-307"><span class="linenos">307</span></a>        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
</span><span id="StateTransitionGraph.setAllStateDefaultProperties-308"><a href="#StateTransitionGraph.setAllStateDefaultProperties-308"><span class="linenos">308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">setStateProperties</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set default visual and metadata properties for all states (nodes) in the graph.</p>

<p>This method applies <code><a href="#StateTransitionGraph.setStateProperties">setStateProperties()</a></code> to every node, ensuring each state
has at least the required default attributes (e.g., color and label).
Any additional keyword arguments are passed to <code><a href="#StateTransitionGraph.setStateProperties">setStateProperties()</a></code>.</p>

<h2 id="parameters">Parameters</h2>

<p>**kwargs : dict, optional
    Optional keyword arguments to apply uniformly to all nodes,
    such as color='gray', group='core', etc.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>This method is useful for initializing node attributes before plotting
or performing other graph-based computations.</li>
<li>Nodes without existing attributes will receive defaults via <code><a href="#StateTransitionGraph.addState">addState()</a></code>.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.addTransition" class="classattr">
                                        <input id="StateTransitionGraph.addTransition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">addTransition</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">origin_state</span>,</span><span class="param">	<span class="n">destination_state</span>,</span><span class="param">	<span class="n">sym_rate</span>,</span><span class="param">	<span class="n">tid</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">color</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">label</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.addTransition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.addTransition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.addTransition-312"><a href="#StateTransitionGraph.addTransition-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">addTransition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin_state</span><span class="p">,</span> <span class="n">destination_state</span><span class="p">,</span> <span class="n">sym_rate</span><span class="p">,</span> <span class="n">tid</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>     
</span><span id="StateTransitionGraph.addTransition-313"><a href="#StateTransitionGraph.addTransition-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.addTransition-314"><a href="#StateTransitionGraph.addTransition-314"><span class="linenos">314</span></a><span class="sd">        Add a directed transition (edge) between two states with a symbolic transition rate.</span>
</span><span id="StateTransitionGraph.addTransition-315"><a href="#StateTransitionGraph.addTransition-315"><span class="linenos">315</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addTransition-316"><a href="#StateTransitionGraph.addTransition-316"><span class="linenos">316</span></a><span class="sd">        This method adds a directed edge from `origin_state` to `destination_state`,</span>
</span><span id="StateTransitionGraph.addTransition-317"><a href="#StateTransitionGraph.addTransition-317"><span class="linenos">317</span></a><span class="sd">        stores both the symbolic and numerical rate, and sets optional display properties</span>
</span><span id="StateTransitionGraph.addTransition-318"><a href="#StateTransitionGraph.addTransition-318"><span class="linenos">318</span></a><span class="sd">        such as color, label, and transition ID. If the edge already exists, a warning is issued.</span>
</span><span id="StateTransitionGraph.addTransition-319"><a href="#StateTransitionGraph.addTransition-319"><span class="linenos">319</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addTransition-320"><a href="#StateTransitionGraph.addTransition-320"><span class="linenos">320</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.addTransition-321"><a href="#StateTransitionGraph.addTransition-321"><span class="linenos">321</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.addTransition-322"><a href="#StateTransitionGraph.addTransition-322"><span class="linenos">322</span></a><span class="sd">        - origin_state : hashable</span>
</span><span id="StateTransitionGraph.addTransition-323"><a href="#StateTransitionGraph.addTransition-323"><span class="linenos">323</span></a><span class="sd">            The source node (state) of the transition.</span>
</span><span id="StateTransitionGraph.addTransition-324"><a href="#StateTransitionGraph.addTransition-324"><span class="linenos">324</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addTransition-325"><a href="#StateTransitionGraph.addTransition-325"><span class="linenos">325</span></a><span class="sd">        - destination_state : hashable</span>
</span><span id="StateTransitionGraph.addTransition-326"><a href="#StateTransitionGraph.addTransition-326"><span class="linenos">326</span></a><span class="sd">            The target node (state) of the transition.</span>
</span><span id="StateTransitionGraph.addTransition-327"><a href="#StateTransitionGraph.addTransition-327"><span class="linenos">327</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addTransition-328"><a href="#StateTransitionGraph.addTransition-328"><span class="linenos">328</span></a><span class="sd">        - sym_rate : sympy.Expr</span>
</span><span id="StateTransitionGraph.addTransition-329"><a href="#StateTransitionGraph.addTransition-329"><span class="linenos">329</span></a><span class="sd">            A symbolic expression representing the transition rate.</span>
</span><span id="StateTransitionGraph.addTransition-330"><a href="#StateTransitionGraph.addTransition-330"><span class="linenos">330</span></a><span class="sd">            This will be numerically evaluated using internal substitutions (`self._subs`).</span>
</span><span id="StateTransitionGraph.addTransition-331"><a href="#StateTransitionGraph.addTransition-331"><span class="linenos">331</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addTransition-332"><a href="#StateTransitionGraph.addTransition-332"><span class="linenos">332</span></a><span class="sd">        - tid : str or int, optional</span>
</span><span id="StateTransitionGraph.addTransition-333"><a href="#StateTransitionGraph.addTransition-333"><span class="linenos">333</span></a><span class="sd">            A transition identifier (e.g. for grouping or styling).</span>
</span><span id="StateTransitionGraph.addTransition-334"><a href="#StateTransitionGraph.addTransition-334"><span class="linenos">334</span></a><span class="sd">            If provided, the color will default to `self._const.COLOR_TRANSITIONS[tid]` if not set explicitly.</span>
</span><span id="StateTransitionGraph.addTransition-335"><a href="#StateTransitionGraph.addTransition-335"><span class="linenos">335</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addTransition-336"><a href="#StateTransitionGraph.addTransition-336"><span class="linenos">336</span></a><span class="sd">        - color : str, optional</span>
</span><span id="StateTransitionGraph.addTransition-337"><a href="#StateTransitionGraph.addTransition-337"><span class="linenos">337</span></a><span class="sd">            Color for the edge (used in visualization). Defaults to the transition-specific color</span>
</span><span id="StateTransitionGraph.addTransition-338"><a href="#StateTransitionGraph.addTransition-338"><span class="linenos">338</span></a><span class="sd">            if `tid` is provided.</span>
</span><span id="StateTransitionGraph.addTransition-339"><a href="#StateTransitionGraph.addTransition-339"><span class="linenos">339</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addTransition-340"><a href="#StateTransitionGraph.addTransition-340"><span class="linenos">340</span></a><span class="sd">        - label : str, optional</span>
</span><span id="StateTransitionGraph.addTransition-341"><a href="#StateTransitionGraph.addTransition-341"><span class="linenos">341</span></a><span class="sd">            LaTeX-formatted string for labeling the edge. If not provided, a default label is</span>
</span><span id="StateTransitionGraph.addTransition-342"><a href="#StateTransitionGraph.addTransition-342"><span class="linenos">342</span></a><span class="sd">            generated using `sympy.latex(sym_rate)`.</span>
</span><span id="StateTransitionGraph.addTransition-343"><a href="#StateTransitionGraph.addTransition-343"><span class="linenos">343</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.addTransition-344"><a href="#StateTransitionGraph.addTransition-344"><span class="linenos">344</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.addTransition-345"><a href="#StateTransitionGraph.addTransition-345"><span class="linenos">345</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.addTransition-346"><a href="#StateTransitionGraph.addTransition-346"><span class="linenos">346</span></a><span class="sd">        - The numeric rate is computed by substituting known parameter values into `sym_rate`.</span>
</span><span id="StateTransitionGraph.addTransition-347"><a href="#StateTransitionGraph.addTransition-347"><span class="linenos">347</span></a><span class="sd">        - The following attributes are stored on the edge:</span>
</span><span id="StateTransitionGraph.addTransition-348"><a href="#StateTransitionGraph.addTransition-348"><span class="linenos">348</span></a><span class="sd">            - `rate` (float): numeric value of the transition rate</span>
</span><span id="StateTransitionGraph.addTransition-349"><a href="#StateTransitionGraph.addTransition-349"><span class="linenos">349</span></a><span class="sd">            - `sym_rate` (sympy.Expr): original symbolic expression</span>
</span><span id="StateTransitionGraph.addTransition-350"><a href="#StateTransitionGraph.addTransition-350"><span class="linenos">350</span></a><span class="sd">            - `label` (str): display label</span>
</span><span id="StateTransitionGraph.addTransition-351"><a href="#StateTransitionGraph.addTransition-351"><span class="linenos">351</span></a><span class="sd">            - `color` (str): edge color</span>
</span><span id="StateTransitionGraph.addTransition-352"><a href="#StateTransitionGraph.addTransition-352"><span class="linenos">352</span></a><span class="sd">            - `tid` (str or int): transition ID</span>
</span><span id="StateTransitionGraph.addTransition-353"><a href="#StateTransitionGraph.addTransition-353"><span class="linenos">353</span></a><span class="sd">        - If the edge already exists, a `UserWarning` is issued but the edge is still overwritten.</span>
</span><span id="StateTransitionGraph.addTransition-354"><a href="#StateTransitionGraph.addTransition-354"><span class="linenos">354</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph.addTransition-355"><a href="#StateTransitionGraph.addTransition-355"><span class="linenos">355</span></a>        <span class="k">if</span> <span class="n">tid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph.addTransition-356"><a href="#StateTransitionGraph.addTransition-356"><span class="linenos">356</span></a>            <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph.addTransition-357"><a href="#StateTransitionGraph.addTransition-357"><span class="linenos">357</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_TRANSITIONS</span><span class="p">[</span> <span class="n">tid</span> <span class="p">]</span>
</span><span id="StateTransitionGraph.addTransition-358"><a href="#StateTransitionGraph.addTransition-358"><span class="linenos">358</span></a>                
</span><span id="StateTransitionGraph.addTransition-359"><a href="#StateTransitionGraph.addTransition-359"><span class="linenos">359</span></a>        <span class="n">rate</span> <span class="o">=</span> <span class="n">sym_rate</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subs</span> <span class="p">)</span>
</span><span id="StateTransitionGraph.addTransition-360"><a href="#StateTransitionGraph.addTransition-360"><span class="linenos">360</span></a>        
</span><span id="StateTransitionGraph.addTransition-361"><a href="#StateTransitionGraph.addTransition-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;$&quot;</span><span class="o">+</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">sym_rate</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;$&quot;</span>
</span><span id="StateTransitionGraph.addTransition-362"><a href="#StateTransitionGraph.addTransition-362"><span class="linenos">362</span></a>                
</span><span id="StateTransitionGraph.addTransition-363"><a href="#StateTransitionGraph.addTransition-363"><span class="linenos">363</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">origin_state</span><span class="p">,</span> <span class="n">destination_state</span><span class="p">):</span>
</span><span id="StateTransitionGraph.addTransition-364"><a href="#StateTransitionGraph.addTransition-364"><span class="linenos">364</span></a>            <span class="n">theedge</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">origin_state</span><span class="p">][</span><span class="n">destination_state</span><span class="p">]</span>
</span><span id="StateTransitionGraph.addTransition-365"><a href="#StateTransitionGraph.addTransition-365"><span class="linenos">365</span></a>            <span class="n">warningstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Edge already exists: </span><span class="si">{</span><span class="n">origin_state</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">destination_state</span><span class="si">}</span><span class="s2"> with rate </span><span class="si">{</span><span class="n">theedge</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StateTransitionGraph.addTransition-366"><a href="#StateTransitionGraph.addTransition-366"><span class="linenos">366</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warningstr</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
</span><span id="StateTransitionGraph.addTransition-367"><a href="#StateTransitionGraph.addTransition-367"><span class="linenos">367</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">origin_state</span><span class="p">,</span> <span class="n">destination_state</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">rate</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">string</span><span class="p">,</span> 
</span><span id="StateTransitionGraph.addTransition-368"><a href="#StateTransitionGraph.addTransition-368"><span class="linenos">368</span></a>                   <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">sym_rate</span><span class="o">=</span><span class="n">sym_rate</span><span class="p">,</span> <span class="n">tid</span><span class="o">=</span><span class="n">tid</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add a directed transition (edge) between two states with a symbolic transition rate.</p>

<p>This method adds a directed edge from <code>origin_state</code> to <code>destination_state</code>,
stores both the symbolic and numerical rate, and sets optional display properties
such as color, label, and transition ID. If the edge already exists, a warning is issued.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><p>origin_state : hashable
The source node (state) of the transition.</p></li>
<li><p>destination_state : hashable
The target node (state) of the transition.</p></li>
<li><p>sym_rate : sympy.Expr
A symbolic expression representing the transition rate.
This will be numerically evaluated using internal substitutions (<code>self._subs</code>).</p></li>
<li><p>tid : str or int, optional
A transition identifier (e.g. for grouping or styling).
If provided, the color will default to <code>self._const.COLOR_TRANSITIONS[tid]</code> if not set explicitly.</p></li>
<li><p>color : str, optional
Color for the edge (used in visualization). Defaults to the transition-specific color
if <code>tid</code> is provided.</p></li>
<li><p>label : str, optional
LaTeX-formatted string for labeling the edge. If not provided, a default label is
generated using <code>sympy.latex(sym_rate)</code>.</p></li>
</ul>

<h2 id="notes">Notes</h2>

<ul>
<li>The numeric rate is computed by substituting known parameter values into <code>sym_rate</code>.</li>
<li>The following attributes are stored on the edge:
<ul>
<li><code>rate</code> (float): numeric value of the transition rate</li>
<li><code>sym_rate</code> (sympy.Expr): original symbolic expression</li>
<li><code>label</code> (str): display label</li>
<li><code>color</code> (str): edge color</li>
<li><code>tid</code> (str or int): transition ID</li>
</ul></li>
<li>If the edge already exists, a <code>UserWarning</code> is issued but the edge is still overwritten.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.sym" class="classattr">
                                        <input id="StateTransitionGraph.sym-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sym</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">key</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.sym-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.sym"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.sym-370"><a href="#StateTransitionGraph.sym-370"><span class="linenos">370</span></a>    <span class="k">def</span> <span class="nf">sym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="StateTransitionGraph.sym-371"><a href="#StateTransitionGraph.sym-371"><span class="linenos">371</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.sym-372"><a href="#StateTransitionGraph.sym-372"><span class="linenos">372</span></a><span class="sd">        Retrieve the symbolic representation of a model parameter.</span>
</span><span id="StateTransitionGraph.sym-373"><a href="#StateTransitionGraph.sym-373"><span class="linenos">373</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.sym-374"><a href="#StateTransitionGraph.sym-374"><span class="linenos">374</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.sym-375"><a href="#StateTransitionGraph.sym-375"><span class="linenos">375</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.sym-376"><a href="#StateTransitionGraph.sym-376"><span class="linenos">376</span></a><span class="sd">        key : str</span>
</span><span id="StateTransitionGraph.sym-377"><a href="#StateTransitionGraph.sym-377"><span class="linenos">377</span></a><span class="sd">            The name of the parameter (e.g., &#39;lambda&#39;, &#39;mu&#39;, &#39;n&#39;).</span>
</span><span id="StateTransitionGraph.sym-378"><a href="#StateTransitionGraph.sym-378"><span class="linenos">378</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.sym-379"><a href="#StateTransitionGraph.sym-379"><span class="linenos">379</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.sym-380"><a href="#StateTransitionGraph.sym-380"><span class="linenos">380</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.sym-381"><a href="#StateTransitionGraph.sym-381"><span class="linenos">381</span></a><span class="sd">        sympy.Symbol</span>
</span><span id="StateTransitionGraph.sym-382"><a href="#StateTransitionGraph.sym-382"><span class="linenos">382</span></a><span class="sd">            The symbolic variable corresponding to the given key.</span>
</span><span id="StateTransitionGraph.sym-383"><a href="#StateTransitionGraph.sym-383"><span class="linenos">383</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.sym-384"><a href="#StateTransitionGraph.sym-384"><span class="linenos">384</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph.sym-385"><a href="#StateTransitionGraph.sym-385"><span class="linenos">385</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph.sym-386"><a href="#StateTransitionGraph.sym-386"><span class="linenos">386</span></a><span class="sd">        KeyError</span>
</span><span id="StateTransitionGraph.sym-387"><a href="#StateTransitionGraph.sym-387"><span class="linenos">387</span></a><span class="sd">            If the key does not exist in the internal symbolic mapping (`_sym`).</span>
</span><span id="StateTransitionGraph.sym-388"><a href="#StateTransitionGraph.sym-388"><span class="linenos">388</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.sym-389"><a href="#StateTransitionGraph.sym-389"><span class="linenos">389</span></a><span class="sd">        Examples</span>
</span><span id="StateTransitionGraph.sym-390"><a href="#StateTransitionGraph.sym-390"><span class="linenos">390</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph.sym-391"><a href="#StateTransitionGraph.sym-391"><span class="linenos">391</span></a><span class="sd">        &gt;&gt;&gt; G.sym(&#39;lambda&#39;)</span>
</span><span id="StateTransitionGraph.sym-392"><a href="#StateTransitionGraph.sym-392"><span class="linenos">392</span></a><span class="sd">        lambda</span>
</span><span id="StateTransitionGraph.sym-393"><a href="#StateTransitionGraph.sym-393"><span class="linenos">393</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.sym-394"><a href="#StateTransitionGraph.sym-394"><span class="linenos">394</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.sym-395"><a href="#StateTransitionGraph.sym-395"><span class="linenos">395</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.sym-396"><a href="#StateTransitionGraph.sym-396"><span class="linenos">396</span></a><span class="sd">        - The symbolic mapping is initialized during object construction based on the `parameters` dictionary.</span>
</span><span id="StateTransitionGraph.sym-397"><a href="#StateTransitionGraph.sym-397"><span class="linenos">397</span></a><span class="sd">        - To access the symbol using dot-notation, use `.sym_key` attributes created during initialization.</span>
</span><span id="StateTransitionGraph.sym-398"><a href="#StateTransitionGraph.sym-398"><span class="linenos">398</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.sym-399"><a href="#StateTransitionGraph.sym-399"><span class="linenos">399</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sym</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the symbolic representation of a model parameter.</p>

<h2 id="parameters">Parameters</h2>

<p>key : str
    The name of the parameter (e.g., 'lambda', 'mu', 'n').</p>

<h2 id="returns">Returns</h2>

<p>sympy.Symbol
    The symbolic variable corresponding to the given key.</p>

<h2 id="raises">Raises</h2>

<p>KeyError
    If the key does not exist in the internal symbolic mapping (<code>_sym</code>).</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">sym</span><span class="p">(</span><span class="s1">&#39;lambda&#39;</span><span class="p">)</span>
<span class="go">lambda</span>
</code></pre>
</div>

<h2 id="notes">Notes</h2>

<ul>
<li>The symbolic mapping is initialized during object construction based on the <code><a href="#StateTransitionGraph.parameters">parameters</a></code> dictionary.</li>
<li>To access the symbol using dot-notation, use <code>.sym_key</code> attributes created during initialization.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.parameters" class="classattr">
                                        <input id="StateTransitionGraph.parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">parameters</span>

                <label class="view-source-button" for="StateTransitionGraph.parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.parameters-402"><a href="#StateTransitionGraph.parameters-402"><span class="linenos">402</span></a>    <span class="nd">@property</span>
</span><span id="StateTransitionGraph.parameters-403"><a href="#StateTransitionGraph.parameters-403"><span class="linenos">403</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph.parameters-404"><a href="#StateTransitionGraph.parameters-404"><span class="linenos">404</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.parameters-405"><a href="#StateTransitionGraph.parameters-405"><span class="linenos">405</span></a><span class="sd">        Return the model parameters as a dictionary.</span>
</span><span id="StateTransitionGraph.parameters-406"><a href="#StateTransitionGraph.parameters-406"><span class="linenos">406</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.parameters-407"><a href="#StateTransitionGraph.parameters-407"><span class="linenos">407</span></a><span class="sd">        This includes the original numerical values provided during initialization.</span>
</span><span id="StateTransitionGraph.parameters-408"><a href="#StateTransitionGraph.parameters-408"><span class="linenos">408</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.parameters-409"><a href="#StateTransitionGraph.parameters-409"><span class="linenos">409</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.parameters-410"><a href="#StateTransitionGraph.parameters-410"><span class="linenos">410</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.parameters-411"><a href="#StateTransitionGraph.parameters-411"><span class="linenos">411</span></a><span class="sd">        dict</span>
</span><span id="StateTransitionGraph.parameters-412"><a href="#StateTransitionGraph.parameters-412"><span class="linenos">412</span></a><span class="sd">            Dictionary of parameter names and their corresponding numeric values.</span>
</span><span id="StateTransitionGraph.parameters-413"><a href="#StateTransitionGraph.parameters-413"><span class="linenos">413</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.parameters-414"><a href="#StateTransitionGraph.parameters-414"><span class="linenos">414</span></a><span class="sd">        Examples</span>
</span><span id="StateTransitionGraph.parameters-415"><a href="#StateTransitionGraph.parameters-415"><span class="linenos">415</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph.parameters-416"><a href="#StateTransitionGraph.parameters-416"><span class="linenos">416</span></a><span class="sd">        &gt;&gt;&gt; G.parameters</span>
</span><span id="StateTransitionGraph.parameters-417"><a href="#StateTransitionGraph.parameters-417"><span class="linenos">417</span></a><span class="sd">        {&#39;lambda&#39;: 1.0, &#39;mu&#39;: 0.5, &#39;n&#39;: 3}</span>
</span><span id="StateTransitionGraph.parameters-418"><a href="#StateTransitionGraph.parameters-418"><span class="linenos">418</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.parameters-419"><a href="#StateTransitionGraph.parameters-419"><span class="linenos">419</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.parameters-420"><a href="#StateTransitionGraph.parameters-420"><span class="linenos">420</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.parameters-421"><a href="#StateTransitionGraph.parameters-421"><span class="linenos">421</span></a><span class="sd">        - This property does not return symbolic values. Use `self.sym(key)` for symbolic access.</span>
</span><span id="StateTransitionGraph.parameters-422"><a href="#StateTransitionGraph.parameters-422"><span class="linenos">422</span></a><span class="sd">        - Parameter symbols can also be accessed using attributes like `sym_lambda` or the `sym()` method.</span>
</span><span id="StateTransitionGraph.parameters-423"><a href="#StateTransitionGraph.parameters-423"><span class="linenos">423</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.parameters-424"><a href="#StateTransitionGraph.parameters-424"><span class="linenos">424</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span>
</span></pre></div>


            <div class="docstring"><p>Return the model parameters as a dictionary.</p>

<p>This includes the original numerical values provided during initialization.</p>

<h2 id="returns">Returns</h2>

<p>dict
    Dictionary of parameter names and their corresponding numeric values.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">parameters</span>
<span class="go">{&#39;lambda&#39;: 1.0, &#39;mu&#39;: 0.5, &#39;n&#39;: 3}</span>
</code></pre>
</div>

<h2 id="notes">Notes</h2>

<ul>
<li>This property does not return symbolic values. Use <code>self.sym(key)</code> for symbolic access.</li>
<li>Parameter symbols can also be accessed using attributes like <code>sym_lambda</code> or the <code><a href="#StateTransitionGraph.sym">sym()</a></code> method.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.rate_matrix" class="classattr">
                                        <input id="StateTransitionGraph.rate_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rate_matrix</span>

                <label class="view-source-button" for="StateTransitionGraph.rate_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.rate_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.rate_matrix-428"><a href="#StateTransitionGraph.rate_matrix-428"><span class="linenos">428</span></a>    <span class="nd">@property</span>
</span><span id="StateTransitionGraph.rate_matrix-429"><a href="#StateTransitionGraph.rate_matrix-429"><span class="linenos">429</span></a>    <span class="k">def</span> <span class="nf">rate_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph.rate_matrix-430"><a href="#StateTransitionGraph.rate_matrix-430"><span class="linenos">430</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.rate_matrix-431"><a href="#StateTransitionGraph.rate_matrix-431"><span class="linenos">431</span></a><span class="sd">        Return the continuous-time rate matrix (Q matrix) of the state transition graph.</span>
</span><span id="StateTransitionGraph.rate_matrix-432"><a href="#StateTransitionGraph.rate_matrix-432"><span class="linenos">432</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.rate_matrix-433"><a href="#StateTransitionGraph.rate_matrix-433"><span class="linenos">433</span></a><span class="sd">        This matrix defines the transition rates between all pairs of states in the</span>
</span><span id="StateTransitionGraph.rate_matrix-434"><a href="#StateTransitionGraph.rate_matrix-434"><span class="linenos">434</span></a><span class="sd">        continuous-time Markov chain (CTMC) represented by this graph.</span>
</span><span id="StateTransitionGraph.rate_matrix-435"><a href="#StateTransitionGraph.rate_matrix-435"><span class="linenos">435</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.rate_matrix-436"><a href="#StateTransitionGraph.rate_matrix-436"><span class="linenos">436</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.rate_matrix-437"><a href="#StateTransitionGraph.rate_matrix-437"><span class="linenos">437</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.rate_matrix-438"><a href="#StateTransitionGraph.rate_matrix-438"><span class="linenos">438</span></a><span class="sd">        numpy.ndarray or None</span>
</span><span id="StateTransitionGraph.rate_matrix-439"><a href="#StateTransitionGraph.rate_matrix-439"><span class="linenos">439</span></a><span class="sd">            The rate matrix `Q`, where `Q[i, j]` is the transition rate from state `i` to `j`.</span>
</span><span id="StateTransitionGraph.rate_matrix-440"><a href="#StateTransitionGraph.rate_matrix-440"><span class="linenos">440</span></a><span class="sd">            Returns `None` if the rate matrix has not been computed yet.</span>
</span><span id="StateTransitionGraph.rate_matrix-441"><a href="#StateTransitionGraph.rate_matrix-441"><span class="linenos">441</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.rate_matrix-442"><a href="#StateTransitionGraph.rate_matrix-442"><span class="linenos">442</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.rate_matrix-443"><a href="#StateTransitionGraph.rate_matrix-443"><span class="linenos">443</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.rate_matrix-444"><a href="#StateTransitionGraph.rate_matrix-444"><span class="linenos">444</span></a><span class="sd">        - The matrix is typically generated via a method like `computeRateMatrix()` or similar.</span>
</span><span id="StateTransitionGraph.rate_matrix-445"><a href="#StateTransitionGraph.rate_matrix-445"><span class="linenos">445</span></a><span class="sd">        - Internal state indexing is handled by `_n2i` (node-to-index mapping).</span>
</span><span id="StateTransitionGraph.rate_matrix-446"><a href="#StateTransitionGraph.rate_matrix-446"><span class="linenos">446</span></a><span class="sd">        - The rate matrix is stored internally as `_rate_matrix`.</span>
</span><span id="StateTransitionGraph.rate_matrix-447"><a href="#StateTransitionGraph.rate_matrix-447"><span class="linenos">447</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.rate_matrix-448"><a href="#StateTransitionGraph.rate_matrix-448"><span class="linenos">448</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span>
</span></pre></div>


            <div class="docstring"><p>Return the continuous-time rate matrix (Q matrix) of the state transition graph.</p>

<p>This matrix defines the transition rates between all pairs of states in the
continuous-time Markov chain (CTMC) represented by this graph.</p>

<h2 id="returns">Returns</h2>

<p>numpy.ndarray or None
    The rate matrix <code>Q</code>, where <code>Q[i, j]</code> is the transition rate from state <code>i</code> to <code>j</code>.
    Returns <code>None</code> if the rate matrix has not been computed yet.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>The matrix is typically generated via a method like <code>computeRateMatrix()</code> or similar.</li>
<li>Internal state indexing is handled by <code>_n2i</code> (node-to-index mapping).</li>
<li>The rate matrix is stored internally as <code>_rate_matrix</code>.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.state_probabilities" class="classattr">
                                        <input id="StateTransitionGraph.state_probabilities-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">state_probabilities</span>

                <label class="view-source-button" for="StateTransitionGraph.state_probabilities-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.state_probabilities"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.state_probabilities-452"><a href="#StateTransitionGraph.state_probabilities-452"><span class="linenos">452</span></a>    <span class="nd">@property</span>
</span><span id="StateTransitionGraph.state_probabilities-453"><a href="#StateTransitionGraph.state_probabilities-453"><span class="linenos">453</span></a>    <span class="k">def</span> <span class="nf">state_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph.state_probabilities-454"><a href="#StateTransitionGraph.state_probabilities-454"><span class="linenos">454</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.state_probabilities-455"><a href="#StateTransitionGraph.state_probabilities-455"><span class="linenos">455</span></a><span class="sd">        Return the steady-state probabilities of the continuous-time Markov chain (CTMC).</span>
</span><span id="StateTransitionGraph.state_probabilities-456"><a href="#StateTransitionGraph.state_probabilities-456"><span class="linenos">456</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.state_probabilities-457"><a href="#StateTransitionGraph.state_probabilities-457"><span class="linenos">457</span></a><span class="sd">        These probabilities represent the long-run proportion of time the system spends</span>
</span><span id="StateTransitionGraph.state_probabilities-458"><a href="#StateTransitionGraph.state_probabilities-458"><span class="linenos">458</span></a><span class="sd">        in each state, assuming the CTMC is irreducible and positive recurrent.</span>
</span><span id="StateTransitionGraph.state_probabilities-459"><a href="#StateTransitionGraph.state_probabilities-459"><span class="linenos">459</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.state_probabilities-460"><a href="#StateTransitionGraph.state_probabilities-460"><span class="linenos">460</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.state_probabilities-461"><a href="#StateTransitionGraph.state_probabilities-461"><span class="linenos">461</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.state_probabilities-462"><a href="#StateTransitionGraph.state_probabilities-462"><span class="linenos">462</span></a><span class="sd">        dict or None</span>
</span><span id="StateTransitionGraph.state_probabilities-463"><a href="#StateTransitionGraph.state_probabilities-463"><span class="linenos">463</span></a><span class="sd">            A dictionary mapping each state to its steady-state probability.</span>
</span><span id="StateTransitionGraph.state_probabilities-464"><a href="#StateTransitionGraph.state_probabilities-464"><span class="linenos">464</span></a><span class="sd">            Returns `None` if the probabilities have not yet been computed.</span>
</span><span id="StateTransitionGraph.state_probabilities-465"><a href="#StateTransitionGraph.state_probabilities-465"><span class="linenos">465</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.state_probabilities-466"><a href="#StateTransitionGraph.state_probabilities-466"><span class="linenos">466</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.state_probabilities-467"><a href="#StateTransitionGraph.state_probabilities-467"><span class="linenos">467</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.state_probabilities-468"><a href="#StateTransitionGraph.state_probabilities-468"><span class="linenos">468</span></a><span class="sd">        - The probabilities are stored internally after being computed via a dedicated method</span>
</span><span id="StateTransitionGraph.state_probabilities-469"><a href="#StateTransitionGraph.state_probabilities-469"><span class="linenos">469</span></a><span class="sd">          `calcSteadyStateProbs()`.</span>
</span><span id="StateTransitionGraph.state_probabilities-470"><a href="#StateTransitionGraph.state_probabilities-470"><span class="linenos">470</span></a><span class="sd">        - The result is stored in the `_state_probabilities` attribute.</span>
</span><span id="StateTransitionGraph.state_probabilities-471"><a href="#StateTransitionGraph.state_probabilities-471"><span class="linenos">471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.state_probabilities-472"><a href="#StateTransitionGraph.state_probabilities-472"><span class="linenos">472</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_probabilities</span>
</span></pre></div>


            <div class="docstring"><p>Return the steady-state probabilities of the continuous-time Markov chain (CTMC).</p>

<p>These probabilities represent the long-run proportion of time the system spends
in each state, assuming the CTMC is irreducible and positive recurrent.</p>

<h2 id="returns">Returns</h2>

<p>dict or None
    A dictionary mapping each state to its steady-state probability.
    Returns <code>None</code> if the probabilities have not yet been computed.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>The probabilities are stored internally after being computed via a dedicated method
<code><a href="#StateTransitionGraph.calcSteadyStateProbs">calcSteadyStateProbs()</a></code>.</li>
<li>The result is stored in the <code>_state_probabilities</code> attribute.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.printEdges" class="classattr">
                                        <input id="StateTransitionGraph.printEdges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">printEdges</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">state</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.printEdges-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.printEdges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.printEdges-476"><a href="#StateTransitionGraph.printEdges-476"><span class="linenos">476</span></a>    <span class="k">def</span> <span class="nf">printEdges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="StateTransitionGraph.printEdges-477"><a href="#StateTransitionGraph.printEdges-477"><span class="linenos">477</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.printEdges-478"><a href="#StateTransitionGraph.printEdges-478"><span class="linenos">478</span></a><span class="sd">        Print all outgoing edges from a given state in the graph.</span>
</span><span id="StateTransitionGraph.printEdges-479"><a href="#StateTransitionGraph.printEdges-479"><span class="linenos">479</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.printEdges-480"><a href="#StateTransitionGraph.printEdges-480"><span class="linenos">480</span></a><span class="sd">        For each edge from the specified `state`, this method prints the destination</span>
</span><span id="StateTransitionGraph.printEdges-481"><a href="#StateTransitionGraph.printEdges-481"><span class="linenos">481</span></a><span class="sd">        state and the corresponding transition label (typically the symbolic rate).</span>
</span><span id="StateTransitionGraph.printEdges-482"><a href="#StateTransitionGraph.printEdges-482"><span class="linenos">482</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.printEdges-483"><a href="#StateTransitionGraph.printEdges-483"><span class="linenos">483</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.printEdges-484"><a href="#StateTransitionGraph.printEdges-484"><span class="linenos">484</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.printEdges-485"><a href="#StateTransitionGraph.printEdges-485"><span class="linenos">485</span></a><span class="sd">        state : hashable</span>
</span><span id="StateTransitionGraph.printEdges-486"><a href="#StateTransitionGraph.printEdges-486"><span class="linenos">486</span></a><span class="sd">            The source node (state) from which outgoing edges will be printed.            </span>
</span><span id="StateTransitionGraph.printEdges-487"><a href="#StateTransitionGraph.printEdges-487"><span class="linenos">487</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.printEdges-488"><a href="#StateTransitionGraph.printEdges-488"><span class="linenos">488</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.printEdges-489"><a href="#StateTransitionGraph.printEdges-489"><span class="linenos">489</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.printEdges-490"><a href="#StateTransitionGraph.printEdges-490"><span class="linenos">490</span></a><span class="sd">        None</span>
</span><span id="StateTransitionGraph.printEdges-491"><a href="#StateTransitionGraph.printEdges-491"><span class="linenos">491</span></a><span class="sd">            This method prints output directly to the console and does not return a value.</span>
</span><span id="StateTransitionGraph.printEdges-492"><a href="#StateTransitionGraph.printEdges-492"><span class="linenos">492</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.printEdges-493"><a href="#StateTransitionGraph.printEdges-493"><span class="linenos">493</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.printEdges-494"><a href="#StateTransitionGraph.printEdges-494"><span class="linenos">494</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.printEdges-495"><a href="#StateTransitionGraph.printEdges-495"><span class="linenos">495</span></a><span class="sd">        - The transition label is retrieved from the edge attribute `&#39;label&#39;`.</span>
</span><span id="StateTransitionGraph.printEdges-496"><a href="#StateTransitionGraph.printEdges-496"><span class="linenos">496</span></a><span class="sd">        - Assumes `state` exists in the graph; otherwise, a KeyError will be raised.</span>
</span><span id="StateTransitionGraph.printEdges-497"><a href="#StateTransitionGraph.printEdges-497"><span class="linenos">497</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.printEdges-498"><a href="#StateTransitionGraph.printEdges-498"><span class="linenos">498</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;from </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.printEdges-499"><a href="#StateTransitionGraph.printEdges-499"><span class="linenos">499</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="StateTransitionGraph.printEdges-500"><a href="#StateTransitionGraph.printEdges-500"><span class="linenos">500</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
</span><span id="StateTransitionGraph.printEdges-501"><a href="#StateTransitionGraph.printEdges-501"><span class="linenos">501</span></a>            <span class="n">rate</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
</span><span id="StateTransitionGraph.printEdges-502"><a href="#StateTransitionGraph.printEdges-502"><span class="linenos">502</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; -&gt; </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">rate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Print all outgoing edges from a given state in the graph.</p>

<p>For each edge from the specified <code>state</code>, this method prints the destination
state and the corresponding transition label (typically the symbolic rate).</p>

<h2 id="parameters">Parameters</h2>

<p>state : hashable
    The source node (state) from which outgoing edges will be printed.            </p>

<h2 id="returns">Returns</h2>

<p>None
    This method prints output directly to the console and does not return a value.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>The transition label is retrieved from the edge attribute <code>'label'</code>.</li>
<li>Assumes <code>state</code> exists in the graph; otherwise, a KeyError will be raised.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.createRateMatrix" class="classattr">
                                        <input id="StateTransitionGraph.createRateMatrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">createRateMatrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.createRateMatrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.createRateMatrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.createRateMatrix-505"><a href="#StateTransitionGraph.createRateMatrix-505"><span class="linenos">505</span></a>    <span class="k">def</span> <span class="nf">createRateMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph.createRateMatrix-506"><a href="#StateTransitionGraph.createRateMatrix-506"><span class="linenos">506</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.createRateMatrix-507"><a href="#StateTransitionGraph.createRateMatrix-507"><span class="linenos">507</span></a><span class="sd">        Construct the continuous-time Markov chain (CTMC) rate matrix Q from the graph.</span>
</span><span id="StateTransitionGraph.createRateMatrix-508"><a href="#StateTransitionGraph.createRateMatrix-508"><span class="linenos">508</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.createRateMatrix-509"><a href="#StateTransitionGraph.createRateMatrix-509"><span class="linenos">509</span></a><span class="sd">        This method generates the generator matrix `Q` corresponding to the structure and</span>
</span><span id="StateTransitionGraph.createRateMatrix-510"><a href="#StateTransitionGraph.createRateMatrix-510"><span class="linenos">510</span></a><span class="sd">        rates defined in the directed graph. Each node represents a system state, and each</span>
</span><span id="StateTransitionGraph.createRateMatrix-511"><a href="#StateTransitionGraph.createRateMatrix-511"><span class="linenos">511</span></a><span class="sd">        directed edge must have a `&#39;rate&#39;` attribute representing the transition rate from</span>
</span><span id="StateTransitionGraph.createRateMatrix-512"><a href="#StateTransitionGraph.createRateMatrix-512"><span class="linenos">512</span></a><span class="sd">        one state to another.</span>
</span><span id="StateTransitionGraph.createRateMatrix-513"><a href="#StateTransitionGraph.createRateMatrix-513"><span class="linenos">513</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.createRateMatrix-514"><a href="#StateTransitionGraph.createRateMatrix-514"><span class="linenos">514</span></a><span class="sd">        The matrix `Q` is constructed such that:</span>
</span><span id="StateTransitionGraph.createRateMatrix-515"><a href="#StateTransitionGraph.createRateMatrix-515"><span class="linenos">515</span></a><span class="sd">        - `Q[i, j]` is the transition rate from state `i` to state `j`</span>
</span><span id="StateTransitionGraph.createRateMatrix-516"><a href="#StateTransitionGraph.createRateMatrix-516"><span class="linenos">516</span></a><span class="sd">        - Diagonal entries satisfy `Q[i, i] = -sum(Q[i, j]) for j ≠ i`, so that each row sums to 0</span>
</span><span id="StateTransitionGraph.createRateMatrix-517"><a href="#StateTransitionGraph.createRateMatrix-517"><span class="linenos">517</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.createRateMatrix-518"><a href="#StateTransitionGraph.createRateMatrix-518"><span class="linenos">518</span></a><span class="sd">        The resulting matrix and the internal node-to-index mapping (`_n2i`) are stored</span>
</span><span id="StateTransitionGraph.createRateMatrix-519"><a href="#StateTransitionGraph.createRateMatrix-519"><span class="linenos">519</span></a><span class="sd">        as attributes of the graph.</span>
</span><span id="StateTransitionGraph.createRateMatrix-520"><a href="#StateTransitionGraph.createRateMatrix-520"><span class="linenos">520</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.createRateMatrix-521"><a href="#StateTransitionGraph.createRateMatrix-521"><span class="linenos">521</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.createRateMatrix-522"><a href="#StateTransitionGraph.createRateMatrix-522"><span class="linenos">522</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.createRateMatrix-523"><a href="#StateTransitionGraph.createRateMatrix-523"><span class="linenos">523</span></a><span class="sd">        None</span>
</span><span id="StateTransitionGraph.createRateMatrix-524"><a href="#StateTransitionGraph.createRateMatrix-524"><span class="linenos">524</span></a><span class="sd">            The method updates internal attributes:</span>
</span><span id="StateTransitionGraph.createRateMatrix-525"><a href="#StateTransitionGraph.createRateMatrix-525"><span class="linenos">525</span></a><span class="sd">            - `_rate_matrix` : numpy.ndarray</span>
</span><span id="StateTransitionGraph.createRateMatrix-526"><a href="#StateTransitionGraph.createRateMatrix-526"><span class="linenos">526</span></a><span class="sd">                The CTMC rate matrix Q</span>
</span><span id="StateTransitionGraph.createRateMatrix-527"><a href="#StateTransitionGraph.createRateMatrix-527"><span class="linenos">527</span></a><span class="sd">            - `_n2i` : dict</span>
</span><span id="StateTransitionGraph.createRateMatrix-528"><a href="#StateTransitionGraph.createRateMatrix-528"><span class="linenos">528</span></a><span class="sd">                Mapping from node identifiers to matrix row/column indices</span>
</span><span id="StateTransitionGraph.createRateMatrix-529"><a href="#StateTransitionGraph.createRateMatrix-529"><span class="linenos">529</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.createRateMatrix-530"><a href="#StateTransitionGraph.createRateMatrix-530"><span class="linenos">530</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.createRateMatrix-531"><a href="#StateTransitionGraph.createRateMatrix-531"><span class="linenos">531</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.createRateMatrix-532"><a href="#StateTransitionGraph.createRateMatrix-532"><span class="linenos">532</span></a><span class="sd">        - Assumes all edges in the graph have a `&#39;rate&#39;` attribute.</span>
</span><span id="StateTransitionGraph.createRateMatrix-533"><a href="#StateTransitionGraph.createRateMatrix-533"><span class="linenos">533</span></a><span class="sd">        - The node order used in the matrix is consistent with the order from `list(self.nodes)`.</span>
</span><span id="StateTransitionGraph.createRateMatrix-534"><a href="#StateTransitionGraph.createRateMatrix-534"><span class="linenos">534</span></a><span class="sd">        - Use `self.rate_matrix` to access the generated matrix after this method is called.</span>
</span><span id="StateTransitionGraph.createRateMatrix-535"><a href="#StateTransitionGraph.createRateMatrix-535"><span class="linenos">535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.createRateMatrix-536"><a href="#StateTransitionGraph.createRateMatrix-536"><span class="linenos">536</span></a>        <span class="n">n2i</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph.createRateMatrix-537"><a href="#StateTransitionGraph.createRateMatrix-537"><span class="linenos">537</span></a>        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="StateTransitionGraph.createRateMatrix-538"><a href="#StateTransitionGraph.createRateMatrix-538"><span class="linenos">538</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
</span><span id="StateTransitionGraph.createRateMatrix-539"><a href="#StateTransitionGraph.createRateMatrix-539"><span class="linenos">539</span></a>            <span class="n">n2i</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>         
</span><span id="StateTransitionGraph.createRateMatrix-540"><a href="#StateTransitionGraph.createRateMatrix-540"><span class="linenos">540</span></a>        <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)))</span> <span class="c1"># rate matrix</span>
</span><span id="StateTransitionGraph.createRateMatrix-541"><a href="#StateTransitionGraph.createRateMatrix-541"><span class="linenos">541</span></a>        
</span><span id="StateTransitionGraph.createRateMatrix-542"><a href="#StateTransitionGraph.createRateMatrix-542"><span class="linenos">542</span></a>        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
</span><span id="StateTransitionGraph.createRateMatrix-543"><a href="#StateTransitionGraph.createRateMatrix-543"><span class="linenos">543</span></a>            <span class="n">i0</span> <span class="o">=</span> <span class="n">n2i</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="StateTransitionGraph.createRateMatrix-544"><a href="#StateTransitionGraph.createRateMatrix-544"><span class="linenos">544</span></a>            <span class="n">i1</span> <span class="o">=</span> <span class="n">n2i</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="StateTransitionGraph.createRateMatrix-545"><a href="#StateTransitionGraph.createRateMatrix-545"><span class="linenos">545</span></a>            <span class="n">Q</span><span class="p">[</span><span class="n">i0</span><span class="p">,</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;rate&quot;</span><span class="p">]</span> 
</span><span id="StateTransitionGraph.createRateMatrix-546"><a href="#StateTransitionGraph.createRateMatrix-546"><span class="linenos">546</span></a>            
</span><span id="StateTransitionGraph.createRateMatrix-547"><a href="#StateTransitionGraph.createRateMatrix-547"><span class="linenos">547</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="o">-</span><span class="n">Q</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="StateTransitionGraph.createRateMatrix-548"><a href="#StateTransitionGraph.createRateMatrix-548"><span class="linenos">548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="o">=</span> <span class="n">Q</span>
</span><span id="StateTransitionGraph.createRateMatrix-549"><a href="#StateTransitionGraph.createRateMatrix-549"><span class="linenos">549</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="o">=</span> <span class="n">n2i</span>
</span><span id="StateTransitionGraph.createRateMatrix-550"><a href="#StateTransitionGraph.createRateMatrix-550"><span class="linenos">550</span></a>        <span class="c1">#return Q, n2i</span>
</span></pre></div>


            <div class="docstring"><p>Construct the continuous-time Markov chain (CTMC) rate matrix Q from the graph.</p>

<p>This method generates the generator matrix <code>Q</code> corresponding to the structure and
rates defined in the directed graph. Each node represents a system state, and each
directed edge must have a <code>'rate'</code> attribute representing the transition rate from
one state to another.</p>

<p>The matrix <code>Q</code> is constructed such that:</p>

<ul>
<li><code>Q[i, j]</code> is the transition rate from state <code>i</code> to state <code>j</code></li>
<li>Diagonal entries satisfy <code>Q[i, i] = -sum(Q[i, j]) for j ≠ i</code>, so that each row sums to 0</li>
</ul>

<p>The resulting matrix and the internal node-to-index mapping (<code>_n2i</code>) are stored
as attributes of the graph.</p>

<h2 id="returns">Returns</h2>

<p>None
    The method updates internal attributes:
    - <code>_rate_matrix</code> : numpy.ndarray
        The CTMC rate matrix Q
    - <code>_n2i</code> : dict
        Mapping from node identifiers to matrix row/column indices</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Assumes all edges in the graph have a <code>'rate'</code> attribute.</li>
<li>The node order used in the matrix is consistent with the order from <code>list(self.nodes)</code>.</li>
<li>Use <code>self.rate_matrix</code> to access the generated matrix after this method is called.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.calcSteadyStateProbs" class="classattr">
                                        <input id="StateTransitionGraph.calcSteadyStateProbs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calcSteadyStateProbs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.calcSteadyStateProbs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.calcSteadyStateProbs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.calcSteadyStateProbs-552"><a href="#StateTransitionGraph.calcSteadyStateProbs-552"><span class="linenos">552</span></a>    <span class="k">def</span> <span class="nf">calcSteadyStateProbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>        
</span><span id="StateTransitionGraph.calcSteadyStateProbs-553"><a href="#StateTransitionGraph.calcSteadyStateProbs-553"><span class="linenos">553</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-554"><a href="#StateTransitionGraph.calcSteadyStateProbs-554"><span class="linenos">554</span></a><span class="sd">        Compute the steady-state probabilities of the continuous-time Markov chain (CTMC).</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-555"><a href="#StateTransitionGraph.calcSteadyStateProbs-555"><span class="linenos">555</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-556"><a href="#StateTransitionGraph.calcSteadyStateProbs-556"><span class="linenos">556</span></a><span class="sd">        This method calculates the stationary distribution of the CTMC defined by the rate</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-557"><a href="#StateTransitionGraph.calcSteadyStateProbs-557"><span class="linenos">557</span></a><span class="sd">        matrix of the state transition graph. The computation solves the linear system</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-558"><a href="#StateTransitionGraph.calcSteadyStateProbs-558"><span class="linenos">558</span></a><span class="sd">        `XQ = 0` with the constraint that the probabilities X sum to 1, using a modified</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-559"><a href="#StateTransitionGraph.calcSteadyStateProbs-559"><span class="linenos">559</span></a><span class="sd">        version of the rate matrix `Q`.</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-560"><a href="#StateTransitionGraph.calcSteadyStateProbs-560"><span class="linenos">560</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-561"><a href="#StateTransitionGraph.calcSteadyStateProbs-561"><span class="linenos">561</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-562"><a href="#StateTransitionGraph.calcSteadyStateProbs-562"><span class="linenos">562</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-563"><a href="#StateTransitionGraph.calcSteadyStateProbs-563"><span class="linenos">563</span></a><span class="sd">        verbose : bool, optional</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-564"><a href="#StateTransitionGraph.calcSteadyStateProbs-564"><span class="linenos">564</span></a><span class="sd">            If True, prints the rate matrix, the modified matrix, the right-hand side vector,</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-565"><a href="#StateTransitionGraph.calcSteadyStateProbs-565"><span class="linenos">565</span></a><span class="sd">            and the resulting steady-state probabilities.</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-566"><a href="#StateTransitionGraph.calcSteadyStateProbs-566"><span class="linenos">566</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-567"><a href="#StateTransitionGraph.calcSteadyStateProbs-567"><span class="linenos">567</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-568"><a href="#StateTransitionGraph.calcSteadyStateProbs-568"><span class="linenos">568</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-569"><a href="#StateTransitionGraph.calcSteadyStateProbs-569"><span class="linenos">569</span></a><span class="sd">        probs : dict</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-570"><a href="#StateTransitionGraph.calcSteadyStateProbs-570"><span class="linenos">570</span></a><span class="sd">            A dictionary mapping each state (node in the graph) to its steady-state probability.</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-571"><a href="#StateTransitionGraph.calcSteadyStateProbs-571"><span class="linenos">571</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-572"><a href="#StateTransitionGraph.calcSteadyStateProbs-572"><span class="linenos">572</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-573"><a href="#StateTransitionGraph.calcSteadyStateProbs-573"><span class="linenos">573</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-574"><a href="#StateTransitionGraph.calcSteadyStateProbs-574"><span class="linenos">574</span></a><span class="sd">        - The graph must already contain valid transition rates on its edges.</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-575"><a href="#StateTransitionGraph.calcSteadyStateProbs-575"><span class="linenos">575</span></a><span class="sd">        - If the rate matrix has not yet been created, `createRateMatrix()` is called automatically.</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-576"><a href="#StateTransitionGraph.calcSteadyStateProbs-576"><span class="linenos">576</span></a><span class="sd">        - The method modifies the last column of the rate matrix to impose the normalization constraint</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-577"><a href="#StateTransitionGraph.calcSteadyStateProbs-577"><span class="linenos">577</span></a><span class="sd">          `sum(X) = 1`.</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-578"><a href="#StateTransitionGraph.calcSteadyStateProbs-578"><span class="linenos">578</span></a><span class="sd">        - The inverse of the modified matrix is computed directly, so the graph should be small enough</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-579"><a href="#StateTransitionGraph.calcSteadyStateProbs-579"><span class="linenos">579</span></a><span class="sd">          to avoid numerical instability or performance issues.</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-580"><a href="#StateTransitionGraph.calcSteadyStateProbs-580"><span class="linenos">580</span></a><span class="sd">        - The resulting probabilities are stored internally in `_state_probabilities` and can be accessed</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-581"><a href="#StateTransitionGraph.calcSteadyStateProbs-581"><span class="linenos">581</span></a><span class="sd">          via the `state_probabilities` property.</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-582"><a href="#StateTransitionGraph.calcSteadyStateProbs-582"><span class="linenos">582</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-583"><a href="#StateTransitionGraph.calcSteadyStateProbs-583"><span class="linenos">583</span></a>        
</span><span id="StateTransitionGraph.calcSteadyStateProbs-584"><a href="#StateTransitionGraph.calcSteadyStateProbs-584"><span class="linenos">584</span></a>        <span class="c1"># compute transition matrix if not already done</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-585"><a href="#StateTransitionGraph.calcSteadyStateProbs-585"><span class="linenos">585</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">createRateMatrix</span><span class="p">()</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-586"><a href="#StateTransitionGraph.calcSteadyStateProbs-586"><span class="linenos">586</span></a>        <span class="n">Q2</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-587"><a href="#StateTransitionGraph.calcSteadyStateProbs-587"><span class="linenos">587</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-588"><a href="#StateTransitionGraph.calcSteadyStateProbs-588"><span class="linenos">588</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rate matrix Q&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-589"><a href="#StateTransitionGraph.calcSteadyStateProbs-589"><span class="linenos">589</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Q=</span><span class="se">\n</span><span class="si">{</span><span class="n">Q2</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-590"><a href="#StateTransitionGraph.calcSteadyStateProbs-590"><span class="linenos">590</span></a>        
</span><span id="StateTransitionGraph.calcSteadyStateProbs-591"><a href="#StateTransitionGraph.calcSteadyStateProbs-591"><span class="linenos">591</span></a>        <span class="n">Q2</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-592"><a href="#StateTransitionGraph.calcSteadyStateProbs-592"><span class="linenos">592</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>        
</span><span id="StateTransitionGraph.calcSteadyStateProbs-593"><a href="#StateTransitionGraph.calcSteadyStateProbs-593"><span class="linenos">593</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Matrix is changed to</span><span class="se">\n</span><span class="s1">Q2=</span><span class="se">\n</span><span class="si">{</span><span class="n">Q2</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-594"><a href="#StateTransitionGraph.calcSteadyStateProbs-594"><span class="linenos">594</span></a>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-595"><a href="#StateTransitionGraph.calcSteadyStateProbs-595"><span class="linenos">595</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Q2</span><span class="p">))</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-596"><a href="#StateTransitionGraph.calcSteadyStateProbs-596"><span class="linenos">596</span></a>        <span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-597"><a href="#StateTransitionGraph.calcSteadyStateProbs-597"><span class="linenos">597</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-598"><a href="#StateTransitionGraph.calcSteadyStateProbs-598"><span class="linenos">598</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Solve X = b @ Q2&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-599"><a href="#StateTransitionGraph.calcSteadyStateProbs-599"><span class="linenos">599</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;b=</span><span class="se">\n</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-600"><a href="#StateTransitionGraph.calcSteadyStateProbs-600"><span class="linenos">600</span></a>        
</span><span id="StateTransitionGraph.calcSteadyStateProbs-601"><a href="#StateTransitionGraph.calcSteadyStateProbs-601"><span class="linenos">601</span></a>        <span class="c1"># state probabilities</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-602"><a href="#StateTransitionGraph.calcSteadyStateProbs-602"><span class="linenos">602</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">b</span> <span class="o">@</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span> <span class="c1"># compute the matrix inverse</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-603"><a href="#StateTransitionGraph.calcSteadyStateProbs-603"><span class="linenos">603</span></a>            
</span><span id="StateTransitionGraph.calcSteadyStateProbs-604"><a href="#StateTransitionGraph.calcSteadyStateProbs-604"><span class="linenos">604</span></a>        <span class="c1"># Generate a matrix with P(X,Y)</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-605"><a href="#StateTransitionGraph.calcSteadyStateProbs-605"><span class="linenos">605</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-606"><a href="#StateTransitionGraph.calcSteadyStateProbs-606"><span class="linenos">606</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-607"><a href="#StateTransitionGraph.calcSteadyStateProbs-607"><span class="linenos">607</span></a>            <span class="n">matrix</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">]</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-608"><a href="#StateTransitionGraph.calcSteadyStateProbs-608"><span class="linenos">608</span></a>        
</span><span id="StateTransitionGraph.calcSteadyStateProbs-609"><a href="#StateTransitionGraph.calcSteadyStateProbs-609"><span class="linenos">609</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-610"><a href="#StateTransitionGraph.calcSteadyStateProbs-610"><span class="linenos">610</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Steady-state probabilities X&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-611"><a href="#StateTransitionGraph.calcSteadyStateProbs-611"><span class="linenos">611</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;X=</span><span class="se">\n</span><span class="si">{</span><span class="n">matrix</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-612"><a href="#StateTransitionGraph.calcSteadyStateProbs-612"><span class="linenos">612</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state_probabilities</span> <span class="o">=</span> <span class="n">matrix</span>
</span><span id="StateTransitionGraph.calcSteadyStateProbs-613"><a href="#StateTransitionGraph.calcSteadyStateProbs-613"><span class="linenos">613</span></a>        <span class="k">return</span> <span class="n">matrix</span>
</span></pre></div>


            <div class="docstring"><p>Compute the steady-state probabilities of the continuous-time Markov chain (CTMC).</p>

<p>This method calculates the stationary distribution of the CTMC defined by the rate
matrix of the state transition graph. The computation solves the linear system
<code>XQ = 0</code> with the constraint that the probabilities X sum to 1, using a modified
version of the rate matrix <code>Q</code>.</p>

<h2 id="parameters">Parameters</h2>

<p>verbose : bool, optional
    If True, prints the rate matrix, the modified matrix, the right-hand side vector,
    and the resulting steady-state probabilities.</p>

<h2 id="returns">Returns</h2>

<p>probs : dict
    A dictionary mapping each state (node in the graph) to its steady-state probability.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>The graph must already contain valid transition rates on its edges.</li>
<li>If the rate matrix has not yet been created, <code><a href="#StateTransitionGraph.createRateMatrix">createRateMatrix()</a></code> is called automatically.</li>
<li>The method modifies the last column of the rate matrix to impose the normalization constraint
<code>sum(X) = 1</code>.</li>
<li>The inverse of the modified matrix is computed directly, so the graph should be small enough
to avoid numerical instability or performance issues.</li>
<li>The resulting probabilities are stored internally in <code>_state_probabilities</code> and can be accessed
via the <code><a href="#StateTransitionGraph.state_probabilities">state_probabilities</a></code> property.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.calcTransitionProbabilities" class="classattr">
                                        <input id="StateTransitionGraph.calcTransitionProbabilities-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calcTransitionProbabilities</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.calcTransitionProbabilities-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.calcTransitionProbabilities"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.calcTransitionProbabilities-615"><a href="#StateTransitionGraph.calcTransitionProbabilities-615"><span class="linenos">615</span></a>    <span class="k">def</span> <span class="nf">calcTransitionProbabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-616"><a href="#StateTransitionGraph.calcTransitionProbabilities-616"><span class="linenos">616</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-617"><a href="#StateTransitionGraph.calcTransitionProbabilities-617"><span class="linenos">617</span></a><span class="sd">        Compute and store transition probabilities for each node in the graph of the embedded discrete Markov chain.</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-618"><a href="#StateTransitionGraph.calcTransitionProbabilities-618"><span class="linenos">618</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-619"><a href="#StateTransitionGraph.calcTransitionProbabilities-619"><span class="linenos">619</span></a><span class="sd">        This method processes each node in the graph, treating outgoing edges as</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-620"><a href="#StateTransitionGraph.calcTransitionProbabilities-620"><span class="linenos">620</span></a><span class="sd">        transitions in an embedded discrete-time Markov chain derived from a continuous-time</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-621"><a href="#StateTransitionGraph.calcTransitionProbabilities-621"><span class="linenos">621</span></a><span class="sd">        Markov chain (CTMC). Transition *rates* on outgoing edges are normalized into</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-622"><a href="#StateTransitionGraph.calcTransitionProbabilities-622"><span class="linenos">622</span></a><span class="sd">        *probabilities*, and relevant data is stored in the node attributes.</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-623"><a href="#StateTransitionGraph.calcTransitionProbabilities-623"><span class="linenos">623</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-624"><a href="#StateTransitionGraph.calcTransitionProbabilities-624"><span class="linenos">624</span></a><span class="sd">        For each node, the following attributes are set:</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-625"><a href="#StateTransitionGraph.calcTransitionProbabilities-625"><span class="linenos">625</span></a><span class="sd">        - `&quot;transitionProbs&quot;` : np.ndarray</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-626"><a href="#StateTransitionGraph.calcTransitionProbabilities-626"><span class="linenos">626</span></a><span class="sd">            Array of transition probabilities to successor nodes.</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-627"><a href="#StateTransitionGraph.calcTransitionProbabilities-627"><span class="linenos">627</span></a><span class="sd">        - `&quot;transitionNodes&quot;` : list</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-628"><a href="#StateTransitionGraph.calcTransitionProbabilities-628"><span class="linenos">628</span></a><span class="sd">            List of successor node identifiers (ordered as in the probability array).</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-629"><a href="#StateTransitionGraph.calcTransitionProbabilities-629"><span class="linenos">629</span></a><span class="sd">        - `&quot;sumOutgoingRates&quot;` : float</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-630"><a href="#StateTransitionGraph.calcTransitionProbabilities-630"><span class="linenos">630</span></a><span class="sd">            Sum of all outgoing transition rates. Used to model the exponential waiting time</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-631"><a href="#StateTransitionGraph.calcTransitionProbabilities-631"><span class="linenos">631</span></a><span class="sd">            in continuous-time simulation (`T ~ Exp(sumOutgoingRates)`).</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-632"><a href="#StateTransitionGraph.calcTransitionProbabilities-632"><span class="linenos">632</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-633"><a href="#StateTransitionGraph.calcTransitionProbabilities-633"><span class="linenos">633</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-634"><a href="#StateTransitionGraph.calcTransitionProbabilities-634"><span class="linenos">634</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-635"><a href="#StateTransitionGraph.calcTransitionProbabilities-635"><span class="linenos">635</span></a><span class="sd">        - The graph must be a directed graph where each edge has a `&#39;rate&#39;` attribute.</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-636"><a href="#StateTransitionGraph.calcTransitionProbabilities-636"><span class="linenos">636</span></a><span class="sd">        - Nodes with no outgoing edges are considered absorbing states.</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-637"><a href="#StateTransitionGraph.calcTransitionProbabilities-637"><span class="linenos">637</span></a><span class="sd">        - Useful for discrete-event simulation and Markov chain Monte Carlo (MCMC) modeling.</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-638"><a href="#StateTransitionGraph.calcTransitionProbabilities-638"><span class="linenos">638</span></a><span class="sd">        - Sets an internal flag `_transitionProbabilitesComputed = True` upon completion.</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-639"><a href="#StateTransitionGraph.calcTransitionProbabilities-639"><span class="linenos">639</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-640"><a href="#StateTransitionGraph.calcTransitionProbabilities-640"><span class="linenos">640</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-641"><a href="#StateTransitionGraph.calcTransitionProbabilities-641"><span class="linenos">641</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-642"><a href="#StateTransitionGraph.calcTransitionProbabilities-642"><span class="linenos">642</span></a><span class="sd">        KeyError</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-643"><a href="#StateTransitionGraph.calcTransitionProbabilities-643"><span class="linenos">643</span></a><span class="sd">            If any outgoing edge lacks a `&#39;rate&#39;` attribute.</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-644"><a href="#StateTransitionGraph.calcTransitionProbabilities-644"><span class="linenos">644</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-645"><a href="#StateTransitionGraph.calcTransitionProbabilities-645"><span class="linenos">645</span></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-646"><a href="#StateTransitionGraph.calcTransitionProbabilities-646"><span class="linenos">646</span></a>            <span class="n">successors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-647"><a href="#StateTransitionGraph.calcTransitionProbabilities-647"><span class="linenos">647</span></a>            <span class="n">rates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">nbr</span><span class="p">][</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">successors</span><span class="p">])</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-648"><a href="#StateTransitionGraph.calcTransitionProbabilities-648"><span class="linenos">648</span></a>            <span class="n">probs</span> <span class="o">=</span> <span class="n">rates</span> <span class="o">/</span> <span class="n">rates</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Normalize to probabilities</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-649"><a href="#StateTransitionGraph.calcTransitionProbabilities-649"><span class="linenos">649</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionProbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">probs</span> <span class="c1"># probabilities</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-650"><a href="#StateTransitionGraph.calcTransitionProbabilities-650"><span class="linenos">650</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionNodes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">successors</span> <span class="c1"># list of nodes</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-651"><a href="#StateTransitionGraph.calcTransitionProbabilities-651"><span class="linenos">651</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;sumOutgoingRates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rates</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># time in state ~ EXP(sumOutgoingRates)</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-652"><a href="#StateTransitionGraph.calcTransitionProbabilities-652"><span class="linenos">652</span></a>            <span class="n">numel</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">successors</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-653"><a href="#StateTransitionGraph.calcTransitionProbabilities-653"><span class="linenos">653</span></a>            <span class="k">if</span> <span class="n">numel</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
</span><span id="StateTransitionGraph.calcTransitionProbabilities-654"><a href="#StateTransitionGraph.calcTransitionProbabilities-654"><span class="linenos">654</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absorbing state: </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcTransitionProbabilities-655"><a href="#StateTransitionGraph.calcTransitionProbabilities-655"><span class="linenos">655</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transitionProbabilitesComputed</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Compute and store transition probabilities for each node in the graph of the embedded discrete Markov chain.</p>

<p>This method processes each node in the graph, treating outgoing edges as
transitions in an embedded discrete-time Markov chain derived from a continuous-time
Markov chain (CTMC). Transition <em>rates</em> on outgoing edges are normalized into
<em>probabilities</em>, and relevant data is stored in the node attributes.</p>

<p>For each node, the following attributes are set:</p>

<ul>
<li><code>"transitionProbs"</code> : np.ndarray
Array of transition probabilities to successor nodes.</li>
<li><code>"transitionNodes"</code> : list
List of successor node identifiers (ordered as in the probability array).</li>
<li><code>"sumOutgoingRates"</code> : float
Sum of all outgoing transition rates. Used to model the exponential waiting time
in continuous-time simulation (<code>T ~ Exp(sumOutgoingRates)</code>).</li>
</ul>

<h2 id="notes">Notes</h2>

<ul>
<li>The graph must be a directed graph where each edge has a <code>'rate'</code> attribute.</li>
<li>Nodes with no outgoing edges are considered absorbing states.</li>
<li>Useful for discrete-event simulation and Markov chain Monte Carlo (MCMC) modeling.</li>
<li>Sets an internal flag <code>_transitionProbabilitesComputed = True</code> upon completion.</li>
</ul>

<h2 id="raises">Raises</h2>

<p>KeyError
    If any outgoing edge lacks a <code>'rate'</code> attribute.</p>
</div>


                            </div>
                            <div id="StateTransitionGraph.simulateMarkovModel" class="classattr">
                                        <input id="StateTransitionGraph.simulateMarkovModel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">simulateMarkovModel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">startNode</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">numEvents</span><span class="o">=</span><span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.simulateMarkovModel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.simulateMarkovModel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.simulateMarkovModel-657"><a href="#StateTransitionGraph.simulateMarkovModel-657"><span class="linenos">657</span></a>    <span class="k">def</span> <span class="nf">simulateMarkovModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startNode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numEvents</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-658"><a href="#StateTransitionGraph.simulateMarkovModel-658"><span class="linenos">658</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-659"><a href="#StateTransitionGraph.simulateMarkovModel-659"><span class="linenos">659</span></a><span class="sd">        Simulate a trajectory through the state transition graph as a continuous-time Markov chain (CTMC).</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-660"><a href="#StateTransitionGraph.simulateMarkovModel-660"><span class="linenos">660</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph.simulateMarkovModel-661"><a href="#StateTransitionGraph.simulateMarkovModel-661"><span class="linenos">661</span></a><span class="sd">        This method performs a discrete-event simulation of the CTMC by generating a random walk</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-662"><a href="#StateTransitionGraph.simulateMarkovModel-662"><span class="linenos">662</span></a><span class="sd">        through the graph, starting at `startNode` (or a default node if not specified). Transitions</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-663"><a href="#StateTransitionGraph.simulateMarkovModel-663"><span class="linenos">663</span></a><span class="sd">        are chosen based on the normalized transition probabilities computed from edge rates, and</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-664"><a href="#StateTransitionGraph.simulateMarkovModel-664"><span class="linenos">664</span></a><span class="sd">        dwell times are sampled from exponential distributions based on the total outgoing rate</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-665"><a href="#StateTransitionGraph.simulateMarkovModel-665"><span class="linenos">665</span></a><span class="sd">        from each state.</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-666"><a href="#StateTransitionGraph.simulateMarkovModel-666"><span class="linenos">666</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph.simulateMarkovModel-667"><a href="#StateTransitionGraph.simulateMarkovModel-667"><span class="linenos">667</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-668"><a href="#StateTransitionGraph.simulateMarkovModel-668"><span class="linenos">668</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-669"><a href="#StateTransitionGraph.simulateMarkovModel-669"><span class="linenos">669</span></a><span class="sd">        - startNode : hashable, optional</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-670"><a href="#StateTransitionGraph.simulateMarkovModel-670"><span class="linenos">670</span></a><span class="sd">            The node at which the simulation starts. If not specified, the first node in the graph</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-671"><a href="#StateTransitionGraph.simulateMarkovModel-671"><span class="linenos">671</span></a><span class="sd">            (based on insertion order) is used.</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-672"><a href="#StateTransitionGraph.simulateMarkovModel-672"><span class="linenos">672</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph.simulateMarkovModel-673"><a href="#StateTransitionGraph.simulateMarkovModel-673"><span class="linenos">673</span></a><span class="sd">        - numEvents : int, optional</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-674"><a href="#StateTransitionGraph.simulateMarkovModel-674"><span class="linenos">674</span></a><span class="sd">            The number of transition events (steps) to simulate. Default is 10.</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-675"><a href="#StateTransitionGraph.simulateMarkovModel-675"><span class="linenos">675</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph.simulateMarkovModel-676"><a href="#StateTransitionGraph.simulateMarkovModel-676"><span class="linenos">676</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-677"><a href="#StateTransitionGraph.simulateMarkovModel-677"><span class="linenos">677</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-678"><a href="#StateTransitionGraph.simulateMarkovModel-678"><span class="linenos">678</span></a><span class="sd">        states : list</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-679"><a href="#StateTransitionGraph.simulateMarkovModel-679"><span class="linenos">679</span></a><span class="sd">            A list of visited states, representing the sequence of nodes traversed in the simulation.</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-680"><a href="#StateTransitionGraph.simulateMarkovModel-680"><span class="linenos">680</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph.simulateMarkovModel-681"><a href="#StateTransitionGraph.simulateMarkovModel-681"><span class="linenos">681</span></a><span class="sd">        times : numpy.ndarray</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-682"><a href="#StateTransitionGraph.simulateMarkovModel-682"><span class="linenos">682</span></a><span class="sd">            An array of dwell times in each state, sampled from exponential distributions</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-683"><a href="#StateTransitionGraph.simulateMarkovModel-683"><span class="linenos">683</span></a><span class="sd">            with rate equal to the sum of outgoing transition rates from each state.</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-684"><a href="#StateTransitionGraph.simulateMarkovModel-684"><span class="linenos">684</span></a><span class="sd">        </span>
</span><span id="StateTransitionGraph.simulateMarkovModel-685"><a href="#StateTransitionGraph.simulateMarkovModel-685"><span class="linenos">685</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-686"><a href="#StateTransitionGraph.simulateMarkovModel-686"><span class="linenos">686</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-687"><a href="#StateTransitionGraph.simulateMarkovModel-687"><span class="linenos">687</span></a><span class="sd">        - This method automatically calls `calcTransitionProbabilities()` if transition probabilities</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-688"><a href="#StateTransitionGraph.simulateMarkovModel-688"><span class="linenos">688</span></a><span class="sd">          have not yet been computed.</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-689"><a href="#StateTransitionGraph.simulateMarkovModel-689"><span class="linenos">689</span></a><span class="sd">        - If an absorbing state (i.e., a node with no outgoing edges) is reached, the simulation stops early.</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-690"><a href="#StateTransitionGraph.simulateMarkovModel-690"><span class="linenos">690</span></a><span class="sd">        - The cumulative time can be obtained by `np.cumsum(times)`.</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-691"><a href="#StateTransitionGraph.simulateMarkovModel-691"><span class="linenos">691</span></a><span class="sd">        - State durations follow `Exp(sumOutgoingRates)` distributions per CTMC theory.</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-692"><a href="#StateTransitionGraph.simulateMarkovModel-692"><span class="linenos">692</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-693"><a href="#StateTransitionGraph.simulateMarkovModel-693"><span class="linenos">693</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transitionProbabilitesComputed</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcTransitionProbabilities</span><span class="p">()</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-694"><a href="#StateTransitionGraph.simulateMarkovModel-694"><span class="linenos">694</span></a>        
</span><span id="StateTransitionGraph.simulateMarkovModel-695"><a href="#StateTransitionGraph.simulateMarkovModel-695"><span class="linenos">695</span></a>        <span class="c1"># simulate random walk through Graph = Markov Chain</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-696"><a href="#StateTransitionGraph.simulateMarkovModel-696"><span class="linenos">696</span></a>        <span class="k">if</span> <span class="n">startNode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-697"><a href="#StateTransitionGraph.simulateMarkovModel-697"><span class="linenos">697</span></a>            <span class="n">startNode</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-698"><a href="#StateTransitionGraph.simulateMarkovModel-698"><span class="linenos">698</span></a>        
</span><span id="StateTransitionGraph.simulateMarkovModel-699"><a href="#StateTransitionGraph.simulateMarkovModel-699"><span class="linenos">699</span></a>
</span><span id="StateTransitionGraph.simulateMarkovModel-700"><a href="#StateTransitionGraph.simulateMarkovModel-700"><span class="linenos">700</span></a>        <span class="n">states</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># list of states</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-701"><a href="#StateTransitionGraph.simulateMarkovModel-701"><span class="linenos">701</span></a>        <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numEvents</span><span class="p">)</span> <span class="c1"># time per state</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-702"><a href="#StateTransitionGraph.simulateMarkovModel-702"><span class="linenos">702</span></a>
</span><span id="StateTransitionGraph.simulateMarkovModel-703"><a href="#StateTransitionGraph.simulateMarkovModel-703"><span class="linenos">703</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="n">startNode</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-704"><a href="#StateTransitionGraph.simulateMarkovModel-704"><span class="linenos">704</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numEvents</span><span class="p">):</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-705"><a href="#StateTransitionGraph.simulateMarkovModel-705"><span class="linenos">705</span></a>            <span class="n">outgoingRate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;sumOutgoingRates&quot;</span><span class="p">]</span>  <span class="c1"># time in state ~ EXP(sumOutgoingRates)</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-706"><a href="#StateTransitionGraph.simulateMarkovModel-706"><span class="linenos">706</span></a>            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="n">outgoingRate</span><span class="p">)</span> <span class="c1"># exponentially distributed time in state</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-707"><a href="#StateTransitionGraph.simulateMarkovModel-707"><span class="linenos">707</span></a>            <span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-708"><a href="#StateTransitionGraph.simulateMarkovModel-708"><span class="linenos">708</span></a>            
</span><span id="StateTransitionGraph.simulateMarkovModel-709"><a href="#StateTransitionGraph.simulateMarkovModel-709"><span class="linenos">709</span></a>            <span class="c1"># get next node    </span>
</span><span id="StateTransitionGraph.simulateMarkovModel-710"><a href="#StateTransitionGraph.simulateMarkovModel-710"><span class="linenos">710</span></a>            <span class="n">probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionProbs&quot;</span><span class="p">]</span> <span class="c1"># probabilities</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-711"><a href="#StateTransitionGraph.simulateMarkovModel-711"><span class="linenos">711</span></a>            <span class="n">successors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;transitionNodes&quot;</span><span class="p">]</span> <span class="c1"># list of nodes        </span>
</span><span id="StateTransitionGraph.simulateMarkovModel-712"><a href="#StateTransitionGraph.simulateMarkovModel-712"><span class="linenos">712</span></a>            <span class="n">numel</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">successors</span><span class="p">)</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-713"><a href="#StateTransitionGraph.simulateMarkovModel-713"><span class="linenos">713</span></a>            <span class="k">if</span> <span class="n">numel</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
</span><span id="StateTransitionGraph.simulateMarkovModel-714"><a href="#StateTransitionGraph.simulateMarkovModel-714"><span class="linenos">714</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absorbing state: </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-715"><a href="#StateTransitionGraph.simulateMarkovModel-715"><span class="linenos">715</span></a>                <span class="k">break</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-716"><a href="#StateTransitionGraph.simulateMarkovModel-716"><span class="linenos">716</span></a>            <span class="k">elif</span> <span class="n">numel</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-717"><a href="#StateTransitionGraph.simulateMarkovModel-717"><span class="linenos">717</span></a>                <span class="n">nextNode</span> <span class="o">=</span> <span class="n">successors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-718"><a href="#StateTransitionGraph.simulateMarkovModel-718"><span class="linenos">718</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-719"><a href="#StateTransitionGraph.simulateMarkovModel-719"><span class="linenos">719</span></a>                <span class="n">nextNode</span> <span class="o">=</span> <span class="n">successors</span><span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">numel</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probs</span><span class="p">)</span> <span class="p">]</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-720"><a href="#StateTransitionGraph.simulateMarkovModel-720"><span class="linenos">720</span></a>            <span class="c1"># edge = G[node][nextNode]</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-721"><a href="#StateTransitionGraph.simulateMarkovModel-721"><span class="linenos">721</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="n">nextNode</span>
</span><span id="StateTransitionGraph.simulateMarkovModel-722"><a href="#StateTransitionGraph.simulateMarkovModel-722"><span class="linenos">722</span></a>            
</span><span id="StateTransitionGraph.simulateMarkovModel-723"><a href="#StateTransitionGraph.simulateMarkovModel-723"><span class="linenos">723</span></a>        <span class="k">return</span> <span class="n">states</span><span class="p">,</span> <span class="n">times</span>
</span></pre></div>


            <div class="docstring"><p>Simulate a trajectory through the state transition graph as a continuous-time Markov chain (CTMC).</p>

<p>This method performs a discrete-event simulation of the CTMC by generating a random walk
through the graph, starting at <code>startNode</code> (or a default node if not specified). Transitions
are chosen based on the normalized transition probabilities computed from edge rates, and
dwell times are sampled from exponential distributions based on the total outgoing rate
from each state.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><p>startNode : hashable, optional
The node at which the simulation starts. If not specified, the first node in the graph
(based on insertion order) is used.</p></li>
<li><p>numEvents : int, optional
The number of transition events (steps) to simulate. Default is 10.</p></li>
</ul>

<h2 id="returns">Returns</h2>

<p>states : list
    A list of visited states, representing the sequence of nodes traversed in the simulation.</p>

<p>times : numpy.ndarray
    An array of dwell times in each state, sampled from exponential distributions
    with rate equal to the sum of outgoing transition rates from each state.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>This method automatically calls <code><a href="#StateTransitionGraph.calcTransitionProbabilities">calcTransitionProbabilities()</a></code> if transition probabilities
have not yet been computed.</li>
<li>If an absorbing state (i.e., a node with no outgoing edges) is reached, the simulation stops early.</li>
<li>The cumulative time can be obtained by <code>np.cumsum(times)</code>.</li>
<li>State durations follow <code>Exp(sumOutgoingRates)</code> distributions per CTMC theory.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.calcProbabilitiesSimulationRun" class="classattr">
                                        <input id="StateTransitionGraph.calcProbabilitiesSimulationRun-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calcProbabilitiesSimulationRun</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">states</span>, </span><span class="param"><span class="n">times</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.calcProbabilitiesSimulationRun-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.calcProbabilitiesSimulationRun"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-725"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-725"><span class="linenos">725</span></a>    <span class="k">def</span> <span class="nf">calcProbabilitiesSimulationRun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">times</span><span class="p">):</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-726"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-726"><span class="linenos">726</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-727"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-727"><span class="linenos">727</span></a><span class="sd">        Estimate empirical state probabilities from a simulation run of the CTMC.</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-728"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-728"><span class="linenos">728</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-729"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-729"><span class="linenos">729</span></a><span class="sd">        This method computes the fraction of total time spent in each state during a simulation.</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-730"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-730"><span class="linenos">730</span></a><span class="sd">        It uses the sequence of visited states and corresponding sojourn times to estimate the</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-731"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-731"><span class="linenos">731</span></a><span class="sd">        empirical (time-weighted) probability distribution over states.</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-732"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-732"><span class="linenos">732</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-733"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-733"><span class="linenos">733</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-734"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-734"><span class="linenos">734</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-735"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-735"><span class="linenos">735</span></a><span class="sd">        - states : list of tuple</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-736"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-736"><span class="linenos">736</span></a><span class="sd">            A list of state identifiers visited during the simulation.    </span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-737"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-737"><span class="linenos">737</span></a><span class="sd">        - times : numpy.ndarray</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-738"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-738"><span class="linenos">738</span></a><span class="sd">            An array of sojourn times corresponding to each visited state, same length as `states`.</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-739"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-739"><span class="linenos">739</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-740"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-740"><span class="linenos">740</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-741"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-741"><span class="linenos">741</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-742"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-742"><span class="linenos">742</span></a><span class="sd">        simProbs : dict</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-743"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-743"><span class="linenos">743</span></a><span class="sd">            A dictionary mapping each unique state to its estimated empirical probability,</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-744"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-744"><span class="linenos">744</span></a><span class="sd">            based on total time spent in that state relative to the simulation duration.</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-745"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-745"><span class="linenos">745</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-746"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-746"><span class="linenos">746</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-747"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-747"><span class="linenos">747</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-748"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-748"><span class="linenos">748</span></a><span class="sd">        - Internally, states are mapped to flat indices for efficient counting using NumPy.</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-749"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-749"><span class="linenos">749</span></a><span class="sd">        - This method assumes that `states` contains only valid node identifiers from the graph.</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-750"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-750"><span class="linenos">750</span></a><span class="sd">        - If `_n2i` (node-to-index mapping) has not been initialized, it will be computed here.</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-751"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-751"><span class="linenos">751</span></a><span class="sd">        - This is especially useful for validating analytical steady-state probabilities</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-752"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-752"><span class="linenos">752</span></a><span class="sd">          against sampled simulation results. Or in case of state-space explosions.</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-753"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-753"><span class="linenos">753</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-754"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-754"><span class="linenos">754</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-755"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-755"><span class="linenos">755</span></a>            <span class="n">n2i</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-756"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-756"><span class="linenos">756</span></a>            <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-757"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-757"><span class="linenos">757</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-758"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-758"><span class="linenos">758</span></a>                <span class="n">n2i</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>     
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-759"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-759"><span class="linenos">759</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span> <span class="o">=</span> <span class="n">n2i</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-760"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-760"><span class="linenos">760</span></a>                
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-761"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-761"><span class="linenos">761</span></a>        
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-762"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-762"><span class="linenos">762</span></a>        <span class="c1"># Map tuples to flat indices</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-763"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-763"><span class="linenos">763</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-764"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-764"><span class="linenos">764</span></a>        <span class="n">max_vals</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-765"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-765"><span class="linenos">765</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel_multi_index</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">max_vals</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-766"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-766"><span class="linenos">766</span></a>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-767"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-767"><span class="linenos">767</span></a>        <span class="c1"># Weighted bincount</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-768"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-768"><span class="linenos">768</span></a>        <span class="n">bincount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-769"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-769"><span class="linenos">769</span></a>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-770"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-770"><span class="linenos">770</span></a>        <span class="c1"># Decode back to tuples</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-771"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-771"><span class="linenos">771</span></a>        <span class="n">tuple_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">bincount</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="n">max_vals</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-772"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-772"><span class="linenos">772</span></a>        <span class="n">timePerState</span> <span class="o">=</span> <span class="n">bincount</span><span class="p">[</span><span class="n">bincount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-773"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-773"><span class="linenos">773</span></a>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-774"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-774"><span class="linenos">774</span></a>        <span class="n">simProbs</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-775"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-775"><span class="linenos">775</span></a>        <span class="n">totalTime</span> <span class="o">=</span> <span class="n">times</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-776"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-776"><span class="linenos">776</span></a>        <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tuple_indices</span><span class="p">,</span> <span class="n">timePerState</span><span class="p">):</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-777"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-777"><span class="linenos">777</span></a>            <span class="n">simProbs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">totalTime</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-778"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-778"><span class="linenos">778</span></a>            <span class="c1">#print(f&quot;Tuple {tuple(t)} → weighted count: {c}&quot;)</span>
</span><span id="StateTransitionGraph.calcProbabilitiesSimulationRun-779"><a href="#StateTransitionGraph.calcProbabilitiesSimulationRun-779"><span class="linenos">779</span></a>        <span class="k">return</span> <span class="n">simProbs</span>
</span></pre></div>


            <div class="docstring"><p>Estimate empirical state probabilities from a simulation run of the CTMC.</p>

<p>This method computes the fraction of total time spent in each state during a simulation.
It uses the sequence of visited states and corresponding sojourn times to estimate the
empirical (time-weighted) probability distribution over states.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li>states : list of tuple
A list of state identifiers visited during the simulation.    </li>
<li>times : numpy.ndarray
An array of sojourn times corresponding to each visited state, same length as <code><a href="#StateTransitionGraph.states">states</a></code>.</li>
</ul>

<h2 id="returns">Returns</h2>

<p>simProbs : dict
    A dictionary mapping each unique state to its estimated empirical probability,
    based on total time spent in that state relative to the simulation duration.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Internally, states are mapped to flat indices for efficient counting using NumPy.</li>
<li>This method assumes that <code><a href="#StateTransitionGraph.states">states</a></code> contains only valid node identifiers from the graph.</li>
<li>If <code>_n2i</code> (node-to-index mapping) has not been initialized, it will be computed here.</li>
<li>This is especially useful for validating analytical steady-state probabilities
against sampled simulation results. Or in case of state-space explosions.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.drawTransitionGraph" class="classattr">
                                        <input id="StateTransitionGraph.drawTransitionGraph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">drawTransitionGraph</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">pos</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">bended</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span>,</span><span class="param">	<span class="n">num</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">rad</span><span class="o">=-</span><span class="mf">0.2</span>,</span><span class="param">	<span class="n">edge_labels</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">node_shapes</span><span class="o">=</span><span class="s1">&#39;o&#39;</span>,</span><span class="param">	<span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>,</span><span class="param">	<span class="n">clear</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">fontcolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>,</span><span class="param">	<span class="n">label_pos</span><span class="o">=</span><span class="mf">0.75</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.drawTransitionGraph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.drawTransitionGraph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.drawTransitionGraph-929"><a href="#StateTransitionGraph.drawTransitionGraph-929"><span class="linenos"> 929</span></a>    <span class="k">def</span> <span class="nf">drawTransitionGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="StateTransitionGraph.drawTransitionGraph-930"><a href="#StateTransitionGraph.drawTransitionGraph-930"><span class="linenos"> 930</span></a>                        <span class="n">bended</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rad</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-931"><a href="#StateTransitionGraph.drawTransitionGraph-931"><span class="linenos"> 931</span></a>                        <span class="n">edge_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_shapes</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-932"><a href="#StateTransitionGraph.drawTransitionGraph-932"><span class="linenos"> 932</span></a>                        <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-933"><a href="#StateTransitionGraph.drawTransitionGraph-933"><span class="linenos"> 933</span></a>                        <span class="n">fontcolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.75</span><span class="p">):</span>        
</span><span id="StateTransitionGraph.drawTransitionGraph-934"><a href="#StateTransitionGraph.drawTransitionGraph-934"><span class="linenos"> 934</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-935"><a href="#StateTransitionGraph.drawTransitionGraph-935"><span class="linenos"> 935</span></a><span class="sd">        Visualize the state transition graph with nodes and directed edges.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-936"><a href="#StateTransitionGraph.drawTransitionGraph-936"><span class="linenos"> 936</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-937"><a href="#StateTransitionGraph.drawTransitionGraph-937"><span class="linenos"> 937</span></a><span class="sd">        This method draws the graph using `matplotlib` and `networkx`, including labels,</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-938"><a href="#StateTransitionGraph.drawTransitionGraph-938"><span class="linenos"> 938</span></a><span class="sd">        node colors, and optional curved (bended) edges for better visualization of</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-939"><a href="#StateTransitionGraph.drawTransitionGraph-939"><span class="linenos"> 939</span></a><span class="sd">        bidirectional transitions. It supports layout customization and is useful for</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-940"><a href="#StateTransitionGraph.drawTransitionGraph-940"><span class="linenos"> 940</span></a><span class="sd">        understanding the structure of the Markov model.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-941"><a href="#StateTransitionGraph.drawTransitionGraph-941"><span class="linenos"> 941</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-942"><a href="#StateTransitionGraph.drawTransitionGraph-942"><span class="linenos"> 942</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-943"><a href="#StateTransitionGraph.drawTransitionGraph-943"><span class="linenos"> 943</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-944"><a href="#StateTransitionGraph.drawTransitionGraph-944"><span class="linenos"> 944</span></a><span class="sd">        pos : dict, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-945"><a href="#StateTransitionGraph.drawTransitionGraph-945"><span class="linenos"> 945</span></a><span class="sd">            A dictionary mapping nodes to positions. If None, a Kamada-Kawai layout is used.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-946"><a href="#StateTransitionGraph.drawTransitionGraph-946"><span class="linenos"> 946</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-947"><a href="#StateTransitionGraph.drawTransitionGraph-947"><span class="linenos"> 947</span></a><span class="sd">        bended : bool, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-948"><a href="#StateTransitionGraph.drawTransitionGraph-948"><span class="linenos"> 948</span></a><span class="sd">            If True, edges are drawn with curvature using arcs. Useful for distinguishing</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-949"><a href="#StateTransitionGraph.drawTransitionGraph-949"><span class="linenos"> 949</span></a><span class="sd">            bidirectional transitions. Default is False.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-950"><a href="#StateTransitionGraph.drawTransitionGraph-950"><span class="linenos"> 950</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-951"><a href="#StateTransitionGraph.drawTransitionGraph-951"><span class="linenos"> 951</span></a><span class="sd">        node_size : int, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-952"><a href="#StateTransitionGraph.drawTransitionGraph-952"><span class="linenos"> 952</span></a><span class="sd">            Size of the nodes in the plot. Default is 1000.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-953"><a href="#StateTransitionGraph.drawTransitionGraph-953"><span class="linenos"> 953</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-954"><a href="#StateTransitionGraph.drawTransitionGraph-954"><span class="linenos"> 954</span></a><span class="sd">        num : int, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-955"><a href="#StateTransitionGraph.drawTransitionGraph-955"><span class="linenos"> 955</span></a><span class="sd">            Figure number for matplotlib (useful for managing multiple figures). Default is 1.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-956"><a href="#StateTransitionGraph.drawTransitionGraph-956"><span class="linenos"> 956</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-957"><a href="#StateTransitionGraph.drawTransitionGraph-957"><span class="linenos"> 957</span></a><span class="sd">        rad : float, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-958"><a href="#StateTransitionGraph.drawTransitionGraph-958"><span class="linenos"> 958</span></a><span class="sd">            The curvature radius for bended edges. Only used if `bended=True`. Default is -0.2.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-959"><a href="#StateTransitionGraph.drawTransitionGraph-959"><span class="linenos"> 959</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-960"><a href="#StateTransitionGraph.drawTransitionGraph-960"><span class="linenos"> 960</span></a><span class="sd">        edge_labels : dict, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-961"><a href="#StateTransitionGraph.drawTransitionGraph-961"><span class="linenos"> 961</span></a><span class="sd">            Optional dictionary mapping edges `(u, v)` to labels. If None, the `&#39;label&#39;`</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-962"><a href="#StateTransitionGraph.drawTransitionGraph-962"><span class="linenos"> 962</span></a><span class="sd">            attribute from each edge is used.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-963"><a href="#StateTransitionGraph.drawTransitionGraph-963"><span class="linenos"> 963</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-964"><a href="#StateTransitionGraph.drawTransitionGraph-964"><span class="linenos"> 964</span></a><span class="sd">        node_shapes : str, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-965"><a href="#StateTransitionGraph.drawTransitionGraph-965"><span class="linenos"> 965</span></a><span class="sd">            Shape of the nodes (e.g., `&#39;o&#39;` for circle, `&#39;s&#39;` for square). Default is `&#39;o&#39;`.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-966"><a href="#StateTransitionGraph.drawTransitionGraph-966"><span class="linenos"> 966</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-967"><a href="#StateTransitionGraph.drawTransitionGraph-967"><span class="linenos"> 967</span></a><span class="sd">        figsize : tuple, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-968"><a href="#StateTransitionGraph.drawTransitionGraph-968"><span class="linenos"> 968</span></a><span class="sd">            Size of the matplotlib figure. Default is (14, 7).</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-969"><a href="#StateTransitionGraph.drawTransitionGraph-969"><span class="linenos"> 969</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-970"><a href="#StateTransitionGraph.drawTransitionGraph-970"><span class="linenos"> 970</span></a><span class="sd">        clear : bool, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-971"><a href="#StateTransitionGraph.drawTransitionGraph-971"><span class="linenos"> 971</span></a><span class="sd">            If True, clears the figure before plotting. Default is True.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-972"><a href="#StateTransitionGraph.drawTransitionGraph-972"><span class="linenos"> 972</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-973"><a href="#StateTransitionGraph.drawTransitionGraph-973"><span class="linenos"> 973</span></a><span class="sd">        fontsize : int, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-974"><a href="#StateTransitionGraph.drawTransitionGraph-974"><span class="linenos"> 974</span></a><span class="sd">            Font size used for node labels. Default is 10.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-975"><a href="#StateTransitionGraph.drawTransitionGraph-975"><span class="linenos"> 975</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-976"><a href="#StateTransitionGraph.drawTransitionGraph-976"><span class="linenos"> 976</span></a><span class="sd">        fontcolor : str, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-977"><a href="#StateTransitionGraph.drawTransitionGraph-977"><span class="linenos"> 977</span></a><span class="sd">            Font color for node labels. Default is `&#39;black&#39;`.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-978"><a href="#StateTransitionGraph.drawTransitionGraph-978"><span class="linenos"> 978</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-979"><a href="#StateTransitionGraph.drawTransitionGraph-979"><span class="linenos"> 979</span></a><span class="sd">        label_pos : float, optional</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-980"><a href="#StateTransitionGraph.drawTransitionGraph-980"><span class="linenos"> 980</span></a><span class="sd">            Position of edge labels along the edge (0=start, 1=end). Default is 0.75.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-981"><a href="#StateTransitionGraph.drawTransitionGraph-981"><span class="linenos"> 981</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-982"><a href="#StateTransitionGraph.drawTransitionGraph-982"><span class="linenos"> 982</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-983"><a href="#StateTransitionGraph.drawTransitionGraph-983"><span class="linenos"> 983</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-984"><a href="#StateTransitionGraph.drawTransitionGraph-984"><span class="linenos"> 984</span></a><span class="sd">        fig : matplotlib.figure.Figure</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-985"><a href="#StateTransitionGraph.drawTransitionGraph-985"><span class="linenos"> 985</span></a><span class="sd">            The created matplotlib figure object.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-986"><a href="#StateTransitionGraph.drawTransitionGraph-986"><span class="linenos"> 986</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-987"><a href="#StateTransitionGraph.drawTransitionGraph-987"><span class="linenos"> 987</span></a><span class="sd">        ax : matplotlib.axes.Axes</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-988"><a href="#StateTransitionGraph.drawTransitionGraph-988"><span class="linenos"> 988</span></a><span class="sd">            The axes object where the graph is drawn.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-989"><a href="#StateTransitionGraph.drawTransitionGraph-989"><span class="linenos"> 989</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-990"><a href="#StateTransitionGraph.drawTransitionGraph-990"><span class="linenos"> 990</span></a><span class="sd">        pos : dict</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-991"><a href="#StateTransitionGraph.drawTransitionGraph-991"><span class="linenos"> 991</span></a><span class="sd">            The dictionary of node positions used for drawing.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-992"><a href="#StateTransitionGraph.drawTransitionGraph-992"><span class="linenos"> 992</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-993"><a href="#StateTransitionGraph.drawTransitionGraph-993"><span class="linenos"> 993</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-994"><a href="#StateTransitionGraph.drawTransitionGraph-994"><span class="linenos"> 994</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-995"><a href="#StateTransitionGraph.drawTransitionGraph-995"><span class="linenos"> 995</span></a><span class="sd">        - Node labels and colors must be set beforehand using `addState()` or `setStateProperties()`.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-996"><a href="#StateTransitionGraph.drawTransitionGraph-996"><span class="linenos"> 996</span></a><span class="sd">        - Edge attributes must include `&#39;label&#39;` and `&#39;color&#39;`.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-997"><a href="#StateTransitionGraph.drawTransitionGraph-997"><span class="linenos"> 997</span></a><span class="sd">        - This method modifies the current matplotlib figure and is intended for interactive or inline use.</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-998"><a href="#StateTransitionGraph.drawTransitionGraph-998"><span class="linenos"> 998</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph.drawTransitionGraph-999"><a href="#StateTransitionGraph.drawTransitionGraph-999"><span class="linenos"> 999</span></a>        <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>        
</span><span id="StateTransitionGraph.drawTransitionGraph-1000"><a href="#StateTransitionGraph.drawTransitionGraph-1000"><span class="linenos">1000</span></a>        <span class="n">node_colors</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>        
</span><span id="StateTransitionGraph.drawTransitionGraph-1001"><a href="#StateTransitionGraph.drawTransitionGraph-1001"><span class="linenos">1001</span></a>        <span class="n">node_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1002"><a href="#StateTransitionGraph.drawTransitionGraph-1002"><span class="linenos">1002</span></a>        <span class="c1">#node_shapes = {(hw,sw): &quot;o&quot; if hw+sw&lt;G.N else &quot;s&quot; for hw,sw in G.nodes()}        </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1003"><a href="#StateTransitionGraph.drawTransitionGraph-1003"><span class="linenos">1003</span></a>            
</span><span id="StateTransitionGraph.drawTransitionGraph-1004"><a href="#StateTransitionGraph.drawTransitionGraph-1004"><span class="linenos">1004</span></a>        <span class="n">edge_cols</span> <span class="o">=</span> <span class="p">{(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span> <span class="bp">self</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1005"><a href="#StateTransitionGraph.drawTransitionGraph-1005"><span class="linenos">1005</span></a>            
</span><span id="StateTransitionGraph.drawTransitionGraph-1006"><a href="#StateTransitionGraph.drawTransitionGraph-1006"><span class="linenos">1006</span></a>        <span class="k">if</span> <span class="n">edge_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1007"><a href="#StateTransitionGraph.drawTransitionGraph-1007"><span class="linenos">1007</span></a>            <span class="n">edge_labels</span> <span class="o">=</span> <span class="p">{(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span> <span class="bp">self</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1008"><a href="#StateTransitionGraph.drawTransitionGraph-1008"><span class="linenos">1008</span></a>            
</span><span id="StateTransitionGraph.drawTransitionGraph-1009"><a href="#StateTransitionGraph.drawTransitionGraph-1009"><span class="linenos">1009</span></a>        <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1010"><a href="#StateTransitionGraph.drawTransitionGraph-1010"><span class="linenos">1010</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">kamada_kawai_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    
</span><span id="StateTransitionGraph.drawTransitionGraph-1011"><a href="#StateTransitionGraph.drawTransitionGraph-1011"><span class="linenos">1011</span></a>            
</span><span id="StateTransitionGraph.drawTransitionGraph-1012"><a href="#StateTransitionGraph.drawTransitionGraph-1012"><span class="linenos">1012</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="n">clear</span><span class="p">)</span>                        
</span><span id="StateTransitionGraph.drawTransitionGraph-1013"><a href="#StateTransitionGraph.drawTransitionGraph-1013"><span class="linenos">1013</span></a>        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span> <span class="n">node_shape</span> <span class="o">=</span> <span class="n">node_shapes</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">)</span>                    
</span><span id="StateTransitionGraph.drawTransitionGraph-1014"><a href="#StateTransitionGraph.drawTransitionGraph-1014"><span class="linenos">1014</span></a>        
</span><span id="StateTransitionGraph.drawTransitionGraph-1015"><a href="#StateTransitionGraph.drawTransitionGraph-1015"><span class="linenos">1015</span></a>        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="n">fontcolor</span><span class="p">)</span>  <span class="c1"># Draw node labels</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1016"><a href="#StateTransitionGraph.drawTransitionGraph-1016"><span class="linenos">1016</span></a>        <span class="k">if</span> <span class="n">bended</span><span class="p">:</span> 
</span><span id="StateTransitionGraph.drawTransitionGraph-1017"><a href="#StateTransitionGraph.drawTransitionGraph-1017"><span class="linenos">1017</span></a>            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>  <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="p">[</span><span class="n">edge_cols</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">],</span> 
</span><span id="StateTransitionGraph.drawTransitionGraph-1018"><a href="#StateTransitionGraph.drawTransitionGraph-1018"><span class="linenos">1018</span></a>                                   <span class="n">node_size</span> <span class="o">=</span> <span class="n">node_size</span><span class="p">,</span> 
</span><span id="StateTransitionGraph.drawTransitionGraph-1019"><a href="#StateTransitionGraph.drawTransitionGraph-1019"><span class="linenos">1019</span></a>                                   <span class="n">arrows</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">arrowstyle</span> <span class="o">=</span> <span class="s1">&#39;-|&gt;&#39;</span><span class="p">,</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1020"><a href="#StateTransitionGraph.drawTransitionGraph-1020"><span class="linenos">1020</span></a>                                   <span class="n">connectionstyle</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;arc3,rad=</span><span class="si">{</span><span class="n">rad</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>        
</span><span id="StateTransitionGraph.drawTransitionGraph-1021"><a href="#StateTransitionGraph.drawTransitionGraph-1021"><span class="linenos">1021</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_draw_networkx_edge_labels</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">,</span><span class="n">rotate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rad</span> <span class="o">=</span> <span class="n">rad</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="n">label_pos</span><span class="p">)</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1022"><a href="#StateTransitionGraph.drawTransitionGraph-1022"><span class="linenos">1022</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1023"><a href="#StateTransitionGraph.drawTransitionGraph-1023"><span class="linenos">1023</span></a>            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>  <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="p">[</span><span class="n">edge_cols</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">],</span> 
</span><span id="StateTransitionGraph.drawTransitionGraph-1024"><a href="#StateTransitionGraph.drawTransitionGraph-1024"><span class="linenos">1024</span></a>                               <span class="n">node_size</span> <span class="o">=</span> <span class="n">node_size</span><span class="p">,</span> 
</span><span id="StateTransitionGraph.drawTransitionGraph-1025"><a href="#StateTransitionGraph.drawTransitionGraph-1025"><span class="linenos">1025</span></a>                               <span class="c1">#min_target_margin=17, arrowsize=15,</span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1026"><a href="#StateTransitionGraph.drawTransitionGraph-1026"><span class="linenos">1026</span></a>                               <span class="n">arrows</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">arrowstyle</span> <span class="o">=</span> <span class="s1">&#39;-|&gt;&#39;</span><span class="p">)</span>                           
</span><span id="StateTransitionGraph.drawTransitionGraph-1027"><a href="#StateTransitionGraph.drawTransitionGraph-1027"><span class="linenos">1027</span></a>            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="n">label_pos</span><span class="p">)</span> <span class="c1">#, verticalalignment=&#39;center&#39;,)        </span>
</span><span id="StateTransitionGraph.drawTransitionGraph-1028"><a href="#StateTransitionGraph.drawTransitionGraph-1028"><span class="linenos">1028</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>    
</span><span id="StateTransitionGraph.drawTransitionGraph-1029"><a href="#StateTransitionGraph.drawTransitionGraph-1029"><span class="linenos">1029</span></a>        
</span><span id="StateTransitionGraph.drawTransitionGraph-1030"><a href="#StateTransitionGraph.drawTransitionGraph-1030"><span class="linenos">1030</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">(),</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">pos</span>
</span></pre></div>


            <div class="docstring"><p>Visualize the state transition graph with nodes and directed edges.</p>

<p>This method draws the graph using <code>matplotlib</code> and <code>networkx</code>, including labels,
node colors, and optional curved (bended) edges for better visualization of
bidirectional transitions. It supports layout customization and is useful for
understanding the structure of the Markov model.</p>

<h2 id="parameters">Parameters</h2>

<p>pos : dict, optional
    A dictionary mapping nodes to positions. If None, a Kamada-Kawai layout is used.</p>

<p>bended : bool, optional
    If True, edges are drawn with curvature using arcs. Useful for distinguishing
    bidirectional transitions. Default is False.</p>

<p>node_size : int, optional
    Size of the nodes in the plot. Default is 1000.</p>

<p>num : int, optional
    Figure number for matplotlib (useful for managing multiple figures). Default is 1.</p>

<p>rad : float, optional
    The curvature radius for bended edges. Only used if <code>bended=True</code>. Default is -0.2.</p>

<p>edge_labels : dict, optional
    Optional dictionary mapping edges <code>(u, v)</code> to labels. If None, the <code>'label'</code>
    attribute from each edge is used.</p>

<p>node_shapes : str, optional
    Shape of the nodes (e.g., <code>'o'</code> for circle, <code>'s'</code> for square). Default is <code>'o'</code>.</p>

<p>figsize : tuple, optional
    Size of the matplotlib figure. Default is (14, 7).</p>

<p>clear : bool, optional
    If True, clears the figure before plotting. Default is True.</p>

<p>fontsize : int, optional
    Font size used for node labels. Default is 10.</p>

<p>fontcolor : str, optional
    Font color for node labels. Default is <code>'black'</code>.</p>

<p>label_pos : float, optional
    Position of edge labels along the edge (0=start, 1=end). Default is 0.75.</p>

<h2 id="returns">Returns</h2>

<p>fig : matplotlib.figure.Figure
    The created matplotlib figure object.</p>

<p>ax : matplotlib.axes.Axes
    The axes object where the graph is drawn.</p>

<p>pos : dict
    The dictionary of node positions used for drawing.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Node labels and colors must be set beforehand using <code><a href="#StateTransitionGraph.addState">addState()</a></code> or <code><a href="#StateTransitionGraph.setStateProperties">setStateProperties()</a></code>.</li>
<li>Edge attributes must include <code>'label'</code> and <code>'color'</code>.</li>
<li>This method modifies the current matplotlib figure and is intended for interactive or inline use.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.animateSimulation" class="classattr">
                                        <input id="StateTransitionGraph.animateSimulation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">animateSimulation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">expectedTimePerState</span><span class="o">=</span><span class="mi">1</span>, </span><span class="param"><span class="n">inNotebook</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.animateSimulation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.animateSimulation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.animateSimulation-1032"><a href="#StateTransitionGraph.animateSimulation-1032"><span class="linenos">1032</span></a>    <span class="k">def</span> <span class="nf">animateSimulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expectedTimePerState</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inNotebook</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="StateTransitionGraph.animateSimulation-1033"><a href="#StateTransitionGraph.animateSimulation-1033"><span class="linenos">1033</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.animateSimulation-1034"><a href="#StateTransitionGraph.animateSimulation-1034"><span class="linenos">1034</span></a><span class="sd">        Animate a simulation trajectory through the state transition graph.</span>
</span><span id="StateTransitionGraph.animateSimulation-1035"><a href="#StateTransitionGraph.animateSimulation-1035"><span class="linenos">1035</span></a><span class="sd">        The animation of the CTMC simulation run either in a Jupyter notebook or as a regular script.</span>
</span><span id="StateTransitionGraph.animateSimulation-1036"><a href="#StateTransitionGraph.animateSimulation-1036"><span class="linenos">1036</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.animateSimulation-1037"><a href="#StateTransitionGraph.animateSimulation-1037"><span class="linenos">1037</span></a><span class="sd">        This method visualizes the path of a simulated or predefined sequence of states by</span>
</span><span id="StateTransitionGraph.animateSimulation-1038"><a href="#StateTransitionGraph.animateSimulation-1038"><span class="linenos">1038</span></a><span class="sd">        temporarily highlighting each visited state over time. The time spent in each state</span>
</span><span id="StateTransitionGraph.animateSimulation-1039"><a href="#StateTransitionGraph.animateSimulation-1039"><span class="linenos">1039</span></a><span class="sd">        is scaled relative to the average sojourn time to produce a visually smooth animation.</span>
</span><span id="StateTransitionGraph.animateSimulation-1040"><a href="#StateTransitionGraph.animateSimulation-1040"><span class="linenos">1040</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.animateSimulation-1041"><a href="#StateTransitionGraph.animateSimulation-1041"><span class="linenos">1041</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.animateSimulation-1042"><a href="#StateTransitionGraph.animateSimulation-1042"><span class="linenos">1042</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.animateSimulation-1043"><a href="#StateTransitionGraph.animateSimulation-1043"><span class="linenos">1043</span></a><span class="sd">        - `expectedTimePerState` : float, optional</span>
</span><span id="StateTransitionGraph.animateSimulation-1044"><a href="#StateTransitionGraph.animateSimulation-1044"><span class="linenos">1044</span></a><span class="sd">            Approximate duration (in seconds) for an average state visit in the animation.</span>
</span><span id="StateTransitionGraph.animateSimulation-1045"><a href="#StateTransitionGraph.animateSimulation-1045"><span class="linenos">1045</span></a><span class="sd">            The actual pause duration for each state is scaled proportionally to its sojourn time.</span>
</span><span id="StateTransitionGraph.animateSimulation-1046"><a href="#StateTransitionGraph.animateSimulation-1046"><span class="linenos">1046</span></a><span class="sd">            Default is 1 second.</span>
</span><span id="StateTransitionGraph.animateSimulation-1047"><a href="#StateTransitionGraph.animateSimulation-1047"><span class="linenos">1047</span></a><span class="sd">            </span>
</span><span id="StateTransitionGraph.animateSimulation-1048"><a href="#StateTransitionGraph.animateSimulation-1048"><span class="linenos">1048</span></a><span class="sd">        - `inNotebook` : bool, optional</span>
</span><span id="StateTransitionGraph.animateSimulation-1049"><a href="#StateTransitionGraph.animateSimulation-1049"><span class="linenos">1049</span></a><span class="sd">            If True, uses Jupyter-compatible animation (with display + clear_output).</span>
</span><span id="StateTransitionGraph.animateSimulation-1050"><a href="#StateTransitionGraph.animateSimulation-1050"><span class="linenos">1050</span></a><span class="sd">            If False, uses standard matplotlib interactive animation. Default is True.</span>
</span><span id="StateTransitionGraph.animateSimulation-1051"><a href="#StateTransitionGraph.animateSimulation-1051"><span class="linenos">1051</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.animateSimulation-1052"><a href="#StateTransitionGraph.animateSimulation-1052"><span class="linenos">1052</span></a><span class="sd">        - `**kwargs` : dict</span>
</span><span id="StateTransitionGraph.animateSimulation-1053"><a href="#StateTransitionGraph.animateSimulation-1053"><span class="linenos">1053</span></a><span class="sd">            Additional keyword arguments including:</span>
</span><span id="StateTransitionGraph.animateSimulation-1054"><a href="#StateTransitionGraph.animateSimulation-1054"><span class="linenos">1054</span></a><span class="sd">                - states : list</span>
</span><span id="StateTransitionGraph.animateSimulation-1055"><a href="#StateTransitionGraph.animateSimulation-1055"><span class="linenos">1055</span></a><span class="sd">                    A list of visited states (nodes) to animate.</span>
</span><span id="StateTransitionGraph.animateSimulation-1056"><a href="#StateTransitionGraph.animateSimulation-1056"><span class="linenos">1056</span></a><span class="sd">                - times : list or np.ndarray</span>
</span><span id="StateTransitionGraph.animateSimulation-1057"><a href="#StateTransitionGraph.animateSimulation-1057"><span class="linenos">1057</span></a><span class="sd">                    Sojourn times in each state (same length as `states`).</span>
</span><span id="StateTransitionGraph.animateSimulation-1058"><a href="#StateTransitionGraph.animateSimulation-1058"><span class="linenos">1058</span></a><span class="sd">                - startNode : hashable</span>
</span><span id="StateTransitionGraph.animateSimulation-1059"><a href="#StateTransitionGraph.animateSimulation-1059"><span class="linenos">1059</span></a><span class="sd">                    Optional start node for automatic simulation if `states` and `times` are not provided.</span>
</span><span id="StateTransitionGraph.animateSimulation-1060"><a href="#StateTransitionGraph.animateSimulation-1060"><span class="linenos">1060</span></a><span class="sd">                - numEvents : int</span>
</span><span id="StateTransitionGraph.animateSimulation-1061"><a href="#StateTransitionGraph.animateSimulation-1061"><span class="linenos">1061</span></a><span class="sd">                    Number of events (state transitions) to simulate.</span>
</span><span id="StateTransitionGraph.animateSimulation-1062"><a href="#StateTransitionGraph.animateSimulation-1062"><span class="linenos">1062</span></a><span class="sd">                - Additional drawing-related kwargs are passed to `drawTransitionGraph()`.</span>
</span><span id="StateTransitionGraph.animateSimulation-1063"><a href="#StateTransitionGraph.animateSimulation-1063"><span class="linenos">1063</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.animateSimulation-1064"><a href="#StateTransitionGraph.animateSimulation-1064"><span class="linenos">1064</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph.animateSimulation-1065"><a href="#StateTransitionGraph.animateSimulation-1065"><span class="linenos">1065</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph.animateSimulation-1066"><a href="#StateTransitionGraph.animateSimulation-1066"><span class="linenos">1066</span></a><span class="sd">        ValueError</span>
</span><span id="StateTransitionGraph.animateSimulation-1067"><a href="#StateTransitionGraph.animateSimulation-1067"><span class="linenos">1067</span></a><span class="sd">            If neither a `(states, times)` pair nor `(startNode, numEvents)` are provided.</span>
</span><span id="StateTransitionGraph.animateSimulation-1068"><a href="#StateTransitionGraph.animateSimulation-1068"><span class="linenos">1068</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.animateSimulation-1069"><a href="#StateTransitionGraph.animateSimulation-1069"><span class="linenos">1069</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.animateSimulation-1070"><a href="#StateTransitionGraph.animateSimulation-1070"><span class="linenos">1070</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.animateSimulation-1071"><a href="#StateTransitionGraph.animateSimulation-1071"><span class="linenos">1071</span></a><span class="sd">        None</span>
</span><span id="StateTransitionGraph.animateSimulation-1072"><a href="#StateTransitionGraph.animateSimulation-1072"><span class="linenos">1072</span></a><span class="sd">            The animation is shown interactively using matplotlib but no data is returned.</span>
</span><span id="StateTransitionGraph.animateSimulation-1073"><a href="#StateTransitionGraph.animateSimulation-1073"><span class="linenos">1073</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.animateSimulation-1074"><a href="#StateTransitionGraph.animateSimulation-1074"><span class="linenos">1074</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.animateSimulation-1075"><a href="#StateTransitionGraph.animateSimulation-1075"><span class="linenos">1075</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.animateSimulation-1076"><a href="#StateTransitionGraph.animateSimulation-1076"><span class="linenos">1076</span></a><span class="sd">        - If `states` and `times` are not supplied, a simulation is run via `simulateMarkovModel()`.</span>
</span><span id="StateTransitionGraph.animateSimulation-1077"><a href="#StateTransitionGraph.animateSimulation-1077"><span class="linenos">1077</span></a><span class="sd">        - The function uses matplotlib&#39;s interactive mode (`plt.ion()`) to animate transitions.</span>
</span><span id="StateTransitionGraph.animateSimulation-1078"><a href="#StateTransitionGraph.animateSimulation-1078"><span class="linenos">1078</span></a><span class="sd">        - The average sojourn time across all states is used to normalize animation speed.</span>
</span><span id="StateTransitionGraph.animateSimulation-1079"><a href="#StateTransitionGraph.animateSimulation-1079"><span class="linenos">1079</span></a><span class="sd">        - Each visited state is highlighted in red for its corresponding (scaled) dwell time.</span>
</span><span id="StateTransitionGraph.animateSimulation-1080"><a href="#StateTransitionGraph.animateSimulation-1080"><span class="linenos">1080</span></a><span class="sd">        - Drawing arguments like layout, font size, or color can be customized via kwargs.</span>
</span><span id="StateTransitionGraph.animateSimulation-1081"><a href="#StateTransitionGraph.animateSimulation-1081"><span class="linenos">1081</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph.animateSimulation-1082"><a href="#StateTransitionGraph.animateSimulation-1082"><span class="linenos">1082</span></a>        <span class="c1"># expTimePerState: in seconds</span>
</span><span id="StateTransitionGraph.animateSimulation-1083"><a href="#StateTransitionGraph.animateSimulation-1083"><span class="linenos">1083</span></a>        <span class="k">if</span> <span class="s2">&quot;states&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;times&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="StateTransitionGraph.animateSimulation-1084"><a href="#StateTransitionGraph.animateSimulation-1084"><span class="linenos">1084</span></a>            <span class="n">states</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;states&quot;</span><span class="p">]</span>
</span><span id="StateTransitionGraph.animateSimulation-1085"><a href="#StateTransitionGraph.animateSimulation-1085"><span class="linenos">1085</span></a>            <span class="n">times</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;times&quot;</span><span class="p">]</span>
</span><span id="StateTransitionGraph.animateSimulation-1086"><a href="#StateTransitionGraph.animateSimulation-1086"><span class="linenos">1086</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph.animateSimulation-1087"><a href="#StateTransitionGraph.animateSimulation-1087"><span class="linenos">1087</span></a>            <span class="c1"># Run default simulation if data not provided</span>
</span><span id="StateTransitionGraph.animateSimulation-1088"><a href="#StateTransitionGraph.animateSimulation-1088"><span class="linenos">1088</span></a>            <span class="k">if</span> <span class="s2">&quot;startNode&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;numEvents&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="StateTransitionGraph.animateSimulation-1089"><a href="#StateTransitionGraph.animateSimulation-1089"><span class="linenos">1089</span></a>                <span class="n">states</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulateMarkovModel</span><span class="p">(</span><span class="n">startNode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numEvents</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="StateTransitionGraph.animateSimulation-1090"><a href="#StateTransitionGraph.animateSimulation-1090"><span class="linenos">1090</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph.animateSimulation-1091"><a href="#StateTransitionGraph.animateSimulation-1091"><span class="linenos">1091</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must provide either (&#39;states&#39; and &#39;times&#39;) or (&#39;startNode&#39; and &#39;numEvents&#39;).&quot;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.animateSimulation-1092"><a href="#StateTransitionGraph.animateSimulation-1092"><span class="linenos">1092</span></a>        
</span><span id="StateTransitionGraph.animateSimulation-1093"><a href="#StateTransitionGraph.animateSimulation-1093"><span class="linenos">1093</span></a>        <span class="c1">#avg_OutGoingRate = np.mean([self.nodes[n].get(&quot;sumOutgoingRates&quot;, 0) for n in self.nodes])</span>
</span><span id="StateTransitionGraph.animateSimulation-1094"><a href="#StateTransitionGraph.animateSimulation-1094"><span class="linenos">1094</span></a>        <span class="n">avg_Time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="mf">1.0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sumOutgoingRates&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">])</span>
</span><span id="StateTransitionGraph.animateSimulation-1095"><a href="#StateTransitionGraph.animateSimulation-1095"><span class="linenos">1095</span></a>        
</span><span id="StateTransitionGraph.animateSimulation-1096"><a href="#StateTransitionGraph.animateSimulation-1096"><span class="linenos">1096</span></a>            
</span><span id="StateTransitionGraph.animateSimulation-1097"><a href="#StateTransitionGraph.animateSimulation-1097"><span class="linenos">1097</span></a>        <span class="c1"># Remove simulation-related keys before drawing</span>
</span><span id="StateTransitionGraph.animateSimulation-1098"><a href="#StateTransitionGraph.animateSimulation-1098"><span class="linenos">1098</span></a>        <span class="n">draw_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="s2">&quot;times&quot;</span><span class="p">,</span> <span class="s2">&quot;startNode&quot;</span><span class="p">,</span> <span class="s2">&quot;numEvents&quot;</span><span class="p">}}</span>
</span><span id="StateTransitionGraph.animateSimulation-1099"><a href="#StateTransitionGraph.animateSimulation-1099"><span class="linenos">1099</span></a>                
</span><span id="StateTransitionGraph.animateSimulation-1100"><a href="#StateTransitionGraph.animateSimulation-1100"><span class="linenos">1100</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawTransitionGraph</span><span class="p">(</span><span class="o">**</span><span class="n">draw_kwargs</span><span class="p">)</span>
</span><span id="StateTransitionGraph.animateSimulation-1101"><a href="#StateTransitionGraph.animateSimulation-1101"><span class="linenos">1101</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="StateTransitionGraph.animateSimulation-1102"><a href="#StateTransitionGraph.animateSimulation-1102"><span class="linenos">1102</span></a>        
</span><span id="StateTransitionGraph.animateSimulation-1103"><a href="#StateTransitionGraph.animateSimulation-1103"><span class="linenos">1103</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">inNotebook</span><span class="p">:</span>
</span><span id="StateTransitionGraph.animateSimulation-1104"><a href="#StateTransitionGraph.animateSimulation-1104"><span class="linenos">1104</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
</span><span id="StateTransitionGraph.animateSimulation-1105"><a href="#StateTransitionGraph.animateSimulation-1105"><span class="linenos">1105</span></a>                                
</span><span id="StateTransitionGraph.animateSimulation-1106"><a href="#StateTransitionGraph.animateSimulation-1106"><span class="linenos">1106</span></a>        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">states</span><span class="p">,</span><span class="n">times</span><span class="p">):</span>
</span><span id="StateTransitionGraph.animateSimulation-1107"><a href="#StateTransitionGraph.animateSimulation-1107"><span class="linenos">1107</span></a>            <span class="k">if</span> <span class="n">inNotebook</span><span class="p">:</span>
</span><span id="StateTransitionGraph.animateSimulation-1108"><a href="#StateTransitionGraph.animateSimulation-1108"><span class="linenos">1108</span></a>                <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StateTransitionGraph.animateSimulation-1109"><a href="#StateTransitionGraph.animateSimulation-1109"><span class="linenos">1109</span></a>                <span class="n">artist</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
</span><span id="StateTransitionGraph.animateSimulation-1110"><a href="#StateTransitionGraph.animateSimulation-1110"><span class="linenos">1110</span></a>                                                <span class="n">node_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_NODE_ANIMATION_HIGHLIGHT</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="StateTransitionGraph.animateSimulation-1111"><a href="#StateTransitionGraph.animateSimulation-1111"><span class="linenos">1111</span></a>                <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="StateTransitionGraph.animateSimulation-1112"><a href="#StateTransitionGraph.animateSimulation-1112"><span class="linenos">1112</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StateTransitionGraph.animateSimulation-1113"><a href="#StateTransitionGraph.animateSimulation-1113"><span class="linenos">1113</span></a>                <span class="n">artist</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="p">],</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
</span><span id="StateTransitionGraph.animateSimulation-1114"><a href="#StateTransitionGraph.animateSimulation-1114"><span class="linenos">1114</span></a>                                       <span class="n">node_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_const</span><span class="o">.</span><span class="n">COLOR_NODE_ANIMATION_HIGHLIGHT</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="StateTransitionGraph.animateSimulation-1115"><a href="#StateTransitionGraph.animateSimulation-1115"><span class="linenos">1115</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>                        
</span><span id="StateTransitionGraph.animateSimulation-1116"><a href="#StateTransitionGraph.animateSimulation-1116"><span class="linenos">1116</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="n">time</span><span class="o">/</span><span class="n">avg_Time</span><span class="o">*</span><span class="n">expectedTimePerState</span><span class="p">)</span>
</span><span id="StateTransitionGraph.animateSimulation-1117"><a href="#StateTransitionGraph.animateSimulation-1117"><span class="linenos">1117</span></a>                
</span><span id="StateTransitionGraph.animateSimulation-1118"><a href="#StateTransitionGraph.animateSimulation-1118"><span class="linenos">1118</span></a>                <span class="c1"># Remove highlighted node    </span>
</span><span id="StateTransitionGraph.animateSimulation-1119"><a href="#StateTransitionGraph.animateSimulation-1119"><span class="linenos">1119</span></a>                <span class="n">artist</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="StateTransitionGraph.animateSimulation-1120"><a href="#StateTransitionGraph.animateSimulation-1120"><span class="linenos">1120</span></a>        
</span><span id="StateTransitionGraph.animateSimulation-1121"><a href="#StateTransitionGraph.animateSimulation-1121"><span class="linenos">1121</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Animate a simulation trajectory through the state transition graph.
The animation of the CTMC simulation run either in a Jupyter notebook or as a regular script.</p>

<p>This method visualizes the path of a simulated or predefined sequence of states by
temporarily highlighting each visited state over time. The time spent in each state
is scaled relative to the average sojourn time to produce a visually smooth animation.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><p><code>expectedTimePerState</code> : float, optional
Approximate duration (in seconds) for an average state visit in the animation.
The actual pause duration for each state is scaled proportionally to its sojourn time.
Default is 1 second.</p></li>
<li><p><code>inNotebook</code> : bool, optional
If True, uses Jupyter-compatible animation (with display + clear_output).
If False, uses standard matplotlib interactive animation. Default is True.</p></li>
<li><p><code>**kwargs</code> : dict
Additional keyword arguments including:
    - states : list
        A list of visited states (nodes) to animate.
    - times : list or np.ndarray
        Sojourn times in each state (same length as <code><a href="#StateTransitionGraph.states">states</a></code>).
    - startNode : hashable
        Optional start node for automatic simulation if <code><a href="#StateTransitionGraph.states">states</a></code> and <code>times</code> are not provided.
    - numEvents : int
        Number of events (state transitions) to simulate.
    - Additional drawing-related kwargs are passed to <code><a href="#StateTransitionGraph.drawTransitionGraph">drawTransitionGraph()</a></code>.</p></li>
</ul>

<h2 id="raises">Raises</h2>

<p>ValueError
    If neither a <code>(states, times)</code> pair nor <code>(startNode, numEvents)</code> are provided.</p>

<h2 id="returns">Returns</h2>

<p>None
    The animation is shown interactively using matplotlib but no data is returned.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>If <code><a href="#StateTransitionGraph.states">states</a></code> and <code>times</code> are not supplied, a simulation is run via <code><a href="#StateTransitionGraph.simulateMarkovModel">simulateMarkovModel()</a></code>.</li>
<li>The function uses matplotlib's interactive mode (<code>plt.ion()</code>) to animate transitions.</li>
<li>The average sojourn time across all states is used to normalize animation speed.</li>
<li>Each visited state is highlighted in red for its corresponding (scaled) dwell time.</li>
<li>Drawing arguments like layout, font size, or color can be customized via kwargs.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.states" class="classattr">
                                        <input id="StateTransitionGraph.states-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">states</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">data</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.states-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.states"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.states-1125"><a href="#StateTransitionGraph.states-1125"><span class="linenos">1125</span></a>    <span class="k">def</span> <span class="nf">states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="StateTransitionGraph.states-1126"><a href="#StateTransitionGraph.states-1126"><span class="linenos">1126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.states-1127"><a href="#StateTransitionGraph.states-1127"><span class="linenos">1127</span></a><span class="sd">        Return a view of the graph&#39;s states (nodes), optionally with attributes.</span>
</span><span id="StateTransitionGraph.states-1128"><a href="#StateTransitionGraph.states-1128"><span class="linenos">1128</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.states-1129"><a href="#StateTransitionGraph.states-1129"><span class="linenos">1129</span></a><span class="sd">        This method is functionally identical to `self.nodes()` in NetworkX, but is</span>
</span><span id="StateTransitionGraph.states-1130"><a href="#StateTransitionGraph.states-1130"><span class="linenos">1130</span></a><span class="sd">        renamed to `states()` to reflect the semantics of a state transition graph or</span>
</span><span id="StateTransitionGraph.states-1131"><a href="#StateTransitionGraph.states-1131"><span class="linenos">1131</span></a><span class="sd">        Markov model, where nodes represent system states.</span>
</span><span id="StateTransitionGraph.states-1132"><a href="#StateTransitionGraph.states-1132"><span class="linenos">1132</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.states-1133"><a href="#StateTransitionGraph.states-1133"><span class="linenos">1133</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.states-1134"><a href="#StateTransitionGraph.states-1134"><span class="linenos">1134</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.states-1135"><a href="#StateTransitionGraph.states-1135"><span class="linenos">1135</span></a><span class="sd">        data : bool, optional</span>
</span><span id="StateTransitionGraph.states-1136"><a href="#StateTransitionGraph.states-1136"><span class="linenos">1136</span></a><span class="sd">            If True, returns a view of `(node, attribute_dict)` pairs.</span>
</span><span id="StateTransitionGraph.states-1137"><a href="#StateTransitionGraph.states-1137"><span class="linenos">1137</span></a><span class="sd">            If False (default), returns a view of node identifiers only.</span>
</span><span id="StateTransitionGraph.states-1138"><a href="#StateTransitionGraph.states-1138"><span class="linenos">1138</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.states-1139"><a href="#StateTransitionGraph.states-1139"><span class="linenos">1139</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.states-1140"><a href="#StateTransitionGraph.states-1140"><span class="linenos">1140</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.states-1141"><a href="#StateTransitionGraph.states-1141"><span class="linenos">1141</span></a><span class="sd">        networkx.classes.reportviews.NodeView or NodeDataView</span>
</span><span id="StateTransitionGraph.states-1142"><a href="#StateTransitionGraph.states-1142"><span class="linenos">1142</span></a><span class="sd">            A view over the graph’s nodes or `(node, data)` pairs, depending on the `data` flag.</span>
</span><span id="StateTransitionGraph.states-1143"><a href="#StateTransitionGraph.states-1143"><span class="linenos">1143</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.states-1144"><a href="#StateTransitionGraph.states-1144"><span class="linenos">1144</span></a><span class="sd">        Examples</span>
</span><span id="StateTransitionGraph.states-1145"><a href="#StateTransitionGraph.states-1145"><span class="linenos">1145</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph.states-1146"><a href="#StateTransitionGraph.states-1146"><span class="linenos">1146</span></a><span class="sd">        &gt;&gt;&gt; G.states()</span>
</span><span id="StateTransitionGraph.states-1147"><a href="#StateTransitionGraph.states-1147"><span class="linenos">1147</span></a><span class="sd">        [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]</span>
</span><span id="StateTransitionGraph.states-1148"><a href="#StateTransitionGraph.states-1148"><span class="linenos">1148</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.states-1149"><a href="#StateTransitionGraph.states-1149"><span class="linenos">1149</span></a><span class="sd">        &gt;&gt;&gt; list(G.states(data=True))</span>
</span><span id="StateTransitionGraph.states-1150"><a href="#StateTransitionGraph.states-1150"><span class="linenos">1150</span></a><span class="sd">        [(&#39;A&#39;, {&#39;color&#39;: &#39;red&#39;, &#39;label&#39;: &#39;Start&#39;}), (&#39;B&#39;, {...}), ...]</span>
</span><span id="StateTransitionGraph.states-1151"><a href="#StateTransitionGraph.states-1151"><span class="linenos">1151</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.states-1152"><a href="#StateTransitionGraph.states-1152"><span class="linenos">1152</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.states-1153"><a href="#StateTransitionGraph.states-1153"><span class="linenos">1153</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.states-1154"><a href="#StateTransitionGraph.states-1154"><span class="linenos">1154</span></a><span class="sd">        - This is a convenience wrapper for semantic clarity in models where nodes represent states.</span>
</span><span id="StateTransitionGraph.states-1155"><a href="#StateTransitionGraph.states-1155"><span class="linenos">1155</span></a><span class="sd">        - The view is dynamic: changes to the graph are reflected in the returned view.</span>
</span><span id="StateTransitionGraph.states-1156"><a href="#StateTransitionGraph.states-1156"><span class="linenos">1156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.states-1157"><a href="#StateTransitionGraph.states-1157"><span class="linenos">1157</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a view of the graph's states (nodes), optionally with attributes.</p>

<p>This method is functionally identical to <code>self.nodes()</code> in NetworkX, but is
renamed to <code><a href="#StateTransitionGraph.states">states()</a></code> to reflect the semantics of a state transition graph or
Markov model, where nodes represent system states.</p>

<h2 id="parameters">Parameters</h2>

<p>data : bool, optional
    If True, returns a view of <code>(node, attribute_dict)</code> pairs.
    If False (default), returns a view of node identifiers only.</p>

<h2 id="returns">Returns</h2>

<p>networkx.classes.reportviews.NodeView or NodeDataView
    A view over the graph’s nodes or <code>(node, data)</code> pairs, depending on the <code>data</code> flag.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">states</span><span class="p">()</span>
<span class="go">[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">states</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[(&#39;A&#39;, {&#39;color&#39;: &#39;red&#39;, &#39;label&#39;: &#39;Start&#39;}), (&#39;B&#39;, {...}), ...]</span>
</code></pre>
</div>

<h2 id="notes">Notes</h2>

<ul>
<li>This is a convenience wrapper for semantic clarity in models where nodes represent states.</li>
<li>The view is dynamic: changes to the graph are reflected in the returned view.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.setStateColor" class="classattr">
                                        <input id="StateTransitionGraph.setStateColor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setStateColor</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">state</span>, </span><span class="param"><span class="n">color</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.setStateColor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.setStateColor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.setStateColor-1160"><a href="#StateTransitionGraph.setStateColor-1160"><span class="linenos">1160</span></a>    <span class="k">def</span> <span class="nf">setStateColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="StateTransitionGraph.setStateColor-1161"><a href="#StateTransitionGraph.setStateColor-1161"><span class="linenos">1161</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.setStateColor-1162"><a href="#StateTransitionGraph.setStateColor-1162"><span class="linenos">1162</span></a><span class="sd">        Set the color attribute of a specific state (node).</span>
</span><span id="StateTransitionGraph.setStateColor-1163"><a href="#StateTransitionGraph.setStateColor-1163"><span class="linenos">1163</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateColor-1164"><a href="#StateTransitionGraph.setStateColor-1164"><span class="linenos">1164</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.setStateColor-1165"><a href="#StateTransitionGraph.setStateColor-1165"><span class="linenos">1165</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.setStateColor-1166"><a href="#StateTransitionGraph.setStateColor-1166"><span class="linenos">1166</span></a><span class="sd">        state : hashable</span>
</span><span id="StateTransitionGraph.setStateColor-1167"><a href="#StateTransitionGraph.setStateColor-1167"><span class="linenos">1167</span></a><span class="sd">            The identifier of the state whose color is to be updated.</span>
</span><span id="StateTransitionGraph.setStateColor-1168"><a href="#StateTransitionGraph.setStateColor-1168"><span class="linenos">1168</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateColor-1169"><a href="#StateTransitionGraph.setStateColor-1169"><span class="linenos">1169</span></a><span class="sd">        color : str</span>
</span><span id="StateTransitionGraph.setStateColor-1170"><a href="#StateTransitionGraph.setStateColor-1170"><span class="linenos">1170</span></a><span class="sd">            The new color to assign to the state (used for visualization).</span>
</span><span id="StateTransitionGraph.setStateColor-1171"><a href="#StateTransitionGraph.setStateColor-1171"><span class="linenos">1171</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateColor-1172"><a href="#StateTransitionGraph.setStateColor-1172"><span class="linenos">1172</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.setStateColor-1173"><a href="#StateTransitionGraph.setStateColor-1173"><span class="linenos">1173</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.setStateColor-1174"><a href="#StateTransitionGraph.setStateColor-1174"><span class="linenos">1174</span></a><span class="sd">        None</span>
</span><span id="StateTransitionGraph.setStateColor-1175"><a href="#StateTransitionGraph.setStateColor-1175"><span class="linenos">1175</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.setStateColor-1176"><a href="#StateTransitionGraph.setStateColor-1176"><span class="linenos">1176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
</span></pre></div>


            <div class="docstring"><p>Set the color attribute of a specific state (node).</p>

<h2 id="parameters">Parameters</h2>

<p>state : hashable
    The identifier of the state whose color is to be updated.</p>

<p>color : str
    The new color to assign to the state (used for visualization).</p>

<h2 id="returns">Returns</h2>

<p>None</p>
</div>


                            </div>
                            <div id="StateTransitionGraph.setStateLabel" class="classattr">
                                        <input id="StateTransitionGraph.setStateLabel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setStateLabel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">state</span>, </span><span class="param"><span class="n">label</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.setStateLabel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.setStateLabel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.setStateLabel-1179"><a href="#StateTransitionGraph.setStateLabel-1179"><span class="linenos">1179</span></a>    <span class="k">def</span> <span class="nf">setStateLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
</span><span id="StateTransitionGraph.setStateLabel-1180"><a href="#StateTransitionGraph.setStateLabel-1180"><span class="linenos">1180</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.setStateLabel-1181"><a href="#StateTransitionGraph.setStateLabel-1181"><span class="linenos">1181</span></a><span class="sd">        Set the label attribute of a specific state (node).</span>
</span><span id="StateTransitionGraph.setStateLabel-1182"><a href="#StateTransitionGraph.setStateLabel-1182"><span class="linenos">1182</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateLabel-1183"><a href="#StateTransitionGraph.setStateLabel-1183"><span class="linenos">1183</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.setStateLabel-1184"><a href="#StateTransitionGraph.setStateLabel-1184"><span class="linenos">1184</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.setStateLabel-1185"><a href="#StateTransitionGraph.setStateLabel-1185"><span class="linenos">1185</span></a><span class="sd">        state : hashable</span>
</span><span id="StateTransitionGraph.setStateLabel-1186"><a href="#StateTransitionGraph.setStateLabel-1186"><span class="linenos">1186</span></a><span class="sd">            The identifier of the state whose label is to be updated.</span>
</span><span id="StateTransitionGraph.setStateLabel-1187"><a href="#StateTransitionGraph.setStateLabel-1187"><span class="linenos">1187</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateLabel-1188"><a href="#StateTransitionGraph.setStateLabel-1188"><span class="linenos">1188</span></a><span class="sd">        label : str</span>
</span><span id="StateTransitionGraph.setStateLabel-1189"><a href="#StateTransitionGraph.setStateLabel-1189"><span class="linenos">1189</span></a><span class="sd">            The new label to assign to the state (used for visualization or annotation).</span>
</span><span id="StateTransitionGraph.setStateLabel-1190"><a href="#StateTransitionGraph.setStateLabel-1190"><span class="linenos">1190</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.setStateLabel-1191"><a href="#StateTransitionGraph.setStateLabel-1191"><span class="linenos">1191</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.setStateLabel-1192"><a href="#StateTransitionGraph.setStateLabel-1192"><span class="linenos">1192</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.setStateLabel-1193"><a href="#StateTransitionGraph.setStateLabel-1193"><span class="linenos">1193</span></a><span class="sd">        None</span>
</span><span id="StateTransitionGraph.setStateLabel-1194"><a href="#StateTransitionGraph.setStateLabel-1194"><span class="linenos">1194</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.setStateLabel-1195"><a href="#StateTransitionGraph.setStateLabel-1195"><span class="linenos">1195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
</span></pre></div>


            <div class="docstring"><p>Set the label attribute of a specific state (node).</p>

<h2 id="parameters">Parameters</h2>

<p>state : hashable
    The identifier of the state whose label is to be updated.</p>

<p>label : str
    The new label to assign to the state (used for visualization or annotation).</p>

<h2 id="returns">Returns</h2>

<p>None</p>
</div>


                            </div>
                            <div id="StateTransitionGraph.prob" class="classattr">
                                        <input id="StateTransitionGraph.prob-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prob</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">state</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.prob-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.prob"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.prob-1197"><a href="#StateTransitionGraph.prob-1197"><span class="linenos">1197</span></a>    <span class="k">def</span> <span class="nf">prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="StateTransitionGraph.prob-1198"><a href="#StateTransitionGraph.prob-1198"><span class="linenos">1198</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.prob-1199"><a href="#StateTransitionGraph.prob-1199"><span class="linenos">1199</span></a><span class="sd">        Return the steady-state probability of a specific state.</span>
</span><span id="StateTransitionGraph.prob-1200"><a href="#StateTransitionGraph.prob-1200"><span class="linenos">1200</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.prob-1201"><a href="#StateTransitionGraph.prob-1201"><span class="linenos">1201</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.prob-1202"><a href="#StateTransitionGraph.prob-1202"><span class="linenos">1202</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.prob-1203"><a href="#StateTransitionGraph.prob-1203"><span class="linenos">1203</span></a><span class="sd">        state : hashable</span>
</span><span id="StateTransitionGraph.prob-1204"><a href="#StateTransitionGraph.prob-1204"><span class="linenos">1204</span></a><span class="sd">            The identifier of the state whose probability is to be retrieved.</span>
</span><span id="StateTransitionGraph.prob-1205"><a href="#StateTransitionGraph.prob-1205"><span class="linenos">1205</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.prob-1206"><a href="#StateTransitionGraph.prob-1206"><span class="linenos">1206</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.prob-1207"><a href="#StateTransitionGraph.prob-1207"><span class="linenos">1207</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.prob-1208"><a href="#StateTransitionGraph.prob-1208"><span class="linenos">1208</span></a><span class="sd">        float</span>
</span><span id="StateTransitionGraph.prob-1209"><a href="#StateTransitionGraph.prob-1209"><span class="linenos">1209</span></a><span class="sd">            The steady-state probability of the specified state.</span>
</span><span id="StateTransitionGraph.prob-1210"><a href="#StateTransitionGraph.prob-1210"><span class="linenos">1210</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.prob-1211"><a href="#StateTransitionGraph.prob-1211"><span class="linenos">1211</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph.prob-1212"><a href="#StateTransitionGraph.prob-1212"><span class="linenos">1212</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph.prob-1213"><a href="#StateTransitionGraph.prob-1213"><span class="linenos">1213</span></a><span class="sd">        KeyError</span>
</span><span id="StateTransitionGraph.prob-1214"><a href="#StateTransitionGraph.prob-1214"><span class="linenos">1214</span></a><span class="sd">            If the state is not found in the steady-state probability dictionary.</span>
</span><span id="StateTransitionGraph.prob-1215"><a href="#StateTransitionGraph.prob-1215"><span class="linenos">1215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.prob-1216"><a href="#StateTransitionGraph.prob-1216"><span class="linenos">1216</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_probabilities</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the steady-state probability of a specific state.</p>

<h2 id="parameters">Parameters</h2>

<p>state : hashable
    The identifier of the state whose probability is to be retrieved.</p>

<h2 id="returns">Returns</h2>

<p>float
    The steady-state probability of the specified state.</p>

<h2 id="raises">Raises</h2>

<p>KeyError
    If the state is not found in the steady-state probability dictionary.</p>
</div>


                            </div>
                            <div id="StateTransitionGraph.probs" class="classattr">
                                        <input id="StateTransitionGraph.probs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">probs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.probs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.probs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.probs-1219"><a href="#StateTransitionGraph.probs-1219"><span class="linenos">1219</span></a>    <span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph.probs-1220"><a href="#StateTransitionGraph.probs-1220"><span class="linenos">1220</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.probs-1221"><a href="#StateTransitionGraph.probs-1221"><span class="linenos">1221</span></a><span class="sd">        Return the steady-state probabilities for all states.</span>
</span><span id="StateTransitionGraph.probs-1222"><a href="#StateTransitionGraph.probs-1222"><span class="linenos">1222</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.probs-1223"><a href="#StateTransitionGraph.probs-1223"><span class="linenos">1223</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.probs-1224"><a href="#StateTransitionGraph.probs-1224"><span class="linenos">1224</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.probs-1225"><a href="#StateTransitionGraph.probs-1225"><span class="linenos">1225</span></a><span class="sd">        dict</span>
</span><span id="StateTransitionGraph.probs-1226"><a href="#StateTransitionGraph.probs-1226"><span class="linenos">1226</span></a><span class="sd">            A dictionary mapping each state to its steady-state probability.</span>
</span><span id="StateTransitionGraph.probs-1227"><a href="#StateTransitionGraph.probs-1227"><span class="linenos">1227</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.probs-1228"><a href="#StateTransitionGraph.probs-1228"><span class="linenos">1228</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.probs-1229"><a href="#StateTransitionGraph.probs-1229"><span class="linenos">1229</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.probs-1230"><a href="#StateTransitionGraph.probs-1230"><span class="linenos">1230</span></a><span class="sd">        - The probabilities are computed via `calcSteadyStateProbs()` and stored internally.</span>
</span><span id="StateTransitionGraph.probs-1231"><a href="#StateTransitionGraph.probs-1231"><span class="linenos">1231</span></a><span class="sd">        - Use this method to access the full steady-state distribution.</span>
</span><span id="StateTransitionGraph.probs-1232"><a href="#StateTransitionGraph.probs-1232"><span class="linenos">1232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.probs-1233"><a href="#StateTransitionGraph.probs-1233"><span class="linenos">1233</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_probabilities</span>
</span></pre></div>


            <div class="docstring"><p>Return the steady-state probabilities for all states.</p>

<h2 id="returns">Returns</h2>

<p>dict
    A dictionary mapping each state to its steady-state probability.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>The probabilities are computed via <code><a href="#StateTransitionGraph.calcSteadyStateProbs">calcSteadyStateProbs()</a></code> and stored internally.</li>
<li>Use this method to access the full steady-state distribution.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.getEmptySystemProbs" class="classattr">
                                        <input id="StateTransitionGraph.getEmptySystemProbs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getEmptySystemProbs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">state</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.getEmptySystemProbs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.getEmptySystemProbs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.getEmptySystemProbs-1235"><a href="#StateTransitionGraph.getEmptySystemProbs-1235"><span class="linenos">1235</span></a>    <span class="k">def</span> <span class="nf">getEmptySystemProbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1236"><a href="#StateTransitionGraph.getEmptySystemProbs-1236"><span class="linenos">1236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1237"><a href="#StateTransitionGraph.getEmptySystemProbs-1237"><span class="linenos">1237</span></a><span class="sd">        Create an initial state distribution where all probability mass is in a single state.</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1238"><a href="#StateTransitionGraph.getEmptySystemProbs-1238"><span class="linenos">1238</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1239"><a href="#StateTransitionGraph.getEmptySystemProbs-1239"><span class="linenos">1239</span></a><span class="sd">        By default, this method returns a distribution where the entire probability mass</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1240"><a href="#StateTransitionGraph.getEmptySystemProbs-1240"><span class="linenos">1240</span></a><span class="sd">        is placed on the first node in the graph. Alternatively, a specific starting state</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1241"><a href="#StateTransitionGraph.getEmptySystemProbs-1241"><span class="linenos">1241</span></a><span class="sd">        can be provided.</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1242"><a href="#StateTransitionGraph.getEmptySystemProbs-1242"><span class="linenos">1242</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1243"><a href="#StateTransitionGraph.getEmptySystemProbs-1243"><span class="linenos">1243</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1244"><a href="#StateTransitionGraph.getEmptySystemProbs-1244"><span class="linenos">1244</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1245"><a href="#StateTransitionGraph.getEmptySystemProbs-1245"><span class="linenos">1245</span></a><span class="sd">        state : hashable, optional</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1246"><a href="#StateTransitionGraph.getEmptySystemProbs-1246"><span class="linenos">1246</span></a><span class="sd">            The state to initialize with probability 1. If None, the first node</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1247"><a href="#StateTransitionGraph.getEmptySystemProbs-1247"><span class="linenos">1247</span></a><span class="sd">            in the graph (based on insertion order) is used.</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1248"><a href="#StateTransitionGraph.getEmptySystemProbs-1248"><span class="linenos">1248</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1249"><a href="#StateTransitionGraph.getEmptySystemProbs-1249"><span class="linenos">1249</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1250"><a href="#StateTransitionGraph.getEmptySystemProbs-1250"><span class="linenos">1250</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1251"><a href="#StateTransitionGraph.getEmptySystemProbs-1251"><span class="linenos">1251</span></a><span class="sd">        dict</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1252"><a href="#StateTransitionGraph.getEmptySystemProbs-1252"><span class="linenos">1252</span></a><span class="sd">            A dictionary representing the initial distribution over states.</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1253"><a href="#StateTransitionGraph.getEmptySystemProbs-1253"><span class="linenos">1253</span></a><span class="sd">            The selected state has probability 1, and all others have 0.</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1254"><a href="#StateTransitionGraph.getEmptySystemProbs-1254"><span class="linenos">1254</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1255"><a href="#StateTransitionGraph.getEmptySystemProbs-1255"><span class="linenos">1255</span></a><span class="sd">        Examples</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1256"><a href="#StateTransitionGraph.getEmptySystemProbs-1256"><span class="linenos">1256</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1257"><a href="#StateTransitionGraph.getEmptySystemProbs-1257"><span class="linenos">1257</span></a><span class="sd">        &gt;&gt;&gt; X0 = G.getEmptySystem()</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1258"><a href="#StateTransitionGraph.getEmptySystemProbs-1258"><span class="linenos">1258</span></a><span class="sd">        &gt;&gt;&gt; sum(X0.values())  # 1.0</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1259"><a href="#StateTransitionGraph.getEmptySystemProbs-1259"><span class="linenos">1259</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1260"><a href="#StateTransitionGraph.getEmptySystemProbs-1260"><span class="linenos">1260</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1261"><a href="#StateTransitionGraph.getEmptySystemProbs-1261"><span class="linenos">1261</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1262"><a href="#StateTransitionGraph.getEmptySystemProbs-1262"><span class="linenos">1262</span></a><span class="sd">        - This method is useful for setting up deterministic initial conditions</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1263"><a href="#StateTransitionGraph.getEmptySystemProbs-1263"><span class="linenos">1263</span></a><span class="sd">          in transient simulations of a CTMC.</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1264"><a href="#StateTransitionGraph.getEmptySystemProbs-1264"><span class="linenos">1264</span></a><span class="sd">        - The return format is compatible with methods like `transientProbs()`.</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1265"><a href="#StateTransitionGraph.getEmptySystemProbs-1265"><span class="linenos">1265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1266"><a href="#StateTransitionGraph.getEmptySystemProbs-1266"><span class="linenos">1266</span></a>        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1267"><a href="#StateTransitionGraph.getEmptySystemProbs-1267"><span class="linenos">1267</span></a>            <span class="n">first_node</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">))</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1268"><a href="#StateTransitionGraph.getEmptySystemProbs-1268"><span class="linenos">1268</span></a>        <span class="n">X0</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">first_node</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">}</span>
</span><span id="StateTransitionGraph.getEmptySystemProbs-1269"><a href="#StateTransitionGraph.getEmptySystemProbs-1269"><span class="linenos">1269</span></a>        <span class="k">return</span> <span class="n">X0</span>
</span></pre></div>


            <div class="docstring"><p>Create an initial state distribution where all probability mass is in a single state.</p>

<p>By default, this method returns a distribution where the entire probability mass
is placed on the first node in the graph. Alternatively, a specific starting state
can be provided.</p>

<h2 id="parameters">Parameters</h2>

<p>state : hashable, optional
    The state to initialize with probability 1. If None, the first node
    in the graph (based on insertion order) is used.</p>

<h2 id="returns">Returns</h2>

<p>dict
    A dictionary representing the initial distribution over states.
    The selected state has probability 1, and all others have 0.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">X0</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">getEmptySystem</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">X0</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>  <span class="c1"># 1.0</span>
</code></pre>
</div>

<h2 id="notes">Notes</h2>

<ul>
<li>This method is useful for setting up deterministic initial conditions
in transient simulations of a CTMC.</li>
<li>The return format is compatible with methods like <code><a href="#StateTransitionGraph.transientProbs">transientProbs()</a></code>.</li>
</ul>
</div>


                            </div>
                            <div id="StateTransitionGraph.transientProbs" class="classattr">
                                        <input id="StateTransitionGraph.transientProbs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">transientProbs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">initialDistribution</span>, </span><span class="param"><span class="n">t</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.transientProbs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.transientProbs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.transientProbs-1273"><a href="#StateTransitionGraph.transientProbs-1273"><span class="linenos">1273</span></a>    <span class="k">def</span> <span class="nf">transientProbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initialDistribution</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span><span id="StateTransitionGraph.transientProbs-1274"><a href="#StateTransitionGraph.transientProbs-1274"><span class="linenos">1274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.transientProbs-1275"><a href="#StateTransitionGraph.transientProbs-1275"><span class="linenos">1275</span></a><span class="sd">        Compute the transient state probabilities at time `t` for the CTMC.</span>
</span><span id="StateTransitionGraph.transientProbs-1276"><a href="#StateTransitionGraph.transientProbs-1276"><span class="linenos">1276</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.transientProbs-1277"><a href="#StateTransitionGraph.transientProbs-1277"><span class="linenos">1277</span></a><span class="sd">        This method solves the forward equation of a continuous-time Markov chain (CTMC):</span>
</span><span id="StateTransitionGraph.transientProbs-1278"><a href="#StateTransitionGraph.transientProbs-1278"><span class="linenos">1278</span></a><span class="sd">        X(t) = X0 · expm(Q·t), where `Q` is the generator (rate) matrix and `X0` is the</span>
</span><span id="StateTransitionGraph.transientProbs-1279"><a href="#StateTransitionGraph.transientProbs-1279"><span class="linenos">1279</span></a><span class="sd">        initial state distribution. It returns a dictionary mapping each state to its</span>
</span><span id="StateTransitionGraph.transientProbs-1280"><a href="#StateTransitionGraph.transientProbs-1280"><span class="linenos">1280</span></a><span class="sd">        probability at time `t`.</span>
</span><span id="StateTransitionGraph.transientProbs-1281"><a href="#StateTransitionGraph.transientProbs-1281"><span class="linenos">1281</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.transientProbs-1282"><a href="#StateTransitionGraph.transientProbs-1282"><span class="linenos">1282</span></a><span class="sd">        Parameters</span>
</span><span id="StateTransitionGraph.transientProbs-1283"><a href="#StateTransitionGraph.transientProbs-1283"><span class="linenos">1283</span></a><span class="sd">        ----------</span>
</span><span id="StateTransitionGraph.transientProbs-1284"><a href="#StateTransitionGraph.transientProbs-1284"><span class="linenos">1284</span></a><span class="sd">        - `initialDistribution` : dict </span>
</span><span id="StateTransitionGraph.transientProbs-1285"><a href="#StateTransitionGraph.transientProbs-1285"><span class="linenos">1285</span></a><span class="sd">            A dictionary mapping states (nodes) to their initial probabilities at time `t=0`.</span>
</span><span id="StateTransitionGraph.transientProbs-1286"><a href="#StateTransitionGraph.transientProbs-1286"><span class="linenos">1286</span></a><span class="sd">            The keys must match the nodes in the graph, and the values should sum to 1.    </span>
</span><span id="StateTransitionGraph.transientProbs-1287"><a href="#StateTransitionGraph.transientProbs-1287"><span class="linenos">1287</span></a><span class="sd">            </span>
</span><span id="StateTransitionGraph.transientProbs-1288"><a href="#StateTransitionGraph.transientProbs-1288"><span class="linenos">1288</span></a><span class="sd">        - `t` : float</span>
</span><span id="StateTransitionGraph.transientProbs-1289"><a href="#StateTransitionGraph.transientProbs-1289"><span class="linenos">1289</span></a><span class="sd">            The time at which the transient distribution is to be evaluated.</span>
</span><span id="StateTransitionGraph.transientProbs-1290"><a href="#StateTransitionGraph.transientProbs-1290"><span class="linenos">1290</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.transientProbs-1291"><a href="#StateTransitionGraph.transientProbs-1291"><span class="linenos">1291</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.transientProbs-1292"><a href="#StateTransitionGraph.transientProbs-1292"><span class="linenos">1292</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.transientProbs-1293"><a href="#StateTransitionGraph.transientProbs-1293"><span class="linenos">1293</span></a><span class="sd">        dict</span>
</span><span id="StateTransitionGraph.transientProbs-1294"><a href="#StateTransitionGraph.transientProbs-1294"><span class="linenos">1294</span></a><span class="sd">            A dictionary mapping each state (node) to its probability at time `t`.</span>
</span><span id="StateTransitionGraph.transientProbs-1295"><a href="#StateTransitionGraph.transientProbs-1295"><span class="linenos">1295</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.transientProbs-1296"><a href="#StateTransitionGraph.transientProbs-1296"><span class="linenos">1296</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.transientProbs-1297"><a href="#StateTransitionGraph.transientProbs-1297"><span class="linenos">1297</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.transientProbs-1298"><a href="#StateTransitionGraph.transientProbs-1298"><span class="linenos">1298</span></a><span class="sd">        - The rate matrix `Q` is generated automatically if not yet computed.</span>
</span><span id="StateTransitionGraph.transientProbs-1299"><a href="#StateTransitionGraph.transientProbs-1299"><span class="linenos">1299</span></a><span class="sd">        - The state order in the rate matrix corresponds to the internal `_n2i` mapping.</span>
</span><span id="StateTransitionGraph.transientProbs-1300"><a href="#StateTransitionGraph.transientProbs-1300"><span class="linenos">1300</span></a><span class="sd">        - Internally, the dictionary `initialDistribution` is converted into a vector</span>
</span><span id="StateTransitionGraph.transientProbs-1301"><a href="#StateTransitionGraph.transientProbs-1301"><span class="linenos">1301</span></a><span class="sd">          aligned with the state indexing.</span>
</span><span id="StateTransitionGraph.transientProbs-1302"><a href="#StateTransitionGraph.transientProbs-1302"><span class="linenos">1302</span></a><span class="sd">        - The transient solution is computed using `scipy.linalg.expm` for matrix exponentiation.</span>
</span><span id="StateTransitionGraph.transientProbs-1303"><a href="#StateTransitionGraph.transientProbs-1303"><span class="linenos">1303</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.transientProbs-1304"><a href="#StateTransitionGraph.transientProbs-1304"><span class="linenos">1304</span></a><span class="sd">        Raises</span>
</span><span id="StateTransitionGraph.transientProbs-1305"><a href="#StateTransitionGraph.transientProbs-1305"><span class="linenos">1305</span></a><span class="sd">        ------</span>
</span><span id="StateTransitionGraph.transientProbs-1306"><a href="#StateTransitionGraph.transientProbs-1306"><span class="linenos">1306</span></a><span class="sd">        ValueError</span>
</span><span id="StateTransitionGraph.transientProbs-1307"><a href="#StateTransitionGraph.transientProbs-1307"><span class="linenos">1307</span></a><span class="sd">            If the input dictionary has missing states or probabilities that do not sum to 1.</span>
</span><span id="StateTransitionGraph.transientProbs-1308"><a href="#StateTransitionGraph.transientProbs-1308"><span class="linenos">1308</span></a><span class="sd">            (This is not enforced but recommended for correctness.)</span>
</span><span id="StateTransitionGraph.transientProbs-1309"><a href="#StateTransitionGraph.transientProbs-1309"><span class="linenos">1309</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="StateTransitionGraph.transientProbs-1310"><a href="#StateTransitionGraph.transientProbs-1310"><span class="linenos">1310</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">createRateMatrix</span><span class="p">()</span>
</span><span id="StateTransitionGraph.transientProbs-1311"><a href="#StateTransitionGraph.transientProbs-1311"><span class="linenos">1311</span></a>        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate_matrix</span>
</span><span id="StateTransitionGraph.transientProbs-1312"><a href="#StateTransitionGraph.transientProbs-1312"><span class="linenos">1312</span></a>        <span class="n">X0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initialDistribution</span><span class="p">))</span>
</span><span id="StateTransitionGraph.transientProbs-1313"><a href="#StateTransitionGraph.transientProbs-1313"><span class="linenos">1313</span></a>        
</span><span id="StateTransitionGraph.transientProbs-1314"><a href="#StateTransitionGraph.transientProbs-1314"><span class="linenos">1314</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
</span><span id="StateTransitionGraph.transientProbs-1315"><a href="#StateTransitionGraph.transientProbs-1315"><span class="linenos">1315</span></a>            <span class="n">X0</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">]</span> <span class="o">=</span> <span class="n">initialDistribution</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</span><span id="StateTransitionGraph.transientProbs-1316"><a href="#StateTransitionGraph.transientProbs-1316"><span class="linenos">1316</span></a>                
</span><span id="StateTransitionGraph.transientProbs-1317"><a href="#StateTransitionGraph.transientProbs-1317"><span class="linenos">1317</span></a>        
</span><span id="StateTransitionGraph.transientProbs-1318"><a href="#StateTransitionGraph.transientProbs-1318"><span class="linenos">1318</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">X0</span> <span class="o">@</span> <span class="n">expm</span><span class="p">(</span><span class="n">Q</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>    
</span><span id="StateTransitionGraph.transientProbs-1319"><a href="#StateTransitionGraph.transientProbs-1319"><span class="linenos">1319</span></a>        
</span><span id="StateTransitionGraph.transientProbs-1320"><a href="#StateTransitionGraph.transientProbs-1320"><span class="linenos">1320</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StateTransitionGraph.transientProbs-1321"><a href="#StateTransitionGraph.transientProbs-1321"><span class="linenos">1321</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
</span><span id="StateTransitionGraph.transientProbs-1322"><a href="#StateTransitionGraph.transientProbs-1322"><span class="linenos">1322</span></a>            <span class="n">matrix</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2i</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">]</span>
</span><span id="StateTransitionGraph.transientProbs-1323"><a href="#StateTransitionGraph.transientProbs-1323"><span class="linenos">1323</span></a>                
</span><span id="StateTransitionGraph.transientProbs-1324"><a href="#StateTransitionGraph.transientProbs-1324"><span class="linenos">1324</span></a>        <span class="k">return</span> <span class="n">matrix</span>
</span></pre></div>


            <div class="docstring"><p>Compute the transient state probabilities at time <code>t</code> for the CTMC.</p>

<p>This method solves the forward equation of a continuous-time Markov chain (CTMC):
X(t) = X0 · expm(Q·t), where <code>Q</code> is the generator (rate) matrix and <code>X0</code> is the
initial state distribution. It returns a dictionary mapping each state to its
probability at time <code>t</code>.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><p><code>initialDistribution</code> : dict 
A dictionary mapping states (nodes) to their initial probabilities at time <code>t=0</code>.
The keys must match the nodes in the graph, and the values should sum to 1.    </p></li>
<li><p><code>t</code> : float
The time at which the transient distribution is to be evaluated.</p></li>
</ul>

<h2 id="returns">Returns</h2>

<p>dict
    A dictionary mapping each state (node) to its probability at time <code>t</code>.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>The rate matrix <code>Q</code> is generated automatically if not yet computed.</li>
<li>The state order in the rate matrix corresponds to the internal <code>_n2i</code> mapping.</li>
<li>Internally, the dictionary <code>initialDistribution</code> is converted into a vector
aligned with the state indexing.</li>
<li>The transient solution is computed using <code>scipy.linalg.expm</code> for matrix exponentiation.</li>
</ul>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the input dictionary has missing states or probabilities that do not sum to 1.
    (This is not enforced but recommended for correctness.)</p>
</div>


                            </div>
                            <div id="StateTransitionGraph.symSolveMarkovModel" class="classattr">
                                        <input id="StateTransitionGraph.symSolveMarkovModel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">symSolveMarkovModel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StateTransitionGraph.symSolveMarkovModel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StateTransitionGraph.symSolveMarkovModel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StateTransitionGraph.symSolveMarkovModel-1326"><a href="#StateTransitionGraph.symSolveMarkovModel-1326"><span class="linenos">1326</span></a>    <span class="k">def</span> <span class="nf">symSolveMarkovModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1327"><a href="#StateTransitionGraph.symSolveMarkovModel-1327"><span class="linenos">1327</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1328"><a href="#StateTransitionGraph.symSolveMarkovModel-1328"><span class="linenos">1328</span></a><span class="sd">        Symbolically solve the global balance equations of the CTMC.</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1329"><a href="#StateTransitionGraph.symSolveMarkovModel-1329"><span class="linenos">1329</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1330"><a href="#StateTransitionGraph.symSolveMarkovModel-1330"><span class="linenos">1330</span></a><span class="sd">        This method constructs and solves the system of symbolic equations for the</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1331"><a href="#StateTransitionGraph.symSolveMarkovModel-1331"><span class="linenos">1331</span></a><span class="sd">        steady-state probabilities of each state in the CTMC. It uses symbolic transition</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1332"><a href="#StateTransitionGraph.symSolveMarkovModel-1332"><span class="linenos">1332</span></a><span class="sd">        rates stored on the edges to form balance equations for each node, along with</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1333"><a href="#StateTransitionGraph.symSolveMarkovModel-1333"><span class="linenos">1333</span></a><span class="sd">        the normalization constraint that all probabilities sum to 1.</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1334"><a href="#StateTransitionGraph.symSolveMarkovModel-1334"><span class="linenos">1334</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1335"><a href="#StateTransitionGraph.symSolveMarkovModel-1335"><span class="linenos">1335</span></a><span class="sd">        Returns</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1336"><a href="#StateTransitionGraph.symSolveMarkovModel-1336"><span class="linenos">1336</span></a><span class="sd">        -------</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1337"><a href="#StateTransitionGraph.symSolveMarkovModel-1337"><span class="linenos">1337</span></a><span class="sd">        solution : dict</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1338"><a href="#StateTransitionGraph.symSolveMarkovModel-1338"><span class="linenos">1338</span></a><span class="sd">            A symbolic solution dictionary mapping SymPy symbols (e.g., x_{A}) to</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1339"><a href="#StateTransitionGraph.symSolveMarkovModel-1339"><span class="linenos">1339</span></a><span class="sd">            expressions in terms of model parameters.</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1340"><a href="#StateTransitionGraph.symSolveMarkovModel-1340"><span class="linenos">1340</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1341"><a href="#StateTransitionGraph.symSolveMarkovModel-1341"><span class="linenos">1341</span></a><span class="sd">        num_solution : dict</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1342"><a href="#StateTransitionGraph.symSolveMarkovModel-1342"><span class="linenos">1342</span></a><span class="sd">            A numerical dictionary mapping each state (node) to its steady-state probability,</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1343"><a href="#StateTransitionGraph.symSolveMarkovModel-1343"><span class="linenos">1343</span></a><span class="sd">            computed by substituting the numeric values from `self._subs` into the symbolic solution.</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1344"><a href="#StateTransitionGraph.symSolveMarkovModel-1344"><span class="linenos">1344</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1345"><a href="#StateTransitionGraph.symSolveMarkovModel-1345"><span class="linenos">1345</span></a><span class="sd">        Notes</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1346"><a href="#StateTransitionGraph.symSolveMarkovModel-1346"><span class="linenos">1346</span></a><span class="sd">        -----</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1347"><a href="#StateTransitionGraph.symSolveMarkovModel-1347"><span class="linenos">1347</span></a><span class="sd">        - For each node `s`, a symbolic variable `x_{label}` is created using the node&#39;s label attribute.</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1348"><a href="#StateTransitionGraph.symSolveMarkovModel-1348"><span class="linenos">1348</span></a><span class="sd">        - One balance equation is created per state: total inflow = total outflow.</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1349"><a href="#StateTransitionGraph.symSolveMarkovModel-1349"><span class="linenos">1349</span></a><span class="sd">        - An additional constraint `sum(x_i) = 1` ensures proper normalization.</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1350"><a href="#StateTransitionGraph.symSolveMarkovModel-1350"><span class="linenos">1350</span></a><span class="sd">        - The symbolic system is solved with `sympy.solve`, and the results are simplified.</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1351"><a href="#StateTransitionGraph.symSolveMarkovModel-1351"><span class="linenos">1351</span></a><span class="sd">        - Numeric values are computed by substituting known parameter values (`self._subs`) into the symbolic solution.</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1352"><a href="#StateTransitionGraph.symSolveMarkovModel-1352"><span class="linenos">1352</span></a><span class="sd">    </span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1353"><a href="#StateTransitionGraph.symSolveMarkovModel-1353"><span class="linenos">1353</span></a><span class="sd">        Examples</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1354"><a href="#StateTransitionGraph.symSolveMarkovModel-1354"><span class="linenos">1354</span></a><span class="sd">        --------</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1355"><a href="#StateTransitionGraph.symSolveMarkovModel-1355"><span class="linenos">1355</span></a><span class="sd">        &gt;&gt;&gt; sym_sol, num_sol = G.symSolveMarkovModel()</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1356"><a href="#StateTransitionGraph.symSolveMarkovModel-1356"><span class="linenos">1356</span></a><span class="sd">        &gt;&gt;&gt; sym_sol  # symbolic expressions for each state</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1357"><a href="#StateTransitionGraph.symSolveMarkovModel-1357"><span class="linenos">1357</span></a><span class="sd">        &gt;&gt;&gt; num_sol  # evaluated numerical values for each state</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1358"><a href="#StateTransitionGraph.symSolveMarkovModel-1358"><span class="linenos">1358</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1359"><a href="#StateTransitionGraph.symSolveMarkovModel-1359"><span class="linenos">1359</span></a>        <span class="n">X</span><span class="o">=</span><span class="p">{}</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1360"><a href="#StateTransitionGraph.symSolveMarkovModel-1360"><span class="linenos">1360</span></a>        <span class="n">to_solve</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1361"><a href="#StateTransitionGraph.symSolveMarkovModel-1361"><span class="linenos">1361</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1362"><a href="#StateTransitionGraph.symSolveMarkovModel-1362"><span class="linenos">1362</span></a>            <span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x_</span><span class="se">{{</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1363"><a href="#StateTransitionGraph.symSolveMarkovModel-1363"><span class="linenos">1363</span></a>            <span class="n">to_solve</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1364"><a href="#StateTransitionGraph.symSolveMarkovModel-1364"><span class="linenos">1364</span></a>        <span class="c1">#%</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1365"><a href="#StateTransitionGraph.symSolveMarkovModel-1365"><span class="linenos">1365</span></a>        <span class="n">eqs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1366"><a href="#StateTransitionGraph.symSolveMarkovModel-1366"><span class="linenos">1366</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1367"><a href="#StateTransitionGraph.symSolveMarkovModel-1367"><span class="linenos">1367</span></a>             <span class="n">succ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="c1"># raus</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1368"><a href="#StateTransitionGraph.symSolveMarkovModel-1368"><span class="linenos">1368</span></a>             <span class="n">out_rate</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1369"><a href="#StateTransitionGraph.symSolveMarkovModel-1369"><span class="linenos">1369</span></a>             <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">succ</span><span class="p">):</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1370"><a href="#StateTransitionGraph.symSolveMarkovModel-1370"><span class="linenos">1370</span></a>                 <span class="c1">#out_rate += X[s]*self.edges[s, z][&quot;sym_rate&quot;]                 </span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1371"><a href="#StateTransitionGraph.symSolveMarkovModel-1371"><span class="linenos">1371</span></a>                 <span class="n">out_rate</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">z</span><span class="p">][</span><span class="s2">&quot;sym_rate&quot;</span><span class="p">]</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1372"><a href="#StateTransitionGraph.symSolveMarkovModel-1372"><span class="linenos">1372</span></a>             
</span><span id="StateTransitionGraph.symSolveMarkovModel-1373"><a href="#StateTransitionGraph.symSolveMarkovModel-1373"><span class="linenos">1373</span></a>             <span class="n">in_rate</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1374"><a href="#StateTransitionGraph.symSolveMarkovModel-1374"><span class="linenos">1374</span></a>             <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1375"><a href="#StateTransitionGraph.symSolveMarkovModel-1375"><span class="linenos">1375</span></a>                 <span class="c1">#in_rate += X[r]*self.edges[r,s][&quot;sym_rate&quot;] </span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1376"><a href="#StateTransitionGraph.symSolveMarkovModel-1376"><span class="linenos">1376</span></a>                 <span class="n">in_rate</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s</span><span class="p">][</span><span class="s2">&quot;sym_rate&quot;</span><span class="p">]</span> 
</span><span id="StateTransitionGraph.symSolveMarkovModel-1377"><a href="#StateTransitionGraph.symSolveMarkovModel-1377"><span class="linenos">1377</span></a>             <span class="n">eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">out_rate</span><span class="p">,</span> <span class="n">in_rate</span><span class="p">)</span> <span class="p">)</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1378"><a href="#StateTransitionGraph.symSolveMarkovModel-1378"><span class="linenos">1378</span></a>        <span class="c1">#% </span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1379"><a href="#StateTransitionGraph.symSolveMarkovModel-1379"><span class="linenos">1379</span></a>        <span class="n">Xsum</span> <span class="o">=</span> <span class="mi">0</span>    
</span><span id="StateTransitionGraph.symSolveMarkovModel-1380"><a href="#StateTransitionGraph.symSolveMarkovModel-1380"><span class="linenos">1380</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1381"><a href="#StateTransitionGraph.symSolveMarkovModel-1381"><span class="linenos">1381</span></a>            <span class="n">Xsum</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1382"><a href="#StateTransitionGraph.symSolveMarkovModel-1382"><span class="linenos">1382</span></a>        
</span><span id="StateTransitionGraph.symSolveMarkovModel-1383"><a href="#StateTransitionGraph.symSolveMarkovModel-1383"><span class="linenos">1383</span></a>        <span class="n">eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">Xsum</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span>    
</span><span id="StateTransitionGraph.symSolveMarkovModel-1384"><a href="#StateTransitionGraph.symSolveMarkovModel-1384"><span class="linenos">1384</span></a>        <span class="c1">#%</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1385"><a href="#StateTransitionGraph.symSolveMarkovModel-1385"><span class="linenos">1385</span></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,</span> <span class="n">to_solve</span><span class="p">)</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1386"><a href="#StateTransitionGraph.symSolveMarkovModel-1386"><span class="linenos">1386</span></a>        <span class="n">simplified_solution</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1387"><a href="#StateTransitionGraph.symSolveMarkovModel-1387"><span class="linenos">1387</span></a>        <span class="c1">#print(simplified_solution)</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1388"><a href="#StateTransitionGraph.symSolveMarkovModel-1388"><span class="linenos">1388</span></a>        <span class="n">num_solution</span> <span class="o">=</span> <span class="n">simplified_solution</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subs</span><span class="p">)</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1389"><a href="#StateTransitionGraph.symSolveMarkovModel-1389"><span class="linenos">1389</span></a>        <span class="c1">#num_dict =  {str(var): str(sol) for var, sol in simplified_solution.items()}</span>
</span><span id="StateTransitionGraph.symSolveMarkovModel-1390"><a href="#StateTransitionGraph.symSolveMarkovModel-1390"><span class="linenos">1390</span></a>        <span class="n">num_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">num_solution</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">]]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">X</span><span class="p">}</span>                
</span><span id="StateTransitionGraph.symSolveMarkovModel-1391"><a href="#StateTransitionGraph.symSolveMarkovModel-1391"><span class="linenos">1391</span></a>        
</span><span id="StateTransitionGraph.symSolveMarkovModel-1392"><a href="#StateTransitionGraph.symSolveMarkovModel-1392"><span class="linenos">1392</span></a>        <span class="k">return</span> <span class="n">simplified_solution</span><span class="p">,</span> <span class="n">num_dict</span> 
</span></pre></div>


            <div class="docstring"><p>Symbolically solve the global balance equations of the CTMC.</p>

<p>This method constructs and solves the system of symbolic equations for the
steady-state probabilities of each state in the CTMC. It uses symbolic transition
rates stored on the edges to form balance equations for each node, along with
the normalization constraint that all probabilities sum to 1.</p>

<h2 id="returns">Returns</h2>

<p>solution : dict
    A symbolic solution dictionary mapping SymPy symbols (e.g., x_{A}) to
    expressions in terms of model parameters.</p>

<p>num_solution : dict
    A numerical dictionary mapping each state (node) to its steady-state probability,
    computed by substituting the numeric values from <code>self._subs</code> into the symbolic solution.</p>

<h2 id="notes">Notes</h2>

<ul>
<li>For each node <code>s</code>, a symbolic variable <code>x_{label}</code> is created using the node's label attribute.</li>
<li>One balance equation is created per state: total inflow = total outflow.</li>
<li>An additional constraint <code>sum(x_i) = 1</code> ensures proper normalization.</li>
<li>The symbolic system is solved with <code>sympy.solve</code>, and the results are simplified.</li>
<li>Numeric values are computed by substituting known parameter values (<code>self._subs</code>) into the symbolic solution.</li>
</ul>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">sym_sol</span><span class="p">,</span> <span class="n">num_sol</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">symSolveMarkovModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sym_sol</span>  <span class="c1"># symbolic expressions for each state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_sol</span>  <span class="c1"># evaluated numerical values for each state</span>
</code></pre>
</div>
</div>


                            </div>
                </section>
    </main>
</body>
</html>